/**
 * @license
 *
 * Copyright 2025 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var xv=Object.create;var bc=Object.defineProperty;var Av=Object.getOwnPropertyDescriptor;var Fv=Object.getOwnPropertyNames;var Rv=Object.getPrototypeOf,bv=Object.prototype.hasOwnProperty;var vv=(e,t,r)=>t in e?bc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ne=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),wv=(e,t)=>{for(var r in t)bc(e,r,{get:t[r],enumerable:!0})},Pv=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Fv(t))!bv.call(e,a)&&a!==r&&bc(e,a,{get:()=>t[a],enumerable:!(n=Av(t,a))||n.enumerable});return e};var Cr=(e,t,r)=>(r=e!=null?xv(Rv(e)):{},Pv(t||!e||!e.__esModule?bc(r,"default",{value:e,enumerable:!0}):r,e));var le=(e,t,r)=>vv(e,typeof t!="symbol"?t+"":t,r);var wy=Ne(ns=>{"use strict";var kc=ns&&ns.__assign||function(){return kc=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},kc.apply(this,arguments)};Object.defineProperty(ns,"__esModule",{value:!0});var Qv={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};function Lv(e){var t=kc(kc({},Qv),e);return t.numOfAttempts<1&&(t.numOfAttempts=1),t}ns.getSanitizedOptions=Lv});var Py=Ne(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});function Uv(e){var t=Math.random()*e;return Math.round(t)}Lp.fullJitter=Uv});var Ey=Ne(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});function Bv(e){return e}Up.noJitter=Bv});var Iy=Ne(Bp=>{"use strict";Object.defineProperty(Bp,"__esModule",{value:!0});var _v=Py(),$v=Ey();function Gv(e){switch(e.jitter){case"full":return _v.fullJitter;case"none":default:return $v.noJitter}}Bp.JitterFactory=Gv});var $p=Ne(_p=>{"use strict";Object.defineProperty(_p,"__esModule",{value:!0});var Hv=Iy(),zv=function(){function e(t){this.options=t,this.attempt=0}return e.prototype.apply=function(){var t=this;return new Promise(function(r){return setTimeout(r,t.jitteredDelay)})},e.prototype.setAttemptNumber=function(t){this.attempt=t},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){var t=Hv.JitterFactory(this.options);return t(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var t=this.options.startingDelay,r=this.options.timeMultiple,n=this.numOfDelayedAttempts,a=t*Math.pow(r,n);return Math.min(a,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();_p.Delay=zv});var ky=Ne(xr=>{"use strict";var Wv=xr&&xr.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var o in a)a.hasOwnProperty(o)&&(n[o]=a[o])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yv=xr&&xr.__awaiter||function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(n.next(l))}catch(p){i(p)}}function c(l){try{u(n.throw(l))}catch(p){i(p)}}function u(l){l.done?o(l.value):a(l.value).then(s,c)}u((n=n.apply(e,t||[])).next())})},Kv=xr&&xr.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(o=u[0]&2?a.return:u[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,u[1])).done)return o;switch(a=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(l){u=[6,l],a=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(xr,"__esModule",{value:!0});var Jv=$p(),Xv=function(e){Wv(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.apply=function(){return Yv(this,void 0,void 0,function(){return Kv(this,function(r){return[2,this.isFirstAttempt?!0:e.prototype.apply.call(this)]})})},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return this.attempt===0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(Jv.Delay);xr.SkipFirstDelay=Xv});var Ty=Ne(as=>{"use strict";var Zv=as&&as.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var o in a)a.hasOwnProperty(o)&&(n[o]=a[o])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(as,"__esModule",{value:!0});var ew=$p(),tw=function(e){Zv(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ew.Delay);as.AlwaysDelay=tw});var Oy=Ne(Gp=>{"use strict";Object.defineProperty(Gp,"__esModule",{value:!0});var rw=ky(),nw=Ty();function aw(e,t){var r=ow(e);return r.setAttemptNumber(t),r}Gp.DelayFactory=aw;function ow(e){return e.delayFirstAttempt?new nw.AlwaysDelay(e):new rw.SkipFirstDelay(e)}});var qy=Ne(_n=>{"use strict";var Hp=_n&&_n.__awaiter||function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(n.next(l))}catch(p){i(p)}}function c(l){try{u(n.throw(l))}catch(p){i(p)}}function u(l){l.done?o(l.value):a(l.value).then(s,c)}u((n=n.apply(e,t||[])).next())})},zp=_n&&_n.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,i;return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(o=u[0]&2?a.return:u[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,u[1])).done)return o;switch(a=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){r.label=u[1];break}if(u[0]===6&&r.label<o[1]){r.label=o[1],o=u;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(u);break}o[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(l){u=[6,l],a=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(_n,"__esModule",{value:!0});var iw=wy(),sw=Oy();function cw(e,t){return t===void 0&&(t={}),Hp(this,void 0,void 0,function(){var r,n;return zp(this,function(a){switch(a.label){case 0:return r=iw.getSanitizedOptions(t),n=new uw(e,r),[4,n.execute()];case 1:return[2,a.sent()]}})})}_n.backOff=cw;var uw=function(){function e(t,r){this.request=t,this.options=r,this.attemptNumber=0}return e.prototype.execute=function(){return Hp(this,void 0,void 0,function(){var t,r;return zp(this,function(n){switch(n.label){case 0:if(this.attemptLimitReached)return[3,7];n.label=1;case 1:return n.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return n.sent(),[4,this.request()];case 3:return[2,n.sent()];case 4:return t=n.sent(),this.attemptNumber++,[4,this.options.retry(t,this.attemptNumber)];case 5:if(r=n.sent(),!r||this.attemptLimitReached)throw t;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}})})},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return Hp(this,void 0,void 0,function(){var t;return zp(this,function(r){switch(r.label){case 0:return t=sw.DelayFactory(this.options,this.attemptNumber),[4,t.apply()];case 1:return r.sent(),[2]}})})},e}()});var Ru=Ne((of,sf)=>{"use strict";(function(e,t){typeof of=="object"&&typeof sf<"u"?sf.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs=t()})(of,function(){"use strict";var e=1e3,t=6e4,r=36e5,n="millisecond",a="second",o="minute",i="hour",s="day",c="week",u="month",l="quarter",p="year",m="date",d="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var O=["th","st","nd","rd"],T=D%100;return"["+D+(O[(T-20)%10]||O[T]||O[0])+"]"}},y=function(D,O,T){var M=String(D);return!M||M.length>=O?D:""+Array(O+1-M.length).join(T)+D},x={s:y,z:function(D){var O=-D.utcOffset(),T=Math.abs(O),M=Math.floor(T/60),q=T%60;return(O<=0?"+":"-")+y(M,2,"0")+":"+y(q,2,"0")},m:function D(O,T){if(O.date()<T.date())return-D(T,O);var M=12*(T.year()-O.year())+(T.month()-O.month()),q=O.clone().add(M,u),U=T-q<0,B=O.clone().add(M+(U?-1:1),u);return+(-(M+(T-q)/(U?q-B:B-q))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:u,y:p,w:c,d:s,D:m,h:i,m:o,s:a,ms:n,Q:l}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},h="en",A={};A[h]=g;var E="$isDayjsObject",v=function(D){return D instanceof k||!(!D||!D[E])},R=function D(O,T,M){var q;if(!O)return h;if(typeof O=="string"){var U=O.toLowerCase();A[U]&&(q=U),T&&(A[U]=T,q=U);var B=O.split("-");if(!q&&B.length>1)return D(B[0])}else{var z=O.name;A[z]=O,q=z}return!M&&q&&(h=q),q||!M&&h},b=function(D,O){if(v(D))return D.clone();var T=typeof O=="object"?O:{};return T.date=D,T.args=arguments,new k(T)},w=x;w.l=R,w.i=v,w.w=function(D,O){return b(D,{locale:O.$L,utc:O.$u,x:O.$x,$offset:O.$offset})};var k=function(){function D(T){this.$L=R(T.locale,null,!0),this.parse(T),this.$x=this.$x||T.x||{},this[E]=!0}var O=D.prototype;return O.parse=function(T){this.$d=function(M){var q=M.date,U=M.utc;if(q===null)return new Date(NaN);if(w.u(q))return new Date;if(q instanceof Date)return new Date(q);if(typeof q=="string"&&!/Z$/i.test(q)){var B=q.match(f);if(B){var z=B[2]-1||0,ee=(B[7]||"0").substring(0,3);return U?new Date(Date.UTC(B[1],z,B[3]||1,B[4]||0,B[5]||0,B[6]||0,ee)):new Date(B[1],z,B[3]||1,B[4]||0,B[5]||0,B[6]||0,ee)}}return new Date(q)}(T),this.init()},O.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds()},O.$utils=function(){return w},O.isValid=function(){return this.$d.toString()!==d},O.isSame=function(T,M){var q=b(T);return this.startOf(M)<=q&&q<=this.endOf(M)},O.isAfter=function(T,M){return b(T)<this.startOf(M)},O.isBefore=function(T,M){return this.endOf(M)<b(T)},O.$g=function(T,M,q){return w.u(T)?this[M]:this.set(q,T)},O.unix=function(){return Math.floor(this.valueOf()/1e3)},O.valueOf=function(){return this.$d.getTime()},O.startOf=function(T,M){var q=this,U=!!w.u(M)||M,B=w.p(T),z=function(se,ye){var Ce=w.w(q.$u?Date.UTC(q.$y,ye,se):new Date(q.$y,ye,se),q);return U?Ce:Ce.endOf(s)},ee=function(se,ye){return w.w(q.toDate()[se].apply(q.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(ye)),q)},ae=this.$W,X=this.$M,te=this.$D,J="set"+(this.$u?"UTC":"");switch(B){case p:return U?z(1,0):z(31,11);case u:return U?z(1,X):z(0,X+1);case c:var re=this.$locale().weekStart||0,he=(ae<re?ae+7:ae)-re;return z(U?te-he:te+(6-he),X);case s:case m:return ee(J+"Hours",0);case i:return ee(J+"Minutes",1);case o:return ee(J+"Seconds",2);case a:return ee(J+"Milliseconds",3);default:return this.clone()}},O.endOf=function(T){return this.startOf(T,!1)},O.$set=function(T,M){var q,U=w.p(T),B="set"+(this.$u?"UTC":""),z=(q={},q[s]=B+"Date",q[m]=B+"Date",q[u]=B+"Month",q[p]=B+"FullYear",q[i]=B+"Hours",q[o]=B+"Minutes",q[a]=B+"Seconds",q[n]=B+"Milliseconds",q)[U],ee=U===s?this.$D+(M-this.$W):M;if(U===u||U===p){var ae=this.clone().set(m,1);ae.$d[z](ee),ae.init(),this.$d=ae.set(m,Math.min(this.$D,ae.daysInMonth())).$d}else z&&this.$d[z](ee);return this.init(),this},O.set=function(T,M){return this.clone().$set(T,M)},O.get=function(T){return this[w.p(T)]()},O.add=function(T,M){var q,U=this;T=Number(T);var B=w.p(M),z=function(X){var te=b(U);return w.w(te.date(te.date()+Math.round(X*T)),U)};if(B===u)return this.set(u,this.$M+T);if(B===p)return this.set(p,this.$y+T);if(B===s)return z(1);if(B===c)return z(7);var ee=(q={},q[o]=t,q[i]=r,q[a]=e,q)[B]||1,ae=this.$d.getTime()+T*ee;return w.w(ae,this)},O.subtract=function(T,M){return this.add(-1*T,M)},O.format=function(T){var M=this,q=this.$locale();if(!this.isValid())return q.invalidDate||d;var U=T||"YYYY-MM-DDTHH:mm:ssZ",B=w.z(this),z=this.$H,ee=this.$m,ae=this.$M,X=q.weekdays,te=q.months,J=q.meridiem,re=function(ye,Ce,ze,it){return ye&&(ye[Ce]||ye(M,U))||ze[Ce].slice(0,it)},he=function(ye){return w.s(z%12||12,ye,"0")},se=J||function(ye,Ce,ze){var it=ye<12?"AM":"PM";return ze?it.toLowerCase():it};return U.replace(C,function(ye,Ce){return Ce||function(ze){switch(ze){case"YY":return String(M.$y).slice(-2);case"YYYY":return w.s(M.$y,4,"0");case"M":return ae+1;case"MM":return w.s(ae+1,2,"0");case"MMM":return re(q.monthsShort,ae,te,3);case"MMMM":return re(te,ae);case"D":return M.$D;case"DD":return w.s(M.$D,2,"0");case"d":return String(M.$W);case"dd":return re(q.weekdaysMin,M.$W,X,2);case"ddd":return re(q.weekdaysShort,M.$W,X,3);case"dddd":return X[M.$W];case"H":return String(z);case"HH":return w.s(z,2,"0");case"h":return he(1);case"hh":return he(2);case"a":return se(z,ee,!0);case"A":return se(z,ee,!1);case"m":return String(ee);case"mm":return w.s(ee,2,"0");case"s":return String(M.$s);case"ss":return w.s(M.$s,2,"0");case"SSS":return w.s(M.$ms,3,"0");case"Z":return B}return null}(ye)||B.replace(":","")})},O.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},O.diff=function(T,M,q){var U,B=this,z=w.p(M),ee=b(T),ae=(ee.utcOffset()-this.utcOffset())*t,X=this-ee,te=function(){return w.m(B,ee)};switch(z){case p:U=te()/12;break;case u:U=te();break;case l:U=te()/3;break;case c:U=(X-ae)/6048e5;break;case s:U=(X-ae)/864e5;break;case i:U=X/r;break;case o:U=X/t;break;case a:U=X/e;break;default:U=X}return q?U:w.a(U)},O.daysInMonth=function(){return this.endOf(u).$D},O.$locale=function(){return A[this.$L]},O.locale=function(T,M){if(!T)return this.$L;var q=this.clone(),U=R(T,M,!0);return U&&(q.$L=U),q},O.clone=function(){return w.w(this.$d,this)},O.toDate=function(){return new Date(this.valueOf())},O.toJSON=function(){return this.isValid()?this.toISOString():null},O.toISOString=function(){return this.$d.toISOString()},O.toString=function(){return this.$d.toUTCString()},D}(),L=k.prototype;return b.prototype=L,[["$ms",n],["$s",a],["$m",o],["$H",i],["$W",s],["$M",u],["$y",p],["$D",m]].forEach(function(D){L[D[1]]=function(O){return this.$g(O,D[0],D[1])}}),b.extend=function(D,O){return D.$i||(D(O,k,b),D.$i=!0),b},b.locale=R,b.isDayjs=v,b.unix=function(D){return b(1e3*D)},b.en=A[h],b.Ls=A,b.p={},b})});var JS=Ne((cf,uf)=>{"use strict";(function(e,t){typeof cf=="object"&&typeof uf<"u"?uf.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_quarterOfYear=t()})(cf,function(){"use strict";var e="month",t="quarter";return function(r,n){var a=n.prototype;a.quarter=function(s){return this.$utils().u(s)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(s-1))};var o=a.add;a.add=function(s,c){return s=Number(s),this.$utils().p(c)===t?this.add(3*s,e):o.bind(this)(s,c)};var i=a.startOf;a.startOf=function(s,c){var u=this.$utils(),l=!!u.u(c)||c;if(u.p(s)===t){var p=this.quarter()-1;return l?this.month(3*p).startOf(e).startOf("day"):this.month(3*p+2).endOf(e).endOf("day")}return i.bind(this)(s,c)}}})});var XS=Ne((lf,df)=>{"use strict";(function(e,t){typeof lf=="object"&&typeof df<"u"?df.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_customParseFormat=t()})(lf,function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d/,n=/\d\d/,a=/\d\d?/,o=/\d*[^-_:/,()\s\d]+/,i={},s=function(f){return(f=+f)+(f>68?1900:2e3)},c=function(f){return function(C){this[f]=+C}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(f){(this.zone||(this.zone={})).offset=function(C){if(!C||C==="Z")return 0;var g=C.match(/([+-]|\d\d)/g),y=60*g[1]+(+g[2]||0);return y===0?0:g[0]==="+"?-y:y}(f)}],l=function(f){var C=i[f];return C&&(C.indexOf?C:C.s.concat(C.f))},p=function(f,C){var g,y=i.meridiem;if(y){for(var x=1;x<=24;x+=1)if(f.indexOf(y(x,0,C))>-1){g=x>12;break}}else g=f===(C?"pm":"PM");return g},m={A:[o,function(f){this.afternoon=p(f,!1)}],a:[o,function(f){this.afternoon=p(f,!0)}],Q:[r,function(f){this.month=3*(f-1)+1}],S:[r,function(f){this.milliseconds=100*+f}],SS:[n,function(f){this.milliseconds=10*+f}],SSS:[/\d{3}/,function(f){this.milliseconds=+f}],s:[a,c("seconds")],ss:[a,c("seconds")],m:[a,c("minutes")],mm:[a,c("minutes")],H:[a,c("hours")],h:[a,c("hours")],HH:[a,c("hours")],hh:[a,c("hours")],D:[a,c("day")],DD:[n,c("day")],Do:[o,function(f){var C=i.ordinal,g=f.match(/\d+/);if(this.day=g[0],C)for(var y=1;y<=31;y+=1)C(y).replace(/\[|\]/g,"")===f&&(this.day=y)}],w:[a,c("week")],ww:[n,c("week")],M:[a,c("month")],MM:[n,c("month")],MMM:[o,function(f){var C=l("months"),g=(l("monthsShort")||C.map(function(y){return y.slice(0,3)})).indexOf(f)+1;if(g<1)throw new Error;this.month=g%12||g}],MMMM:[o,function(f){var C=l("months").indexOf(f)+1;if(C<1)throw new Error;this.month=C%12||C}],Y:[/[+-]?\d+/,c("year")],YY:[n,function(f){this.year=s(f)}],YYYY:[/\d{4}/,c("year")],Z:u,ZZ:u};function d(f){var C,g;C=f,g=i&&i.formats;for(var y=(f=C.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(b,w,k){var L=k&&k.toUpperCase();return w||g[k]||e[k]||g[L].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(D,O,T){return O||T.slice(1)})})).match(t),x=y.length,h=0;h<x;h+=1){var A=y[h],E=m[A],v=E&&E[0],R=E&&E[1];y[h]=R?{regex:v,parser:R}:A.replace(/^\[|\]$/g,"")}return function(b){for(var w={},k=0,L=0;k<x;k+=1){var D=y[k];if(typeof D=="string")L+=D.length;else{var O=D.regex,T=D.parser,M=b.slice(L),q=O.exec(M)[0];T.call(w,q),b=b.replace(q,"")}}return function(U){var B=U.afternoon;if(B!==void 0){var z=U.hours;B?z<12&&(U.hours+=12):z===12&&(U.hours=0),delete U.afternoon}}(w),w}}return function(f,C,g){g.p.customParseFormat=!0,f&&f.parseTwoDigitYear&&(s=f.parseTwoDigitYear);var y=C.prototype,x=y.parse;y.parse=function(h){var A=h.date,E=h.utc,v=h.args;this.$u=E;var R=v[1];if(typeof R=="string"){var b=v[2]===!0,w=v[3]===!0,k=b||w,L=v[2];w&&(L=v[2]),i=this.$locale(),!b&&L&&(i=g.Ls[L]),this.$d=function(M,q,U,B){try{if(["x","X"].indexOf(q)>-1)return new Date((q==="X"?1e3:1)*M);var z=d(q)(M),ee=z.year,ae=z.month,X=z.day,te=z.hours,J=z.minutes,re=z.seconds,he=z.milliseconds,se=z.zone,ye=z.week,Ce=new Date,ze=X||(ee||ae?1:Ce.getDate()),it=ee||Ce.getFullYear(),Lr=0;ee&&!ae||(Lr=ae>0?ae-1:Ce.getMonth());var Oa,qa=te||0,es=J||0,Op=re||0,qp=he||0;return se?new Date(Date.UTC(it,Lr,ze,qa,es,Op,qp+60*se.offset*1e3)):U?new Date(Date.UTC(it,Lr,ze,qa,es,Op,qp)):(Oa=new Date(it,Lr,ze,qa,es,Op,qp),ye&&(Oa=B(Oa).week(ye).toDate()),Oa)}catch{return new Date("")}}(A,R,E,g),this.init(),L&&L!==!0&&(this.$L=this.locale(L).$L),k&&A!=this.format(R)&&(this.$d=new Date("")),i={}}else if(R instanceof Array)for(var D=R.length,O=1;O<=D;O+=1){v[1]=R[O-1];var T=g.apply(this,v);if(T.isValid()){this.$d=T.$d,this.$L=T.$L,this.init();break}O===D&&(this.$d=new Date(""))}else x.call(this,h)}}})});var mx=Ne((Lf,Uf)=>{"use strict";(function(e,t){typeof Lf=="object"&&typeof Uf<"u"?Uf.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_timezone=t()})(Lf,function(){"use strict";var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,a){var o,i=function(l,p,m){m===void 0&&(m={});var d=new Date(l),f=function(C,g){g===void 0&&(g={});var y=g.timeZoneName||"short",x=C+"|"+y,h=t[x];return h||(h=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:C,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:y}),t[x]=h),h}(p,m);return f.formatToParts(d)},s=function(l,p){for(var m=i(l,p),d=[],f=0;f<m.length;f+=1){var C=m[f],g=C.type,y=C.value,x=e[g];x>=0&&(d[x]=parseInt(y,10))}var h=d[3],A=h===24?0:h,E=d[0]+"-"+d[1]+"-"+d[2]+" "+A+":"+d[4]+":"+d[5]+":000",v=+l;return(a.utc(E).valueOf()-(v-=v%1e3))/6e4},c=n.prototype;c.tz=function(l,p){l===void 0&&(l=o);var m,d=this.utcOffset(),f=this.toDate(),C=f.toLocaleString("en-US",{timeZone:l}),g=Math.round((f-new Date(C))/1e3/60),y=15*-Math.round(f.getTimezoneOffset()/15)-g;if(!Number(y))m=this.utcOffset(0,p);else if(m=a(C,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(y,!0),p){var x=m.utcOffset();m=m.add(d-x,"minute")}return m.$x.$timezone=l,m},c.offsetName=function(l){var p=this.$x.$timezone||a.tz.guess(),m=i(this.valueOf(),p,{timeZoneName:l}).find(function(d){return d.type.toLowerCase()==="timezonename"});return m&&m.value};var u=c.startOf;c.startOf=function(l,p){if(!this.$x||!this.$x.$timezone)return u.call(this,l,p);var m=a(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return u.call(m,l,p).tz(this.$x.$timezone,!0)},a.tz=function(l,p,m){var d=m&&p,f=m||p||o,C=s(+a(),f);if(typeof l!="string")return a(l).tz(f);var g=function(A,E,v){var R=A-60*E*1e3,b=s(R,v);if(E===b)return[R,E];var w=s(R-=60*(b-E)*1e3,v);return b===w?[R,b]:[A-60*Math.min(b,w)*1e3,Math.max(b,w)]}(a.utc(l,d).valueOf(),C,f),y=g[0],x=g[1],h=a(y).utcOffset(x);return h.$x.$timezone=f,h},a.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},a.tz.setDefault=function(l){o=l}}})});var fx=Ne((Bf,_f)=>{"use strict";(function(e,t){typeof Bf=="object"&&typeof _f<"u"?_f.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self).dayjs_plugin_utc=t()})(Bf,function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,a,o){var i=a.prototype;o.utc=function(d){var f={date:d,utc:!0,args:arguments};return new a(f)},i.utc=function(d){var f=o(this.toDate(),{locale:this.$L,utc:!0});return d?f.add(this.utcOffset(),e):f},i.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=i.parse;i.parse=function(d){d.utc&&(this.$u=!0),this.$utils().u(d.$offset)||(this.$offset=d.$offset),s.call(this,d)};var c=i.init;i.init=function(){if(this.$u){var d=this.$d;this.$y=d.getUTCFullYear(),this.$M=d.getUTCMonth(),this.$D=d.getUTCDate(),this.$W=d.getUTCDay(),this.$H=d.getUTCHours(),this.$m=d.getUTCMinutes(),this.$s=d.getUTCSeconds(),this.$ms=d.getUTCMilliseconds()}else c.call(this)};var u=i.utcOffset;i.utcOffset=function(d,f){var C=this.$utils().u;if(C(d))return this.$u?0:C(this.$offset)?u.call(this):this.$offset;if(typeof d=="string"&&(d=function(h){h===void 0&&(h="");var A=h.match(t);if(!A)return null;var E=(""+A[0]).match(r)||["-",0,0],v=E[0],R=60*+E[1]+ +E[2];return R===0?0:v==="+"?R:-R}(d),d===null))return this;var g=Math.abs(d)<=16?60*d:d,y=this;if(f)return y.$offset=g,y.$u=d===0,y;if(d!==0){var x=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(y=this.local().add(g+x,e)).$offset=g,y.$x.$localOffset=x}else y=this.utc();return y};var l=i.format;i.format=function(d){var f=d||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,f)},i.valueOf=function(){var d=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*d},i.isUTC=function(){return!!this.$u},i.toISOString=function(){return this.toDate().toISOString()},i.toString=function(){return this.toDate().toUTCString()};var p=i.toDate;i.toDate=function(d){return d==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var m=i.diff;i.diff=function(d,f,C){if(d&&this.$u===d.$u)return m.call(this,d,f,C);var g=this.local(),y=o(d).local();return m.call(g,y,f,C)}}})});var Px=Ne((c2,wx)=>{"use strict";function AO(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}wx.exports=FO;function FO(e,t,r){var n=r&&r.stringify||AO,a=1;if(typeof e=="object"&&e!==null){var o=t.length+a;if(o===1)return e;var i=new Array(o);i[0]=n(e);for(var s=1;s<o;s++)i[s]=n(t[s]);return i.join(" ")}if(typeof e!="string")return e;var c=t.length;if(c===0)return e;for(var u="",l=1-a,p=-1,m=e&&e.length||0,d=0;d<m;){if(e.charCodeAt(d)===37&&d+1<m){switch(p=p>-1?p:0,e.charCodeAt(d+1)){case 100:case 102:if(l>=c||t[l]==null)break;p<d&&(u+=e.slice(p,d)),u+=Number(t[l]),p=d+2,d++;break;case 105:if(l>=c||t[l]==null)break;p<d&&(u+=e.slice(p,d)),u+=Math.floor(Number(t[l])),p=d+2,d++;break;case 79:case 111:case 106:if(l>=c||t[l]===void 0)break;p<d&&(u+=e.slice(p,d));var f=typeof t[l];if(f==="string"){u+="'"+t[l]+"'",p=d+2,d++;break}if(f==="function"){u+=t[l].name||"<anonymous>",p=d+2,d++;break}u+=n(t[l]),p=d+2,d++;break;case 115:if(l>=c)break;p<d&&(u+=e.slice(p,d)),u+=String(t[l]),p=d+2,d++;break;case 37:p<d&&(u+=e.slice(p,d)),u+="%",p=d+2,d++,l--;break}++l}++d}return p===-1?e:(p<m&&(u+=e.slice(p)),u)}});var qx=Ne((u2,fl)=>{"use strict";var Ex=Px();fl.exports=kr;var Ys=NO().console||{},RO={mapHttpRequest:ml,mapHttpResponse:ml,wrapRequestSerializer:Hf,wrapResponseSerializer:Hf,wrapErrorSerializer:Hf,req:ml,res:ml,err:kx,errWithCause:kx};function fn(e,t){return e==="silent"?1/0:t.levels.values[e]}var Yf=Symbol("pino.logFuncs"),zf=Symbol("pino.hierarchy"),bO={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Ix(e,t){let r={logger:t,parent:e[zf]};t[zf]=r}function vO(e,t,r){let n={};t.forEach(a=>{n[a]=r[a]?r[a]:Ys[a]||Ys[bO[a]||"log"]||_o}),e[Yf]=n}function wO(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function kr(e){e=e||{},e.browser=e.browser||{};let t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");let r=e.browser.write||Ys;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},a=wO(e.browser.serialize,n),o=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(o=!1);let i=Object.keys(e.customLevels||{}),s=["error","fatal","warn","info","debug","trace"].concat(i);typeof r=="function"&&s.forEach(function(C){r[C]=r}),(e.enabled===!1||e.browser.disabled)&&(e.level="silent");let c=e.level||"info",u=Object.create(r);u.log||(u.log=_o),vO(u,s,r),Ix({},u),Object.defineProperty(u,"levelVal",{get:p}),Object.defineProperty(u,"level",{get:m,set:d});let l={transmit:t,serialize:a,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:s,timestamp:DO(e),messageKey:e.messageKey||"msg",onChild:e.onChild||_o};u.levels=PO(e),u.level=c,u.isLevelEnabled=function(C){return this.levels.values[C]?this.levels.values[C]>=this.levels.values[this.level]:!1},u.setMaxListeners=u.getMaxListeners=u.emit=u.addListener=u.on=u.prependListener=u.once=u.prependOnceListener=u.removeListener=u.removeAllListeners=u.listeners=u.listenerCount=u.eventNames=u.write=u.flush=_o,u.serializers=n,u._serialize=a,u._stdErrSerialize=o,u.child=function(...C){return f.call(this,l,...C)},t&&(u._logEvent=Wf());function p(){return fn(this.level,this)}function m(){return this._level}function d(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,ca(this,l,u,"error"),ca(this,l,u,"fatal"),ca(this,l,u,"warn"),ca(this,l,u,"info"),ca(this,l,u,"debug"),ca(this,l,u,"trace"),i.forEach(g=>{ca(this,l,u,g)})}function f(C,g,y){if(!g)throw new Error("missing bindings for child Pino");y=y||{},a&&g.serializers&&(y.serializers=g.serializers);let x=y.serializers;if(a&&x){var h=Object.assign({},n,x),A=e.browser.serialize===!0?Object.keys(h):a;delete g.serializers,Kf([g],A,h,this._stdErrSerialize)}function E(R){this._childLevel=(R._childLevel|0)+1,this.bindings=g,h&&(this.serializers=h,this._serialize=A),t&&(this._logEvent=Wf([].concat(R._logEvent.bindings,g)))}E.prototype=this;let v=new E(this);return Ix(this,v),v.child=function(...R){return f.call(this,C,...R)},v.level=y.level||this.level,C.onChild(v),v}return u}function PO(e){let t=e.customLevels||{},r=Object.assign({},kr.levels.values,t),n=Object.assign({},kr.levels.labels,EO(t));return{values:r,labels:n}}function EO(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}kr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};kr.stdSerializers=RO;kr.stdTimeFunctions=Object.assign({},{nullTime:Tx,epochTime:Ox,unixTime:jO,isoTime:VO});function IO(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[zf];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}function ca(e,t,r,n){if(Object.defineProperty(e,n,{value:fn(e.level,r)>fn(n,r)?_o:r[Yf][n],writable:!0,enumerable:!0,configurable:!0}),e[n]===_o){if(!t.transmit)return;let o=t.transmit.level||e.level,i=fn(o,r);if(fn(n,r)<i)return}e[n]=TO(e,t,r,n);let a=IO(e);a.length!==0&&(e[n]=kO(a,e[n]))}function kO(e,t){return function(){return t.apply(this,[...e,...arguments])}}function TO(e,t,r,n){return function(a){return function(){let i=t.timestamp(),s=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Ys?Ys:this;for(var u=0;u<s.length;u++)s[u]=arguments[u];var l=!1;if(t.serialize&&(Kf(s,this._serialize,this.serializers,this._stdErrSerialize),l=!0),t.asObject||t.formatters?a.call(c,...OO(this,n,s,i,t)):a.apply(c,s),t.transmit){let p=t.transmit.level||e._level,m=fn(p,r),d=fn(n,r);if(d<m)return;qO(this,{ts:i,methodLevel:n,methodValue:d,transmitLevel:p,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:fn(e._level,r)},s,l)}}}(e[Yf][n])}function OO(e,t,r,n,a){let{level:o,log:i=p=>p}=a.formatters||{},s=r.slice(),c=s[0],u={},l=(e._childLevel|0)+1;if(l<1&&(l=1),n&&(u.time=n),o){let p=o(t,e.levels.values[t]);Object.assign(u,p)}else u.level=e.levels.values[t];if(a.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;l--&&typeof s[0]=="object";)Object.assign(u,s.shift());return[i(u),...s]}else{if(c!==null&&typeof c=="object"){for(;l--&&typeof s[0]=="object";)Object.assign(u,s.shift());c=s.length?Ex(s.shift(),s):void 0}else typeof c=="string"&&(c=Ex(s.shift(),s));return c!==void 0&&(u[a.messageKey]=c),[i(u)]}}function Kf(e,t,r,n){for(let a in e)if(n&&e[a]instanceof Error)e[a]=kr.stdSerializers.err(e[a]);else if(typeof e[a]=="object"&&!Array.isArray(e[a])&&t)for(let o in e[a])t.indexOf(o)>-1&&o in r&&(e[a][o]=r[o](e[a][o]))}function qO(e,t,r,n=!1){let a=t.send,o=t.ts,i=t.methodLevel,s=t.methodValue,c=t.val,u=e._logEvent.bindings;n||Kf(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter(function(l){return u.indexOf(l)===-1}),e._logEvent.level.label=i,e._logEvent.level.value=s,a(i,e._logEvent,c),e._logEvent=Wf(u)}function Wf(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function kx(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)t[r]===void 0&&(t[r]=e[r]);return t}function DO(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Tx:Ox}function ml(){return{}}function Hf(e){return e}function _o(){}function Tx(){return!1}function Ox(){return Date.now()}function jO(){return Math.round(Date.now()/1e3)}function VO(){return new Date(Date.now()).toISOString()}function NO(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}fl.exports.default=kr;fl.exports.pino=kr});var Sy={};wv(Sy,{escapeHtml:()=>ja,getHighlightedSuggestion:()=>jp,highlightString:()=>Tv});import{isNullOrUndefined as kv}from"../bueno/v1.1.0/bueno.esm.js";var Ur=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function vc(e){return Array.isArray(e)}function wc(e){return e.trim()===""}function fy(e,t){return[...e.reduce((r,n)=>{let a=t(n);return r.has(a)||r.set(a,n),r},new Map).values()]}function Ev(e){return btoa(encodeURI(e))}function Pc(e,t){let{[e]:r,...n}=t;return n}function Da(e){return Ev(JSON.stringify(e))}var Iv=new Set(["1",1,"yes",!0]);function gy(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some(r=>Iv.has(r))}function yy(e){let t={};for(let[r,n]of e)t[r]=n;return t}function hy(e,t,r){return clearTimeout(t),setTimeout(e,r)}function ts(e){if(typeof e!="object"||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function Tv(e){if(wc(e.openingDelimiter)||wc(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(kv(e.content)||wc(e.content))return e.content;if(e.highlights.length===0)return ja(e.content);let t=e.content.length,r="",n=0;for(let a=0;a<e.highlights.length;a++){let o=e.highlights[a],i=o.offset,s=i+o.length;if(s>t)break;r+=ja(e.content.slice(n,i)),r+=e.openingDelimiter,r+=ja(e.content.slice(i,s)),r+=e.closingDelimiter,n=s}return n!==t&&(r+=ja(e.content.slice(n))),r}function jp(e,t){return e=ja(e),e.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,(r,n,a,o)=>n?Dp(n,t.notMatchDelimiters):a?Dp(a,t.exactMatchDelimiters):o?Dp(o,t.correctionDelimiters):r)}function Dp(e,t){return t?t.open+e+t.close:e}function ja(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=`(?:${Object.keys(t).join("|")})`,n=RegExp(r),a=RegExp(r,"g");return n.test(e)?e.replace(a,o=>t[o]):e}async function xy(e,t){let r=e.getReader(),n;for(;!(n=await r.read()).done;)t(n.value)}function Ay(e){let t,r,n,a=!1;return function(i){t===void 0?(t=i,r=0,n=-1):t=qv(t,i);let s=t.length,c=0;for(;r<s;){a&&(t[r]===10&&(c=++r),a=!1);let u=-1;for(;r<s&&u===-1;++r)switch(t[r]){case 58:n===-1&&(n=r-c);break;case 13:a=!0,u=r;break;case 10:u=r;break}if(u===-1)break;e(t.subarray(c,u),n),c=r,n=-1}c===s?t=void 0:c!==0&&(t=t.subarray(c),r-=c)}}function Fy(e,t,r){let n=Cy(),a=new TextDecoder;return function(i,s){if(i.length===0)r?.(n),n=Cy();else if(s>0){let c=a.decode(i.subarray(0,s)),u=s+(i[s+1]===32?2:1),l=a.decode(i.subarray(u));switch(c){case"data":n.data=n.data?`${n.data}
${l}`:l;break;case"event":n.event=l;break;case"id":e(n.id=l);break;case"retry":Ov(l,n,t);break}}}}function Ov(e,t,r){let n=parseInt(e,10);Number.isNaN(n)||r(t.retry=n)}function qv(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function Cy(){return{data:"",event:"",id:"",retry:void 0}}var Vp="text/event-stream",Dv=1e3,Ry="last-event-id";function by(){return typeof window<"u"}function Ec(e,{signal:t,headers:r,onopen:n,onmessage:a,onclose:o,onerror:i,openWhenHidden:s,fetch:c,...u}){return new Promise((l,p)=>{let m={...r};m.accept||(m.accept=Vp);let d;function f(){d?.abort(),document.hidden||A()}!s&&by()&&document.addEventListener("visibilitychange",f);let C=Dv,g;function y(){by()&&document.removeEventListener("visibilitychange",f),clearTimeout(g),d?.abort()}t?.addEventListener("abort",()=>{y(),l()});let x=c??fetch,h=n??jv;async function A(){d=AbortController?new AbortController:null;try{let E=await x(e,{...u,headers:m,signal:d?.signal});await h(E),await xy(E.body,Ay(Fy(v=>{v?m[Ry]=v:delete m[Ry]},v=>{C=v},a))),o?.(),y(),l()}catch(E){if(!d?.signal?.aborted)try{let v=i?.(E)??C;clearTimeout(g),g=setTimeout(A,v)}catch(v){y(),p(v)}}}A()})}function jv(e){let t=e.headers.get("content-type");if(!t?.startsWith(Vp))throw new Error(`Expected content-type to be ${Vp}, Actual: ${t}`)}var Br=class{constructor(t){le(this,"_basePath");le(this,"_params",{});this._basePath=t}addParam(t,r){this._params={...this.params,[t]:r}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map(([t,r])=>`${t}=${encodeURIComponent(r)}`).join("&")}`:this.basePath}};var Vv=(e,t,r)=>new Br(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href,vy=3,Nv=5e3,Mv="text/event-stream",Qp=1,Np=class extends Error{},rs=class extends Error{constructor(r){super(r.message);this.payload=r}},Mp=class{constructor(){le(this,"timeouts",new Set)}add(t){this.timeouts.add(t)}remove(t){clearTimeout(t),this.timeouts.delete(t)}isActive(t){return this.timeouts.has(t)}},Ic=class{constructor(t){le(this,"logger");this.logger=t.logger}streamGeneratedAnswer(t,r){let{url:n,organizationId:a,streamId:o,accessToken:i}=t,{write:s,abort:c,close:u,resetAnswer:l}=r,p=new Mp;if(!o){this.logger.error("No stream ID found");return}let m=0,d,f=()=>{d&&!p.isActive(d)&&(g?.abort(),l(),y())},C=()=>{p.remove(d),d=hy(f,d,Nv),p.add(d)},g=new AbortController,y=()=>Ec(Vv(n,a,o),{method:"GET",fetch,headers:{Authorization:`Bearer ${i}`,accept:"*/*"},openWhenHidden:!0,signal:g?.signal,async onopen(x){if(x.ok&&x.headers.get("content-type")===Mv)return;throw x.status>=400&&x.status<500&&x.status!==429?new rs({message:"Error opening stream",code:x.status}):new Np},onmessage:x=>{if(g?.signal.aborted)return;let h=JSON.parse(x.data);if(h.finishReason==="ERROR"){p.remove(d),g?.abort(),c({message:h.errorMessage,code:h.statusCode});return}s(h),m=0,h.finishReason==="COMPLETED"?(p.remove(d),u()):C()},onerror:x=>{if(!g?.signal.aborted){if(p.remove(d),x instanceof rs)throw g?.abort(),c(x),x;if(++m>vy){this.logger.info("Maximum retry exceeded.");let h={message:"Failed to complete stream.",code:Qp};throw g?.abort(),c(h),new rs(h)}this.logger.info(`Retrying...(${m}/${vy})`),l()}}});return y(),g}};var Ny=Cr(qy(),1);var N=new Error("Failed to load reducers."),Va=class extends Error{constructor(){super(),this.name="UnauthorizedTokenError",this.message="The token being used to perform the request is unauthorized. It may be expired or invalid."}},$n=class extends Error{constructor(r,n){super();le(this,"statusCode");this.name="Disconnected",this.message=`Client could not connect to the following URL: ${r}`,this.statusCode=n??0}};function Dy(e){let t=[];for(let r in e){let n=encodeURIComponent(r),a=encodeURIComponent(e[r]);t.push(`${n}=${a}`)}return t.join("&")}function jy(e){return typeof e!="object"||!e?!1:Object.values(e).every(lw)}function lw(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"}function Vy(e){return e===429}var st=class e{static async call(t){let r=dw(t),{logger:n}=t,a=await e.preprocessRequest(r,t);n.info(a,"Platform request");let{url:o,...i}=a,s=async()=>{let c=await fetch(o,i);if(Vy(c.status))throw c;return c};try{let c=await(0,Ny.backOff)(s,{retry:u=>{let l=u&&Vy(u.status);return l&&n.info("Platform retrying request"),l}});switch(c.status){case 419:case 401:throw n.info("Platform renewing token"),new Va;case 404:throw new $n(o,c.status);default:return n.info({response:c,requestInfo:a},"Platform response"),c}}catch(c){return c.message==="Failed to fetch"?new $n(o):c}}static async preprocessRequest(t,r){let{origin:n,preprocessRequest:a,logger:o,requestMetadata:i}=r,{signal:s,...c}=t,u=ts(c);try{let l=await a(t,n,i);return{...t,...l}}catch(l){o.error(l,"Platform request preprocessing failed. Returning default request options.")}return u}};function Me(e,t="prod",r="platform"){let n=t==="prod"?"":t,a=r==="platform"?"":`.${r}`;return`https://${e}${a}.org${n}.coveo.com`}function Pe(e,t="prod"){return`${Me(e,t)}/rest/search/v2`}function Wp(e,t="prod"){return`${Me(e,t,"analytics")}/rest/organizations/${e}/events/v1`}function dw(e){let{url:t,method:r,requestParams:n,contentType:a,accessToken:o,signal:i}=e,s=e.method==="POST"||e.method==="PUT",c=pw(n,a);return{url:t,method:r,headers:{"Content-Type":a,Authorization:`Bearer ${o}`,...e.headers},...s&&{body:c},signal:i}}function pw(e,t){return t==="application/x-www-form-urlencoded"?jy(e)?Dy(e):"":JSON.stringify(e)}var Tc=e=>e;import{isNullOrUndefined as Aw}from"../bueno/v1.1.0/bueno.esm.js";function Na(){return{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}}function tt(){return{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:Na(),pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:Na(),extendedResults:{},searchAction:void 0}}function _r(e){let{url:t,accessToken:r,organizationId:n,authentication:a,...o}=e;return o}var $r=e=>{let{response:t}=e;return t.body?mw(e):fw(t)},mw=e=>yw(e)?hw(e):gw(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},fw=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};function gw(e){return e.body.statusCode!==void 0}function yw(e){return e.body.exception!==void 0}var hw=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code});var Gr=class{constructor(){le(this,"currentAbortController",null)}async enqueue(t,r){let n=this.currentAbortController;this.currentAbortController=new AbortController;let a=this.currentAbortController;n&&(r.warnOnAbort&&r.logger.warn("Cancelling current pending search query"),n.abort());try{return await t(a?.signal??null)}finally{this.currentAbortController===a&&(this.currentAbortController=null)}}};function My(e){return((e.headers.get("content-type")||"").split(";").find(n=>n.indexOf("charset=")!==-1)||"").split("=")[1]||"UTF-8"}var Ar=(e,t,r,n)=>{let a=new Br(`${e.url}${n}`);return a.addParam("organizationId",e.organizationId),e.authentication&&a.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:a.href,origin:"searchApiFetch"}};var Qy=(e,t)=>{let r=new Br(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),e.authentication&&r.addParam("authentication",e.authentication),e.q!==void 0&&r.addParam("q",e.q),e.enableNavigation!==void 0&&r.addParam("enableNavigation",`${e.enableNavigation}`),e.requestedOutputSize!==void 0&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),r.href},Ly=async(e,t)=>{let r=await st.call({...Ar(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:_r(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=My(r),a=await r.arrayBuffer(),i=new TextDecoder(n).decode(a);return Sw(i)?{success:i}:{error:$r({response:r,body:i})}};function Sw(e){return typeof e=="string"}function Cw(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function xw(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function os(e,t){if(t&&e.name==="AbortError")return{error:xw(e)};if(e instanceof $n)return{error:Cw(e)};throw e}var Oc=class{constructor(t){this.options=t;le(this,"apiCallsQueues",{unknown:new Gr,mainSearch:new Gr,facetValues:new Gr,foldingCollection:new Gr,instantResults:new Gr})}async plan(t){let r=await st.call({...Ar(t,"POST","application/json","/plan"),requestParams:_r(t),requestMetadata:{method:"plan"},...this.options});if(r instanceof Error)return os(r);let n=await r.json();return Rw(n)?{success:n}:{error:$r({response:r,body:n})}}async querySuggest(t){let r=await st.call({...Ar(t,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:_r(t),...this.options});if(r instanceof Error)return os(r);let n=await r.json(),a={response:r,body:n};return Fw(n)?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(a)).body}:{error:$r(a)}}async search(t,r){let n=r?.origin??"unknown",a=await this.apiCallsQueues[n].enqueue(s=>st.call({...Ar(t,"POST","application/json",""),requestParams:_r(t),requestMetadata:{method:"search",origin:r?.origin},...this.options,signal:s??void 0}),{logger:this.options.logger,warnOnAbort:!r?.disableAbortWarning});if(a instanceof Error)return os(a,r?.disableAbortWarning);let o=await a.json(),i={response:a,body:o};return Uy(o)?(i.body=By(o),{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}):{error:$r(i)}}async facetSearch(t){let r=await st.call({...Ar(t,"POST","application/json","/facet"),requestParams:_r(t),requestMetadata:{method:"facetSearch"},...this.options});if(r instanceof Error)throw r;let n=await r.json(),a={response:r,body:n};return(await this.options.postprocessFacetSearchResponseMiddleware(a)).body}async recommendations(t){let r=await st.call({...Ar(t,"POST","application/json",""),requestParams:_r(t),requestMetadata:{method:"recommendations"},...this.options});if(r instanceof Error)throw r;let n=await r.json();if(Uy(n)){let a={response:r,body:n};return a.body=By(n),{success:(await this.options.postprocessSearchResponseMiddleware(a)).body}}return{error:$r({response:r,body:n})}}async html(t){return Ly(t,{...this.options})}async fieldDescriptions(t){let r=await st.call({...Ar(t,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(r instanceof Error)throw r;let n=await r.json();return bw(n)?{success:n}:{error:$r({response:r,body:n})}}},qc=e=>e.success!==void 0,Ee=e=>e.error!==void 0;function Uy(e){return e.results!==void 0}function By(e){let t=Na();return Aw(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}function Fw(e){return e.completions!==void 0}function Rw(e){return e.preprocessingOutput!==void 0}function bw(e){return e.fields!==void 0}var _y=e=>e,$y=e=>e,Gy=e=>e;import{ArrayValue as vw,RecordValue as ww,Schema as Pw,SchemaValidationError as Ew,StringValue as Gn}from"../bueno/v1.1.0/bueno.esm.js";var j=new Gn({required:!0,emptyAllowed:!1}),me=new Gn({required:!1,emptyAllowed:!1}),ce=new Gn({required:!0,emptyAllowed:!0}),Hy=new Gn({required:!1,emptyAllowed:!0}),Dc=new vw({each:j,required:!0}),zy=new Gn({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Wy=new Gn({required:!1,emptyAllowed:!1,regex:/^[a-zA-Z0-9_\-.]{1,100}$/}),eU=new Gn({required:!0,emptyAllowed:!1,regex:/^[a-zA-Z0-9_\-.]{1,100}$/}),Fr=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),ct=(e,t)=>{if("required"in t)return{payload:new Pw({value:t}).validate({value:e}).value};let a=new ww({options:{required:!0},values:t}).validate(e);if(a)throw new Ew(a);return{payload:e}},F=(e,t)=>{try{return ct(e,t)}catch(r){return{payload:e,error:Fr(r)}}},Ae=(e,t,r,n)=>{let a=`Check the initialState of ${n}`;return Yy(e,t,r,a,"Controller initialization error")},ue=(e,t,r,n)=>{let a=`Check the options of ${n}`;return Yy(e,t,r,a,"Controller initialization error")},Yy=(e,t,r,n,a)=>{try{return t.validate(r,n)}catch(o){throw e.logger.error(o,a),o}};import{isNullOrUndefined as Xm,RecordValue as jI,Schema as VI,StringValue as mu}from"../bueno/v1.1.0/bueno.esm.js";function qe(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Iw=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ky=Iw,Yp=()=>Math.random().toString(36).substring(7).split("").join("."),kw={INIT:`@@redux/INIT${Yp()}`,REPLACE:`@@redux/REPLACE${Yp()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Yp()}`},jc=kw;function Vt(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Kp(e,t,r){if(typeof e!="function")throw new Error(qe(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(qe(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(qe(1));return r(Kp)(e,t)}let n=e,a=t,o=new Map,i=o,s=0,c=!1;function u(){i===o&&(i=new Map,o.forEach((g,y)=>{i.set(y,g)}))}function l(){if(c)throw new Error(qe(3));return a}function p(g){if(typeof g!="function")throw new Error(qe(4));if(c)throw new Error(qe(5));let y=!0;u();let x=s++;return i.set(x,g),function(){if(y){if(c)throw new Error(qe(6));y=!1,u(),i.delete(x),o=null}}}function m(g){if(!Vt(g))throw new Error(qe(7));if(typeof g.type>"u")throw new Error(qe(8));if(typeof g.type!="string")throw new Error(qe(17));if(c)throw new Error(qe(9));try{c=!0,a=n(a,g)}finally{c=!1}return(o=i).forEach(x=>{x()}),g}function d(g){if(typeof g!="function")throw new Error(qe(10));n=g,m({type:jc.REPLACE})}function f(){let g=p;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(qe(11));function x(){let A=y;A.next&&A.next(l())}return x(),{unsubscribe:g(x)}},[Ky](){return this}}}return m({type:jc.INIT}),{dispatch:m,subscribe:p,getState:l,replaceReducer:d,[Ky]:f}}function Tw(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:jc.INIT})>"u")throw new Error(qe(12));if(typeof r(void 0,{type:jc.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(qe(13))})}function Ma(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),a,o;try{Tw(r)}catch(i){o=i}return function(s={},c){if(o)throw o;let u=!1,l={};for(let p=0;p<n.length;p++){let m=n[p],d=r[m],f=s[m],C=d(f,c);if(typeof C>"u"){let g=c&&c.type;throw new Error(qe(14))}l[m]=C,u=u||C!==f}return u=u||n.length!==Object.keys(s).length,u?l:s}}function Qa(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Jy(...e){return t=>(r,n)=>{let a=t(r,n),o=()=>{throw new Error(qe(15))},i={getState:a.getState,dispatch:(c,...u)=>o(c,...u)},s=e.map(c=>c(i));return o=Qa(...s)(a.dispatch),{...a,dispatch:o}}}function Vc(e){return Vt(e)&&"type"in e&&typeof e.type=="string"}var im=Symbol.for("immer-nothing"),is=Symbol.for("immer-draftable"),We=Symbol.for("immer-state");function De(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var zn=Object.getPrototypeOf;function rt(e){return!!e&&!!e[We]}function Ye(e){return e?rh(e)||Array.isArray(e)||!!e[is]||!!e.constructor?.[is]||La(e)||ps(e):!1}var Ow=Object.prototype.constructor.toString();function rh(e){if(!e||typeof e!="object")return!1;let t=zn(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Ow}function sm(e){return rt(e)||De(15,e),e[We].base_}function ss(e,t){Wn(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Wn(e){let t=e[We];return t?t.type_:Array.isArray(e)?1:La(e)?2:ps(e)?3:0}function cs(e,t){return Wn(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Jp(e,t){return Wn(e)===2?e.get(t):e[t]}function nh(e,t,r){let n=Wn(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function qw(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function La(e){return e instanceof Map}function ps(e){return e instanceof Set}function Hn(e){return e.copy_||e.base_}function em(e,t){if(La(e))return new Map(e);if(ps(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=rh(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[We];let a=Reflect.ownKeys(n);for(let o=0;o<a.length;o++){let i=a[o],s=n[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(zn(e),n)}else{let n=zn(e);if(n!==null&&r)return{...e};let a=Object.create(n);return Object.assign(a,e)}}function Lc(e,t=!1){return Uc(e)||rt(e)||!Ye(e)||(Wn(e)>1&&Object.defineProperties(e,{set:{value:Nc},add:{value:Nc},clear:{value:Nc},delete:{value:Nc}}),Object.freeze(e),t&&Object.values(e).forEach(r=>Lc(r,!0))),e}function Nc(){De(2)}function Uc(e){return Object.isFrozen(e)}var tm={};function Yn(e){let t=tm[e];return t||De(0,e),t}function Dw(e,t){tm[e]||(tm[e]=t)}var us;function ah(){return us}function jw(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Xy(e,t){t&&(Yn("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function rm(e){nm(e),e.drafts_.forEach(Vw),e.drafts_=null}function nm(e){e===us&&(us=e.parent_)}function Zy(e){return us=jw(us,e)}function Vw(e){let t=e[We];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function eh(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[We].modified_&&(rm(t),De(4)),Ye(e)&&(e=Mc(t,e),t.parent_||Qc(t,e)),t.patches_&&Yn("Patches").generateReplacementPatches_(r[We].base_,e,t.patches_,t.inversePatches_)):e=Mc(t,r,[]),rm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==im?e:void 0}function Mc(e,t,r){if(Uc(t))return t;let n=t[We];if(!n)return ss(t,(a,o)=>th(e,n,t,a,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Qc(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,o=a,i=!1;n.type_===3&&(o=new Set(a),a.clear(),i=!0),ss(o,(s,c)=>th(e,n,a,s,c,r,i)),Qc(e,a,!1),r&&e.patches_&&Yn("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function th(e,t,r,n,a,o,i){if(rt(a)){let s=o&&t&&t.type_!==3&&!cs(t.assigned_,n)?o.concat(n):void 0,c=Mc(e,a,s);if(nh(r,n,c),rt(c))e.canAutoFreeze_=!1;else return}else i&&r.add(a);if(Ye(a)&&!Uc(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Mc(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(La(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&Qc(e,a)}}function Qc(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Lc(t,r)}function Nw(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:ah(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,o=cm;r&&(a=[n],o=ls);let{revoke:i,proxy:s}=Proxy.revocable(a,o);return n.draft_=s,n.revoke_=i,s}var cm={get(e,t){if(t===We)return e;let r=Hn(e);if(!cs(r,t))return Mw(e,r,t);let n=r[t];return e.finalized_||!Ye(n)?n:n===Xp(e.base_,t)?(Zp(e),e.copy_[t]=om(n,e)):n},has(e,t){return t in Hn(e)},ownKeys(e){return Reflect.ownKeys(Hn(e))},set(e,t,r){let n=oh(Hn(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=Xp(Hn(e),t),o=a?.[We];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(qw(r,a)&&(r!==void 0||cs(e.base_,t)))return!0;Zp(e),am(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Xp(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Zp(e),am(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Hn(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){De(11)},getPrototypeOf(e){return zn(e.base_)},setPrototypeOf(){De(12)}},ls={};ss(cm,(e,t)=>{ls[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});ls.deleteProperty=function(e,t){return ls.set.call(this,e,t,void 0)};ls.set=function(e,t,r){return cm.set.call(this,e[0],t,r,e[0])};function Xp(e,t){let r=e[We];return(r?Hn(r):e)[t]}function Mw(e,t,r){let n=oh(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function oh(e,t){if(!(t in e))return;let r=zn(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=zn(r)}}function am(e){e.modified_||(e.modified_=!0,e.parent_&&am(e.parent_))}function Zp(e){e.copy_||(e.copy_=em(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Qw=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let o=r;r=t;let i=this;return function(c=o,...u){return i.produce(c,l=>r.call(this,l,...u))}}typeof r!="function"&&De(6),n!==void 0&&typeof n!="function"&&De(7);let a;if(Ye(t)){let o=Zy(this),i=om(t,void 0),s=!0;try{a=r(i),s=!1}finally{s?rm(o):nm(o)}return Xy(o,n),eh(a,o)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===im&&(a=void 0),this.autoFreeze_&&Lc(a,!0),n){let o=[],i=[];Yn("Patches").generateReplacementPatches_(t,a,o,i),n(o,i)}return a}else De(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...s)=>this.produceWithPatches(i,c=>t(c,...s));let n,a;return[this.produce(t,r,(i,s)=>{n=i,a=s}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ye(e)||De(8),rt(e)&&(e=ih(e));let t=Zy(this),r=om(e,void 0);return r[We].isManual_=!0,nm(t),r}finishDraft(e,t){let r=e&&e[We];(!r||!r.isManual_)&&De(9);let{scope_:n}=r;return Xy(n,t),eh(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));let n=Yn("Patches").applyPatches_;return rt(e)?n(e,t):this.produce(e,a=>n(a,t))}};function om(e,t){let r=La(e)?Yn("MapSet").proxyMap_(e,t):ps(e)?Yn("MapSet").proxySet_(e,t):Nw(e,t);return(t?t.scope_:ah()).drafts_.push(r),r}function ih(e){return rt(e)||De(10,e),sh(e)}function sh(e){if(!Ye(e)||Uc(e))return e;let t=e[We],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=em(e,t.scope_.immer_.useStrictShallowCopy_)}else r=em(e,!0);return ss(r,(n,a)=>{nh(r,n,sh(a))}),t&&(t.finalized_=!1),r}function ch(){let t="replace",r="add",n="remove";function a(m,d,f,C){switch(m.type_){case 0:case 2:return i(m,d,f,C);case 1:return o(m,d,f,C);case 3:return s(m,d,f,C)}}function o(m,d,f,C){let{base_:g,assigned_:y}=m,x=m.copy_;x.length<g.length&&([g,x]=[x,g],[f,C]=[C,f]);for(let h=0;h<g.length;h++)if(y[h]&&x[h]!==g[h]){let A=d.concat([h]);f.push({op:t,path:A,value:p(x[h])}),C.push({op:t,path:A,value:p(g[h])})}for(let h=g.length;h<x.length;h++){let A=d.concat([h]);f.push({op:r,path:A,value:p(x[h])})}for(let h=x.length-1;g.length<=h;--h){let A=d.concat([h]);C.push({op:n,path:A})}}function i(m,d,f,C){let{base_:g,copy_:y}=m;ss(m.assigned_,(x,h)=>{let A=Jp(g,x),E=Jp(y,x),v=h?cs(g,x)?t:r:n;if(A===E&&v===t)return;let R=d.concat(x);f.push(v===n?{op:v,path:R}:{op:v,path:R,value:E}),C.push(v===r?{op:n,path:R}:v===n?{op:r,path:R,value:p(A)}:{op:t,path:R,value:p(A)})})}function s(m,d,f,C){let{base_:g,copy_:y}=m,x=0;g.forEach(h=>{if(!y.has(h)){let A=d.concat([x]);f.push({op:n,path:A,value:h}),C.unshift({op:r,path:A,value:h})}x++}),x=0,y.forEach(h=>{if(!g.has(h)){let A=d.concat([x]);f.push({op:r,path:A,value:h}),C.unshift({op:n,path:A,value:h})}x++})}function c(m,d,f,C){f.push({op:t,path:[],value:d===im?void 0:d}),C.push({op:t,path:[],value:m})}function u(m,d){return d.forEach(f=>{let{path:C,op:g}=f,y=m;for(let E=0;E<C.length-1;E++){let v=Wn(y),R=C[E];typeof R!="string"&&typeof R!="number"&&(R=""+R),(v===0||v===1)&&(R==="__proto__"||R==="constructor")&&De(19),typeof y=="function"&&R==="prototype"&&De(19),y=Jp(y,R),typeof y!="object"&&De(18,C.join("/"))}let x=Wn(y),h=l(f.value),A=C[C.length-1];switch(g){case t:switch(x){case 2:return y.set(A,h);case 3:De(16);default:return y[A]=h}case r:switch(x){case 1:return A==="-"?y.push(h):y.splice(A,0,h);case 2:return y.set(A,h);case 3:return y.add(h);default:return y[A]=h}case n:switch(x){case 1:return y.splice(A,1);case 2:return y.delete(A);case 3:return y.delete(f.value);default:return delete y[A]}default:De(17,g)}}),m}function l(m){if(!Ye(m))return m;if(Array.isArray(m))return m.map(l);if(La(m))return new Map(Array.from(m.entries()).map(([f,C])=>[f,l(C)]));if(ps(m))return new Set(Array.from(m).map(l));let d=Object.create(zn(m));for(let f in m)d[f]=l(m[f]);return cs(m,is)&&(d[is]=m[is]),d}function p(m){return rt(m)?l(m):m}Dw("Patches",{applyPatches_:u,generatePatches_:a,generateReplacementPatches_:c})}var ds=new Qw,Rr=ds.produce,Bc=ds.produceWithPatches.bind(ds);var um=ds.applyPatches.bind(ds);function Lw(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Uw(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Bw(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var uh=e=>Array.isArray(e)?e:[e];function _w(e){let t=Array.isArray(e[0])?e[0]:e;return Bw(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function $w(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var oU=Symbol();var iU=Object.getPrototypeOf({});var Gw=class{constructor(e){this.value=e}deref(){return this.value}},Hw=typeof WeakRef<"u"?WeakRef:Gw,zw=0,lh=1;function _c(){return{s:zw,v:void 0,o:null,p:null}}function Ua(e,t={}){let r=_c(),{resultEqualityCheck:n}=t,a,o=0;function i(){let s=r,{length:c}=arguments;for(let p=0,m=c;p<m;p++){let d=arguments[p];if(typeof d=="function"||typeof d=="object"&&d!==null){let f=s.o;f===null&&(s.o=f=new WeakMap);let C=f.get(d);C===void 0?(s=_c(),f.set(d,s)):s=C}else{let f=s.p;f===null&&(s.p=f=new Map);let C=f.get(d);C===void 0?(s=_c(),f.set(d,s)):s=C}}let u=s,l;if(s.s===lh)l=s.v;else if(l=e.apply(null,arguments),o++,n){let p=a?.deref?.()??a;p!=null&&n(p,l)&&(l=p,o!==0&&o--),a=typeof l=="object"&&l!==null||typeof l=="function"?new Hw(l):l}return u.s=lh,u.v=l,l}return i.clearCache=()=>{r=_c(),i.resetResultsCount()},i.resultsCount=()=>o,i.resetResultsCount=()=>{o=0},i}function dh(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let o=0,i=0,s,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),Lw(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);let l={...r,...c},{memoize:p,memoizeOptions:m=[],argsMemoize:d=Ua,argsMemoizeOptions:f=[],devModeChecks:C={}}=l,g=uh(m),y=uh(f),x=_w(a),h=p(function(){return o++,u.apply(null,arguments)},...g),A=!0,E=d(function(){i++;let R=$w(x,arguments);return s=h.apply(null,R),s},...y);return Object.assign(E,{resultFunc:u,memoizedResultFunc:h,dependencies:x,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>s,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:p,argsMemoize:d})};return Object.assign(n,{withTypes:()=>n}),n}var Y=dh(Ua),Ww=Object.assign((e,t=Y)=>{Uw(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(o=>e[o]);return t(n,(...o)=>o.reduce((i,s,c)=>(i[r[c]]=s,i),{}))},{withTypes:()=>Ww});function ph(e){return({dispatch:r,getState:n})=>a=>o=>typeof o=="function"?o(r,n,e):a(o)}var mh=ph(),fh=ph;var Yw=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qa:Qa.apply(null,arguments)},yU=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},Kw=e=>e&&typeof e.match=="function";function S(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(bt(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Vc(n)&&n.type===e,r}var Ch=class ms extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ms.prototype)}static get[Symbol.species](){return ms}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ms(...t[0].concat(this)):new ms(...t.concat(this))}};function gh(e){return Ye(e)?Rr(e,()=>{}):e}function yh(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Jw(e){return typeof e=="boolean"}var Xw=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:o=!0}=t??{},i=new Ch;return r&&(Jw(r)?i.push(mh):i.push(fh(r.extraArgument))),i},fs="RTK_autoBatch",_a=()=>e=>({payload:e,meta:{[fs]:!0}}),hh=e=>t=>{setTimeout(t,e)},Zw=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,o=!1,i=!1,s=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:hh(10):e.type==="callback"?e.queueNotification:hh(e.timeout),u=()=>{i=!1,o&&(o=!1,s.forEach(l=>l()))};return Object.assign({},n,{subscribe(l){let p=()=>a&&l(),m=n.subscribe(p);return s.add(l),()=>{m(),s.delete(l)}},dispatch(l){try{return a=!l?.meta?.[fs],o=!a,o&&(i||(i=!0,c(u))),n.dispatch(l)}finally{a=!0}}})},eP=e=>function(r){let{autoBatch:n=!0}=r??{},a=new Ch(e);return n&&a.push(Zw(typeof n=="object"?n:void 0)),a};function xh(e){let t=Xw(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:o=void 0,enhancers:i=void 0}=e||{},s;if(typeof r=="function")s=r;else if(Vt(r))s=Ma(r);else throw new Error(bt(1));let c;typeof n=="function"?c=n(t):c=t();let u=Qa;a&&(u=Yw({trace:!1,...typeof a=="object"&&a}));let l=Jy(...c),p=eP(l),m=typeof i=="function"?i(p):p(),d=u(...m);return Kp(s,o,d)}function Ah(e){let t={},r=[],n,a={addCase(o,i){let s=typeof o=="string"?o:o.type;if(!s)throw new Error(bt(28));if(s in t)throw new Error(bt(29));return t[s]=i,a},addMatcher(o,i){return r.push({matcher:o,reducer:i}),a},addDefaultCase(o){return n=o,a}};return e(a),[t,r,n]}function tP(e){return typeof e=="function"}function $(e,t){let[r,n,a]=Ah(t),o;if(tP(e))o=()=>gh(e());else{let s=gh(e);o=()=>s}function i(s=o(),c){let u=[r[c.type],...n.filter(({matcher:l})=>l(c)).map(({reducer:l})=>l)];return u.filter(l=>!!l).length===0&&(u=[a]),u.reduce((l,p)=>{if(p)if(rt(l)){let d=p(l,c);return d===void 0?l:d}else{if(Ye(l))return Rr(l,m=>p(m,c));{let m=p(l,c);if(m===void 0){if(l===null)return l;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return l},s)}return i.getInitialState=o,i}var Fh=(e,t)=>Kw(e)?e.match(t):e(t);function Nt(...e){return t=>e.some(r=>Fh(r,t))}function Ba(...e){return t=>e.every(r=>Fh(r,t))}function Gc(e,t){if(!e||!e.meta)return!1;let r=typeof e.meta.requestId=="string",n=t.indexOf(e.meta.requestStatus)>-1;return r&&n}function gs(e){return typeof e[0]=="function"&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function Hc(...e){return e.length===0?t=>Gc(t,["pending"]):gs(e)?Nt(...e.map(t=>t.pending)):Hc()(e[0])}function Kn(...e){return e.length===0?t=>Gc(t,["rejected"]):gs(e)?Nt(...e.map(t=>t.rejected)):Kn()(e[0])}function ys(...e){let t=r=>r&&r.meta&&r.meta.rejectedWithValue;return e.length===0?Ba(Kn(...e),t):gs(e)?Ba(Kn(...e),t):ys()(e[0])}function br(...e){return e.length===0?t=>Gc(t,["fulfilled"]):gs(e)?Nt(...e.map(t=>t.fulfilled)):br()(e[0])}function zc(...e){return e.length===0?t=>Gc(t,["pending","fulfilled","rejected"]):gs(e)?Nt(...e.flatMap(t=>[t.pending,t.rejected,t.fulfilled])):zc()(e[0])}var rP="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Wc=(e=21)=>{let t="",r=e;for(;r--;)t+=rP[Math.random()*64|0];return t},nP=["name","message","stack","code"],lm=class{constructor(e,t){le(this,"_type");this.payload=e,this.meta=t}},Sh=class{constructor(e,t){le(this,"_type");this.payload=e,this.meta=t}},aP=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of nP)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},G=(()=>{function e(t,r,n){let a=S(t+"/fulfilled",(c,u,l,p)=>({payload:c,meta:{...p||{},arg:l,requestId:u,requestStatus:"fulfilled"}})),o=S(t+"/pending",(c,u,l)=>({payload:void 0,meta:{...l||{},arg:u,requestId:c,requestStatus:"pending"}})),i=S(t+"/rejected",(c,u,l,p,m)=>({payload:p,error:(n&&n.serializeError||aP)(c||"Rejected"),meta:{...m||{},arg:l,requestId:u,rejectedWithValue:!!p,requestStatus:"rejected",aborted:c?.name==="AbortError",condition:c?.name==="ConditionError"}}));function s(c){return(u,l,p)=>{let m=n?.idGenerator?n.idGenerator(c):Wc(),d=new AbortController,f,C;function g(x){C=x,d.abort()}let y=async function(){let x;try{let A=n?.condition?.(c,{getState:l,extra:p});if(iP(A)&&(A=await A),A===!1||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let E=new Promise((v,R)=>{f=()=>{R({name:"AbortError",message:C||"Aborted"})},d.signal.addEventListener("abort",f)});u(o(m,c,n?.getPendingMeta?.({requestId:m,arg:c},{getState:l,extra:p}))),x=await Promise.race([E,Promise.resolve(r(c,{dispatch:u,getState:l,extra:p,requestId:m,signal:d.signal,abort:g,rejectWithValue:(v,R)=>new lm(v,R),fulfillWithValue:(v,R)=>new Sh(v,R)})).then(v=>{if(v instanceof lm)throw v;return v instanceof Sh?a(v.payload,m,c,v.meta):a(v,m,c)})])}catch(A){x=A instanceof lm?i(null,m,c,A.payload,A.meta):i(A,m,c)}finally{f&&d.signal.removeEventListener("abort",f)}return n&&!n.dispatchConditionRejection&&i.match(x)&&x.meta.condition||u(x),x}();return Object.assign(y,{abort:g,requestId:m,arg:c,unwrap(){return y.then(oP)}})}}return Object.assign(s,{pending:o,rejected:i,fulfilled:a,settled:Nt(i,a),typePrefix:t})}return e.withTypes=()=>e,e})();function oP(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function iP(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Rh=Symbol.for("rtk-slice-createasyncthunk"),AU={[Rh]:G};function sP(e,t){return`${e}/${t}`}function cP({creators:e}={}){let t=e?.asyncThunk?.[Rh];return function(n){let{name:a,reducerPath:o=a}=n;if(!a)throw new Error(bt(11));typeof process<"u";let i=(typeof n.reducers=="function"?n.reducers(lP()):n.reducers)||{},s=Object.keys(i),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(x,h){let A=typeof x=="string"?x:x.type;if(!A)throw new Error(bt(12));if(A in c.sliceCaseReducersByType)throw new Error(bt(13));return c.sliceCaseReducersByType[A]=h,u},addMatcher(x,h){return c.sliceMatchers.push({matcher:x,reducer:h}),u},exposeAction(x,h){return c.actionCreators[x]=h,u},exposeCaseReducer(x,h){return c.sliceCaseReducersByName[x]=h,u}};s.forEach(x=>{let h=i[x],A={reducerName:x,type:sP(a,x),createNotation:typeof n.reducers=="function"};pP(h)?fP(A,h,u,t):dP(A,h,u)});function l(){let[x={},h=[],A=void 0]=typeof n.extraReducers=="function"?Ah(n.extraReducers):[n.extraReducers],E={...x,...c.sliceCaseReducersByType};return $(n.initialState,v=>{for(let R in E)v.addCase(R,E[R]);for(let R of c.sliceMatchers)v.addMatcher(R.matcher,R.reducer);for(let R of h)v.addMatcher(R.matcher,R.reducer);A&&v.addDefaultCase(A)})}let p=x=>x,m=new Map,d;function f(x,h){return d||(d=l()),d(x,h)}function C(){return d||(d=l()),d.getInitialState()}function g(x,h=!1){function A(v){let R=v[x];return typeof R>"u"&&h&&(R=C()),R}function E(v=p){let R=yh(m,h,()=>new WeakMap);return yh(R,v,()=>{let b={};for(let[w,k]of Object.entries(n.selectors??{}))b[w]=uP(k,v,C,h);return b})}return{reducerPath:x,getSelectors:E,get selectors(){return E(A)},selectSlice:A}}let y={name:a,reducer:f,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:C,...g(o),injectInto(x,{reducerPath:h,...A}={}){let E=h??o;return x.inject({reducerPath:E,reducer:f},A),{...y,...g(E,!0)}}};return y}}function uP(e,t,r,n){function a(o,...i){let s=t(o);return typeof s>"u"&&n&&(s=r()),e(s,...i)}return a.unwrapped=e,a}var Jn=cP();function lP(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function dP({type:e,reducerName:t,createNotation:r},n,a){let o,i;if("reducer"in n){if(r&&!mP(n))throw new Error(bt(17));o=n.reducer,i=n.prepare}else o=n;a.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,i?S(e,i):S(e))}function pP(e){return e._reducerDefinitionType==="asyncThunk"}function mP(e){return e._reducerDefinitionType==="reducerWithPrepare"}function fP({type:e,reducerName:t},r,n,a){if(!a)throw new Error(bt(18));let{payloadCreator:o,fulfilled:i,pending:s,rejected:c,settled:u,options:l}=r,p=a(e,o,l);n.exposeAction(t,p),i&&n.addCase(p.fulfilled,i),s&&n.addCase(p.pending,s),c&&n.addCase(p.rejected,c),u&&n.addMatcher(p.settled,u),n.exposeCaseReducer(t,{fulfilled:i||$c,pending:s||$c,rejected:c||$c,settled:u||$c})}function $c(){}var bh="listener",vh="completed",wh="cancelled",FU=`task-${wh}`,RU=`task-${vh}`,bU=`${bh}-${wh}`,vU=`${bh}-${vh}`;var{assign:Ph}=Object;var dm="listenerMiddleware";var gP=Ph(S(`${dm}/add`),{withTypes:()=>gP}),wU=S(`${dm}/removeAll`),yP=Ph(S(`${dm}/remove`),{withTypes:()=>yP});var PU=Symbol.for("rtk-state-proxy-original");function bt(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Eh=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function hP(e){return typeof e=="string"&&Eh.test(e)}var pm=hP;var je=[];for(let e=0;e<256;++e)je.push((e+256).toString(16).slice(1));function Ih(e,t=0){return(je[e[t+0]]+je[e[t+1]]+je[e[t+2]]+je[e[t+3]]+"-"+je[e[t+4]]+je[e[t+5]]+"-"+je[e[t+6]]+je[e[t+7]]+"-"+je[e[t+8]]+je[e[t+9]]+"-"+je[e[t+10]]+je[e[t+11]]+je[e[t+12]]+je[e[t+13]]+je[e[t+14]]+je[e[t+15]]).toLowerCase()}var mm,SP=new Uint8Array(16);function fm(){if(!mm){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");mm=crypto.getRandomValues.bind(crypto)}return mm(SP)}var CP=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),gm={randomUUID:CP};function xP(e,t,r){if(gm.randomUUID&&!t&&!e)return gm.randomUUID();e=e||{};let n=e.random??e.rng?.()??fm();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(r=r||0,r<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let a=0;a<16;++a)t[r+a]=n[a];return t}return Ih(n)}var ym=xP;function kh(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}function AP({config:e,environment:t,event:r,listenerManager:n}){let{url:a,token:o,mode:i}=e;i!=="disabled"&&(n.call(r),t.send(a,o,r))}var Th="visitorId";function FP(e){return{getClientId:()=>{let t=e.get(),r=t.storage,n=r.getItem(Th),a=n&&pm(n)?n:t.generateUUID();return r.setItem(Th,a),a}}}var Vh="1.2.6",hm=128,Nh=192,Oh=224,qh=240,RP=248;function bP(e){return(e&RP)===qh?4:(e&qh)===Oh?3:(e&Oh)===Nh?2:1}function vP(e,t){if(t<0||e.length<=t)return e;let r=e.indexOf("%",t-2);for(r<0||r>t?r=t:t=r;r>2&&e.charAt(r-3)=="%";){let n=Number.parseInt(e.substring(r-2,r),16);if((n&hm)!=hm)break;if(r-=3,(n&Nh)!=hm){t-r>=bP(n)*3&&(r=t);break}}return e.substring(0,r)}function wP(e){let{trackingId:t}=e;return{trackingId:t}}function PP(e){return(e.source||[]).concat([`relay@${Vh}`])}function Mh(e,t,r,n){let{getReferrer:a,getLocation:o,getUserAgent:i}=r,s=wP(t),c=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:PP(t),clientId:c,userAgent:i(),referrer:Dh(a()),location:Dh(o())})}function Dh(e){return e!==null?vP(e,1024):null}function EP(e,t,r,n,a){return{...t,meta:Mh(e,r,n,a)}}var IP="*";function kP(){let e=[];function t({type:c,callback:u}){return e.findIndex(l=>l.type===c&&l.callback===u)}function r(c,u){return c.type==="*"||u===c.type}function n(c){return t(c)<0&&e.push(c),()=>s(c.type,c.callback)}function a(c){e.forEach(u=>{if(r(u,c.meta.type))try{u.callback(c)}catch(l){console.error(l)}})}function o(c){if(c===IP)e.length=0;else for(let u=e.length-1;u>=0;u--)e[u].type===c&&e.splice(u,1)}function i(c){let u=t(c);u>=0&&e.splice(u,1)}function s(c,u){u?i({type:c,callback:u}):o(c)}return{add:n,call:a,remove:s}}function jh({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source},...!!n.environment&&{environment:n.environment}})}function TP(e){let t=jh(e);return{get:()=>t,update:r=>{t=jh({...t,...r})}}}var Sm=OP();function OP(){let e="coveo_",t=r=>{let n=r.split(".").slice(-2);return n.length==2?n.join("."):""};return{getItem(r){let n=`${e}${r}=`,a=document.cookie.split(";");for(let o of a){let i=o.replace(/^\s+/,"");if(i.lastIndexOf(n,0)===0)return i.substring(n.length,i.length)}return null},setItem(r,n,a){let o=t(window.location.hostname),i=`;expires=${new Date(new Date().getTime()+a).toUTCString()}`,s=o?`;domain=${o}`:"";document.cookie=`${e}${r}=${n}${i}${s};path=/;SameSite=Lax`},removeItem(r){this.setItem(r,"",-1)}}}function qP(){return{getItem(e){return Sm.getItem(e)||localStorage.getItem(e)},removeItem(e){Sm.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),Sm.setItem(e,t,31556952e3)}}}function DP(){let e=document.referrer;return e===""?null:e}function jP(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(kh().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>DP(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>ym(),storage:qP()}}function VP(){try{let e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return e instanceof DOMException&&e.name==="QuotaExceededError"&&localStorage&&localStorage.length!==0}}function NP(){return{getItem(){return null},removeItem(){},setItem(){}}}function MP(){return{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:NP()}}function QP(e){let t=e.get().mode!=="disabled",r=e.get().environment,n=MP();return t&&r?{storage:n.storage,...r,runtime:"custom"}:t&&LP()&&VP()?jP():n}function LP(){try{return typeof window=="object"}catch{return!1}}function UP(e){return{get:()=>Object.freeze(QP(e))}}function Qh(e){let t=TP(e),r=kP(),n=UP(t),a=FP(n);return{emit:(o,i)=>{let s=t.get(),c=n.get(),u=EP(o,i,s,c,a);return AP({config:s,environment:c,event:u,listenerManager:r})},getMeta:o=>Mh(o,t.get(),n.get(),a),on:(o,i)=>r.add({type:o,callback:i}),off:(o,i)=>r.remove(o,i),updateConfig:o=>t.update(o),version:Vh}}var Xn="3.29.2",Lh=["@coveo/atomic","@coveo/quantic"];var Hr=Y(e=>e.source,e=>Object.entries(e).map(([t,r])=>`${t}@${r}`).concat(`@coveo/headless@${Xn}`));var hs=Y(e=>e.configuration.organizationId,e=>e.configuration.environment,e=>e.configuration.accessToken,e=>e.configuration.analytics,e=>Hr(e.configuration.analytics),(e,t)=>BP(t),(e,t,r,{trackingId:n,apiBaseUrl:a,enabled:o},i,s)=>Qh({mode:o?"emit":"disabled",url:a??Wp(e,t),token:r,trackingId:n??null,source:i,environment:s})),BP=e=>{if(!e)return;let t=e();return{getLocation:()=>t.location,getReferrer:()=>t.referrer,getUserAgent:()=>t.userAgent,generateUUID:()=>t.clientId}};function vr(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function P(e,t,r,n){function a(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function s(l){try{u(n.next(l))}catch(p){i(p)}}function c(l){try{u(n.throw(l))}catch(p){i(p)}}function u(l){l.done?o(l.value):a(l.value).then(s,c)}u((n=n.apply(e,t||[])).next())})}var ne;(function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"})(ne||(ne={}));function Am(){return typeof window<"u"}function Dm(){return typeof navigator<"u"}function $a(){return typeof document<"u"}function Fm(){try{return typeof localStorage<"u"}catch{return!1}}function _P(){try{return typeof sessionStorage<"u"}catch{return!1}}function eS(){return Dm()&&navigator.cookieEnabled}var $P=[ne.click,ne.custom,ne.search,ne.view],GP=(e,t)=>$P.indexOf(e)!==-1?Object.assign({language:$a()?document.documentElement.lang:"unknown",userAgent:Dm()?navigator.userAgent:"unknown"},t):t,Cs=class e{static set(t,r,n){var a,o,i,s;n&&(o=new Date,o.setTime(o.getTime()+n)),s=window.location.hostname,s.indexOf(".")===-1?Uh(t,r,o):(i=s.split("."),a=i[i.length-2]+"."+i[i.length-1],Uh(t,r,o,a))}static get(t){for(var r=t+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){var o=n[a];if(o=o.replace(/^\s+/,""),o.lastIndexOf(r,0)===0)return o.substring(r.length,o.length)}return null}static erase(t){e.set(t,"",-1)}};function Uh(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function HP(){return Fm()?localStorage:eS()?new xs:_P()?sessionStorage:new Ha}var xs=class e{getItem(t){return Cs.get(`${e.prefix}${t}`)}removeItem(t){Cs.erase(`${e.prefix}${t}`)}setItem(t,r,n){Cs.set(`${e.prefix}${t}`,r,n)}};xs.prefix="coveo_";var Rm=class{constructor(){this.cookieStorage=new xs}getItem(t){return localStorage.getItem(t)||this.cookieStorage.getItem(t)}removeItem(t){this.cookieStorage.removeItem(t),localStorage.removeItem(t)}setItem(t,r){localStorage.setItem(t,r),this.cookieStorage.setItem(t,r,31556926e3)}},Ha=class{getItem(t){return null}removeItem(t){}setItem(t,r){}},Yc="__coveo.analytics.history",zP=20,WP=1e3*60,YP=75,Xc=class{constructor(t){this.store=t||HP()}addElement(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=this.getHistoryWithInternalTime();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t])}addElementAsync(t){return P(this,void 0,void 0,function*(){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=yield this.getHistoryWithInternalTimeAsync();r!=null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t])})}getHistory(){let t=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(t))}getHistoryAsync(){return P(this,void 0,void 0,function*(){let t=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(t))})}getHistoryWithInternalTime(){try{let t=this.store.getItem(Yc);return t&&typeof t=="string"?JSON.parse(t):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return P(this,void 0,void 0,function*(){try{let t=yield this.store.getItem(Yc);return t?JSON.parse(t):[]}catch{return[]}})}setHistory(t){try{this.store.setItem(Yc,JSON.stringify(t.slice(0,zP)))}catch{}}clear(){try{this.store.removeItem(Yc)}catch{}}getMostRecentElement(){let t=this.getHistoryWithInternalTime();return Array.isArray(t)?t.sort((n,a)=>(a.internalTime||0)-(n.internalTime||0))[0]:null}cropQueryElement(t){return t.name&&t.value&&t.name.toLowerCase()==="query"&&(t.value=t.value.slice(0,YP)),t}isValidEntry(t){let r=this.getMostRecentElement();return r&&r.value==t.value?(t.internalTime||0)-(r.internalTime||0)>WP:!0}stripInternalTime(t){return Array.isArray(t)?t.map(r=>{let{name:n,time:a,value:o}=r;return{name:n,time:a,value:o}}):[]}stripEmptyQuery(t){let{name:r,time:n,value:a}=t;return r&&typeof a=="string"&&r.toLowerCase()==="query"&&a.trim()===""?{name:r,time:n}:t}stripEmptyQueries(t){return t.map(r=>this.stripEmptyQuery(r))}};var KP=(e,t)=>P(void 0,void 0,void 0,function*(){return e===ne.view?(yield JP(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t}),JP=e=>P(void 0,void 0,void 0,function*(){let t=new Xc,r={name:"PageView",value:e,time:new Date().toISOString()};yield t.addElementAsync(r)}),Kc,XP=new Uint8Array(16);function ZP(){if(!Kc&&(Kc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Kc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Kc(XP)}var eE=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Zc(e){return typeof e=="string"&&eE.test(e)}var Ve=[];for(let e=0;e<256;++e)Ve.push((e+256).toString(16).slice(1));function tS(e,t=0){return(Ve[e[t+0]]+Ve[e[t+1]]+Ve[e[t+2]]+Ve[e[t+3]]+"-"+Ve[e[t+4]]+Ve[e[t+5]]+"-"+Ve[e[t+6]]+Ve[e[t+7]]+"-"+Ve[e[t+8]]+Ve[e[t+9]]+"-"+Ve[e[t+10]]+Ve[e[t+11]]+Ve[e[t+12]]+Ve[e[t+13]]+Ve[e[t+14]]+Ve[e[t+15]]).toLowerCase()}function tE(e){if(!Zc(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=t&255,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=t&255,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=t&255,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=t&255,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=t&255,r}function rE(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}var nE="6ba7b810-9dad-11d1-80b4-00c04fd430c8",aE="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function oE(e,t,r){function n(a,o,i,s){var c;if(typeof a=="string"&&(a=rE(a)),typeof o=="string"&&(o=tE(o)),((c=o)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+a.length);if(u.set(o),u.set(a,o.length),u=r(u),u[6]=u[6]&15|t,u[8]=u[8]&63|128,i){s=s||0;for(let l=0;l<16;++l)i[s+l]=u[l];return i}return tS(u)}try{n.name=e}catch{}return n.DNS=nE,n.URL=aE,n}var iE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Bh={randomUUID:iE};function Zn(e,t,r){if(Bh.randomUUID&&!t&&!e)return Bh.randomUUID();e=e||{};let n=e.random||(e.rng||ZP)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let a=0;a<16;++a)t[r+a]=n[a];return t}return tS(n)}function sE(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function Cm(e,t){return e<<t|e>>>32-t}function cE(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){let i=unescape(encodeURIComponent(e));e=[];for(let s=0;s<i.length;++s)e.push(i.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,a=Math.ceil(n/16),o=new Array(a);for(let i=0;i<a;++i){let s=new Uint32Array(16);for(let c=0;c<16;++c)s[c]=e[i*64+c*4]<<24|e[i*64+c*4+1]<<16|e[i*64+c*4+2]<<8|e[i*64+c*4+3];o[i]=s}o[a-1][14]=(e.length-1)*8/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=(e.length-1)*8&4294967295;for(let i=0;i<a;++i){let s=new Uint32Array(80);for(let d=0;d<16;++d)s[d]=o[i][d];for(let d=16;d<80;++d)s[d]=Cm(s[d-3]^s[d-8]^s[d-14]^s[d-16],1);let c=r[0],u=r[1],l=r[2],p=r[3],m=r[4];for(let d=0;d<80;++d){let f=Math.floor(d/20),C=Cm(c,5)+sE(f,u,l,p)+m+t[f]+s[d]>>>0;m=p,p=l,l=Cm(u,30)>>>0,u=c,c=C}r[0]=r[0]+c>>>0,r[1]=r[1]+u>>>0,r[2]=r[2]+l>>>0,r[3]=r[3]+p>>>0,r[4]=r[4]+m>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var uE=oE("v5",80,cE),_h=uE,rS="2.30.45",$h=e=>`${e.protocol}//${e.hostname}${e.pathname.indexOf("/")===0?e.pathname:`/${e.pathname}`}${e.search}`,Ss={pageview:"pageview",event:"event"},eu=class{constructor({client:t,uuidGenerator:r=Zn}){this.client=t,this.uuidGenerator=r}},bm=class extends eu{constructor({client:t,uuidGenerator:r=Zn}){super({client:t,uuidGenerator:r}),this.actionData={},this.pageViewId=r(),this.nextPageViewId=this.pageViewId,this.currentLocation=$h(window.location),this.lastReferrer=$a()?document.referrer:"",this.addHooks()}getApi(t){switch(t){case"setAction":return this.setAction;default:return null}}setAction(t,r){this.action=t,this.actionData=r}clearData(){this.clearPluginData(),this.action=void 0,this.actionData={}}getLocationInformation(t,r){return Object.assign({hitType:t},this.getNextValues(t,r))}updateLocationInformation(t,r){this.updateLocationForNextPageView(t,r)}getDefaultContextInformation(t){let r={title:$a()?document.title:"",encoding:$a()?document.characterSet:"UTF-8"},n={screenResolution:`${screen.width}x${screen.height}`,screenColor:`${screen.colorDepth}-bit`},a={language:navigator.language,userAgent:navigator.userAgent},o={time:Date.now(),eventId:this.uuidGenerator()};return Object.assign(Object.assign(Object.assign(Object.assign({},o),n),a),r)}updateLocationForNextPageView(t,r){let{pageViewId:n,referrer:a,location:o}=this.getNextValues(t,r);this.lastReferrer=a,this.pageViewId=n,this.currentLocation=o,t===Ss.pageview&&(this.nextPageViewId=this.uuidGenerator(),this.hasSentFirstPageView=!0)}getNextValues(t,r){return{pageViewId:t===Ss.pageview?this.nextPageViewId:this.pageViewId,referrer:t===Ss.pageview&&this.hasSentFirstPageView?this.currentLocation:this.lastReferrer,location:t===Ss.pageview?this.getCurrentLocationFromPayload(r):this.currentLocation}}getCurrentLocationFromPayload(t){if(t.page){let r=a=>a.replace(/^\/?(.*)$/,"/$1");return`${(a=>a.split("/").slice(0,3).join("/"))(this.currentLocation)}${r(t.page)}`}else return $h(window.location)}},zr=class e{constructor(t,r){if(!Zc(t))throw Error("Not a valid uuid");this.clientId=t,this.creationDate=Math.floor(r/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(t,r){return!this.expired&&this.matchReferrer(t,r)}matchReferrer(t,r){try{let n=new URL(t);return r.some(a=>new RegExp(a.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(n.host))}catch{return!1}}static fromString(t){let r=t.split(".");if(r.length!==2)return null;let[n,a]=r;if(n.length!==32||isNaN(parseInt(a)))return null;let o=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return Zc(o)?new e(o,Number.parseInt(a)*1e3):null}};zr.cvo_cid="cvo_cid";zr.expirationTime=120;var vm=class extends eu{constructor({client:t,uuidGenerator:r=Zn}){super({client:t,uuidGenerator:r})}getApi(t){switch(t){case"decorate":return this.decorate;case"acceptFrom":return this.acceptFrom;default:return null}}decorate(t){return P(this,void 0,void 0,function*(){if(!this.client.getCurrentVisitorId)throw new Error("Could not retrieve current clientId");try{let r=new URL(t),n=yield this.client.getCurrentVisitorId();return r.searchParams.set(zr.cvo_cid,new zr(n,Date.now()).toString()),r.toString()}catch{throw new Error("Invalid URL provided")}})}acceptFrom(t){this.client.setAcceptedLinkReferrers(t)}};vm.Id="link";var lt=Object.keys;function Jc(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}var xm=128,nS=192,Gh=224,Hh=240;function lE(e){return(e&248)===Hh?4:(e&Hh)===Gh?3:(e&Gh)===nS?2:1}function dE(e,t){if(t<0||e.length<=t)return e;let r=e.indexOf("%",t-2);for(r<0||r>t?r=t:t=r;r>2&&e.charAt(r-3)=="%";){let n=Number.parseInt(e.substring(r-2,r),16);if((n&xm)!=xm)break;if(r-=3,(n&nS)!=xm){t-r>=lE(n)*3&&(r=t);break}}return e.substring(0,r)}var wm={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},pE=lt(wm).map(e=>wm[e]),mE=[...pE].join("|"),fE=new RegExp(`^(${mE}$)`),gE={svcAction:"svc_action",svcActionData:"svc_action_data"},yE=e=>lt(e).filter(t=>e[t]!==void 0).reduce((t,r)=>{let n=wm[r]||r;return Object.assign(Object.assign({},t),{[n]:e[r]})},{}),hE=e=>fE.test(e),SE=[hE],zh={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},Wh={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Qe={action:"pa",list:"pal",listSource:"pls"},tu={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},CE=["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit"],Pm={id:"quoteId",affiliation:"quoteAffiliation"},Em={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},xE={add:Qe,bookmark_add:Qe,bookmark_remove:Qe,click:Qe,checkout:Qe,checkout_option:Qe,detail:Qe,impression:Qe,remove:Qe,refund:Object.assign(Object.assign({},Qe),tu),purchase:Object.assign(Object.assign({},Qe),tu),quickview:Qe,quote:Object.assign(Object.assign({},Qe),Pm),review:Object.assign(Object.assign({},Qe),Em)},AE=lt(zh).map(e=>zh[e]),FE=lt(Wh).map(e=>Wh[e]),RE=lt(Qe).map(e=>Qe[e]),bE=lt(tu).map(e=>tu[e]),vE=lt(Em).map(e=>Em[e]),wE=lt(Pm).map(e=>Pm[e]),PE=[...AE,"custom"].join("|"),EE=[...FE,"custom"].join("|"),aS="(pr[0-9]+)",oS="(il[0-9]+pi[0-9]+)",IE=new RegExp(`^${aS}(${PE})$`),kE=new RegExp(`^(${oS}(${EE}))|(il[0-9]+nm)$`),TE=new RegExp(`^(${RE.join("|")})$`),OE=new RegExp(`^(${bE.join("|")})$`),qE=new RegExp(`^${aS}custom$`),DE=new RegExp(`^${oS}custom$`),jE=new RegExp(`^(${[...CE,...vE,...wE].join("|")})$`),VE=e=>IE.test(e),NE=e=>kE.test(e),ME=e=>TE.test(e),QE=e=>OE.test(e),LE=e=>jE.test(e),UE=[NE,VE,ME,QE,LE],BE=[qE,DE],_E={anonymizeIp:"aip"},$E={eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"},GE={hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"},HE=["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"],zE=Object.assign(Object.assign(Object.assign(Object.assign({},_E),$E),GE),HE.reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:t}),{})),Im=Object.assign(Object.assign({},zE),gE),WE=e=>{let t=!!e.action&&xE[e.action]||{};return lt(e).reduce((r,n)=>{let a=t[n]||Im[n]||n;return Object.assign(Object.assign({},r),{[a]:e[n]})},{})},YE=lt(Im).map(e=>Im[e]),KE=e=>YE.indexOf(e)!==-1,JE=e=>e==="custom",XE=e=>[...UE,...SE,KE,JE].some(t=>t(e)),ZE=e=>lt(e).reduce((t,r)=>{let n=eI(r);return n?Object.assign(Object.assign({},t),tI(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})},{}),eI=e=>{let t;return[...BE].every(r=>{var n;return t=(n=r.exec(e))===null||n===void 0?void 0:n[1],!t}),t},tI=(e,t)=>lt(t).reduce((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]}),{}),km=class{constructor(t){this.opts=t}sendEvent(t,r){return P(this,void 0,void 0,function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:n,preprocessRequest:a}=this.opts,o=yield this.getQueryParamsForEventType(t),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${n}/analytics/${t}?${o}`,r,a),c=this.encodeForEventType(t,s),u=new Blob([c],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,u)})}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(t,r,n){return P(this,void 0,void 0,function*(){let a=t,o=r;if(n){let i=yield n({url:t,body:JSON.stringify(r)},"analyticsBeacon"),{url:s,body:c}=i;a=s||t;try{o=JSON.parse(c)}catch(u){console.error("Unable to process the request body as a JSON string",u)}}return{payload:o,url:a}})}encodeForEventType(t,r){return this.isEventTypeLegacy(t)?this.encodeEventToJson(t,r):this.encodeEventToJson(t,r,this.opts.token)}getQueryParamsForEventType(t){return P(this,void 0,void 0,function*(){let{token:r,visitorIdProvider:n}=this.opts,a=yield n.getCurrentVisitorId();return[r&&this.isEventTypeLegacy(t)?`access_token=${r}`:"",a?`visitorId=${a}`:"","discardVisitInfo=true"].filter(o=>!!o).join("&")})}isEventTypeLegacy(t){return[ne.click,ne.custom,ne.search,ne.view].indexOf(t)!==-1}encodeEventToJson(t,r,n){let a=`${t}Event=${encodeURIComponent(JSON.stringify(r))}`;return n&&(a=`access_token=${encodeURIComponent(n)}&${a}`),a}},Tm=class{sendEvent(t,r){return P(this,void 0,void 0,function*(){return Promise.resolve()})}deleteHttpCookieVisitorId(){return P(this,void 0,void 0,function*(){return Promise.resolve()})}},Yh=globalThis.fetch,ru=class{constructor(t){this.opts=t}sendEvent(t,r){return P(this,void 0,void 0,function*(){let{baseUrl:n,visitorIdProvider:a,preprocessRequest:o}=this.opts,i=this.shouldAppendVisitorId(t)?yield this.getVisitorIdParam():"",s={url:`${n}/analytics/${t}${i}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(r)},c=Object.assign(Object.assign({},s),o?yield o(s,"analyticsFetch"):{}),{url:u}=c,l=vr(c,["url"]),p;try{p=yield Yh(u,l)}catch(m){console.error("An error has occured when sending the event.",m);return}if(p.ok){let m=yield p.json();return m.visitorId&&a.setCurrentVisitorId(m.visitorId),m}else{try{p.json()}catch{}throw console.error(`An error has occured when sending the "${t}" event.`,p,r),new Error(`An error has occurred when sending the "${t}" event. Check the console logs for more details.`)}})}deleteHttpCookieVisitorId(){return P(this,void 0,void 0,function*(){let{baseUrl:t}=this.opts,r=`${t}/analytics/visit`;yield Yh(r,{headers:this.getHeaders(),method:"DELETE"})})}shouldAppendVisitorId(t){return[ne.click,ne.custom,ne.search,ne.view].indexOf(t)!==-1}getVisitorIdParam(){return P(this,void 0,void 0,function*(){let{visitorIdProvider:t}=this.opts,r=yield t.getCurrentVisitorId();return r?`?visitor=${r}`:""})}getHeaders(){let{token:t}=this.opts;return Object.assign(Object.assign({},t?{Authorization:`Bearer ${t}`}:{}),{"Content-Type":"application/json"})}},Om=class{constructor(t,r){Fm()&&eS()?this.storage=new Rm:Fm()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Ha),this.client=new ru(t),this.beaconClient=new km(t),window.addEventListener("beforeunload",()=>{let n=r();for(let{eventType:a,payload:o}of n)this.beaconClient.sendEvent(a,o)})}getClientDependingOnEventType(t){return t==="click"&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},qm=class{constructor(t,r){this.storage=r||new Ha,this.client=new ru(t)}getClientDependingOnEventType(t){return this.client}},nu=class{constructor(){this.storage=new Ha,this.client=new Tm}getClientDependingOnEventType(t){return this.client}},rI="xx",nI=e=>e?.startsWith(rI)||!1,aI=`
        We've detected you're using React Native but have not provided the corresponding runtime, 
        for an optimal experience please use the "coveo.analytics/react-native" subpackage.
        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native
    `;function oI(){return typeof navigator<"u"&&navigator.product=="ReactNative"}var iI=["1",1,"yes",!0];function au(){let e=[];return Am()&&e.push(window.doNotTrack),Dm()&&e.push(navigator.doNotTrack,navigator.msDoNotTrack,navigator.globalPrivacyControl),e.some(t=>iI.indexOf(t)!==-1)}var iS="v15",sS={default:"https://analytics.cloud.coveo.com/rest/ua",production:"https://analytics.cloud.coveo.com/rest/ua",hipaa:"https://analyticshipaa.cloud.coveo.com/rest/ua"};function sI(e=sS.default,t=iS,r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}var cI="38824e1f-37f5-42d3-8372-a4b8fa9df946",Mt=class{get defaultOptions(){return{endpoint:sS.default,isCustomEndpoint:!1,token:"",version:iS,beforeSendHooks:[],afterSendHooks:[]}}get version(){return rS}constructor(t){if(this.acceptedLinkReferrers=[],!t)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),t),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[KP,GP].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let r={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};au()?this.runtime=new nu:this.runtime=this.options.runtimeEnvironment||this.initRuntime(r),this.addEventTypeMapping(ne.view,{newEventType:ne.view,addClientIdParameter:!0}),this.addEventTypeMapping(ne.click,{newEventType:ne.click,addClientIdParameter:!0}),this.addEventTypeMapping(ne.custom,{newEventType:ne.custom,addClientIdParameter:!0}),this.addEventTypeMapping(ne.search,{newEventType:ne.search,addClientIdParameter:!0})}initRuntime(t){return Am()&&$a()?new Om(t,()=>{let r=[...this.bufferedRequests];return this.bufferedRequests=[],r}):(oI()&&console.warn(aI),new qm(t))}get storage(){return this.runtime.storage}determineVisitorId(){return P(this,void 0,void 0,function*(){try{return Am()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Zn()}catch(t){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",t),Zn()}})}getCurrentVisitorId(){return P(this,void 0,void 0,function*(){if(!this.visitorId){let t=yield this.determineVisitorId();yield this.setCurrentVisitorId(t)}return this.visitorId})}setCurrentVisitorId(t){return P(this,void 0,void 0,function*(){this.visitorId=t,yield this.storage.setItem("visitorId",t)})}setClientId(t,r){return P(this,void 0,void 0,function*(){if(Zc(t))this.setCurrentVisitorId(t.toLowerCase());else{if(!r)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(_h(t,_h(r,cI)))}})}getParameters(t,...r){return P(this,void 0,void 0,function*(){return yield this.resolveParameters(t,...r)})}getPayload(t,...r){return P(this,void 0,void 0,function*(){let n=yield this.resolveParameters(t,...r);return yield this.resolvePayloadForParameters(t,n)})}get currentVisitorId(){return typeof(this.visitorId||this.storage.getItem("visitorId"))!="string"&&this.setCurrentVisitorId(Zn()),this.visitorId}set currentVisitorId(t){this.visitorId=t,this.storage.setItem("visitorId",t)}extractClientIdFromLink(t){if(au())return null;try{let r=new URL(t).searchParams.get(zr.cvo_cid);if(r==null)return null;let n=zr.fromString(r);return!n||!$a()||!n.validate(document.referrer,this.acceptedLinkReferrers)?null:n.clientId}catch{}return null}resolveParameters(t,...r){return P(this,void 0,void 0,function*(){let{variableLengthArgumentsNames:n=[],addVisitorIdParameter:a=!1,usesMeasurementProtocol:o=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[t]||{};return yield[d=>n.length>0?this.parseVariableArgumentsPayload(n,d):d[0],d=>P(this,void 0,void 0,function*(){return Object.assign(Object.assign({},d),{visitorId:a?yield this.getCurrentVisitorId():""})}),d=>P(this,void 0,void 0,function*(){return i?Object.assign(Object.assign({},d),{clientId:yield this.getCurrentVisitorId()}):d}),d=>o?this.ensureAnonymousUserWhenUsingApiKey(d):d,d=>this.beforeSendHooks.reduce((f,C)=>P(this,void 0,void 0,function*(){let g=yield f;return yield C(t,g)}),d)].reduce((d,f)=>P(this,void 0,void 0,function*(){let C=yield d;return yield f(C)}),Promise.resolve(r))})}resolvePayloadForParameters(t,r){return P(this,void 0,void 0,function*(){let{usesMeasurementProtocol:n=!1}=this.eventTypeMapping[t]||{};return yield[p=>this.setTrackingIdIfTrackingIdNotPresent(p),p=>this.removeEmptyPayloadValues(p,t),p=>this.validateParams(p,t),p=>n?WE(p):p,p=>n?this.removeUnknownParameters(p):p,p=>n?this.processCustomParameters(p):this.mapCustomParametersToCustomData(p)].reduce((p,m)=>P(this,void 0,void 0,function*(){let d=yield p;return yield m(d)}),Promise.resolve(r))})}makeEvent(t,...r){return P(this,void 0,void 0,function*(){let{newEventType:n=t}=this.eventTypeMapping[t]||{},a=yield this.resolveParameters(t,...r),o=yield this.resolvePayloadForParameters(t,a);return{eventType:n,payload:o,log:i=>P(this,void 0,void 0,function*(){return this.bufferedRequests.push({eventType:n,payload:Object.assign(Object.assign({},o),i)}),yield Promise.all(this.afterSendHooks.map(s=>s(t,Object.assign(Object.assign({},a),i)))),yield this.deferExecution(),yield this.sendFromBuffer()})}})}sendEvent(t,...r){return P(this,void 0,void 0,function*(){return(yield this.makeEvent(t,...r)).log({})})}deferExecution(){return new Promise(t=>setTimeout(t,0))}sendFromBuffer(){return P(this,void 0,void 0,function*(){let t=this.bufferedRequests.shift();if(t){let{eventType:r,payload:n}=t;return this.runtime.getClientDependingOnEventType(r).sendEvent(r,n)}})}clear(){this.storage.removeItem("visitorId"),new Xc().clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(t){return P(this,void 0,void 0,function*(){return this.makeEvent(ne.search,t)})}sendSearchEvent(t){var{searchQueryUid:r}=t,n=vr(t,["searchQueryUid"]);return P(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(n)).log({searchQueryUid:r})})}makeClickEvent(t){return P(this,void 0,void 0,function*(){return this.makeEvent(ne.click,t)})}sendClickEvent(t){var{searchQueryUid:r}=t,n=vr(t,["searchQueryUid"]);return P(this,void 0,void 0,function*(){return(yield this.makeClickEvent(n)).log({searchQueryUid:r})})}makeCustomEvent(t){return P(this,void 0,void 0,function*(){return this.makeEvent(ne.custom,t)})}sendCustomEvent(t){var{lastSearchQueryUid:r}=t,n=vr(t,["lastSearchQueryUid"]);return P(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(n)).log({lastSearchQueryUid:r})})}makeViewEvent(t){return P(this,void 0,void 0,function*(){return this.makeEvent(ne.view,t)})}sendViewEvent(t){return P(this,void 0,void 0,function*(){return(yield this.makeViewEvent(t)).log({})})}getVisit(){return P(this,void 0,void 0,function*(){let r=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=r.visitorId,r})}getHealth(){return P(this,void 0,void 0,function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()})}registerBeforeSendEventHook(t){this.beforeSendHooks.push(t)}registerAfterSendEventHook(t){this.afterSendHooks.push(t)}addEventTypeMapping(t,r){this.eventTypeMapping[t]=r}setAcceptedLinkReferrers(t){if(Array.isArray(t)&&t.every(r=>typeof r=="string"))this.acceptedLinkReferrers=t;else throw Error("Parameter should be an array of domain strings")}parseVariableArgumentsPayload(t,r){let n={};for(let a=0,o=r.length;a<o;a++){let i=r[a];if(typeof i=="string")n[t[a]]=i;else if(typeof i=="object")return Object.assign(Object.assign({},n),i)}return n}isKeyAllowedEmpty(t,r){return({[ne.search]:["queryText"]}[t]||[]).indexOf(r)!==-1}removeEmptyPayloadValues(t,r){let n=a=>typeof a<"u"&&a!==null&&a!=="";return Object.keys(t).filter(a=>this.isKeyAllowedEmpty(r,a)||n(t[a])).reduce((a,o)=>Object.assign(Object.assign({},a),{[o]:t[o]}),{})}removeUnknownParameters(t){return Object.keys(t).filter(n=>{if(XE(n))return!0;console.log(n,"is not processed by coveoua")}).reduce((n,a)=>Object.assign(Object.assign({},n),{[a]:t[a]}),{})}processCustomParameters(t){let{custom:r}=t,n=vr(t,["custom"]),a={};r&&Jc(r)&&(a=this.lowercaseKeys(r));let o=ZE(n);return Object.assign(Object.assign({},a),o)}mapCustomParametersToCustomData(t){let{custom:r}=t,n=vr(t,["custom"]);if(r&&Jc(r)){let a=this.lowercaseKeys(r);return Object.assign(Object.assign({},n),{customData:Object.assign(Object.assign({},a),t.customData)})}else return t}lowercaseKeys(t){let r=Object.keys(t),n={};return r.forEach(a=>{n[a.toLowerCase()]=t[a]}),n}validateParams(t,r){let{anonymizeIp:n}=t,a=vr(t,["anonymizeIp"]);return n!==void 0&&["0","false","undefined","null","{}","[]",""].indexOf(`${n}`.toLowerCase())==-1&&(a.anonymizeIp=1),(r==ne.view||r==ne.click||r==ne.search||r==ne.custom)&&(a.originLevel3=this.limit(a.originLevel3,1024)),r==ne.view&&(a.location=this.limit(a.location,1024)),(r=="pageview"||r=="event")&&(a.referrer=this.limit(a.referrer,2048),a.location=this.limit(a.location,2048),a.page=this.limit(a.page,2048)),a}ensureAnonymousUserWhenUsingApiKey(t){let{userId:r}=t,n=vr(t,["userId"]);return nI(this.options.token)&&!r?(n.userId="anonymous",n):t}setTrackingIdIfTrackingIdNotPresent(t){let{trackingId:r}=t,n=vr(t,["trackingId"]);return r?t:(n.hasOwnProperty("custom")&&Jc(n.custom)&&(n.custom.hasOwnProperty("context_website")||n.custom.hasOwnProperty("siteName"))&&(n.trackingId=n.custom.context_website||n.custom.siteName),n.hasOwnProperty("customData")&&Jc(n.customData)&&(n.customData.hasOwnProperty("context_website")||n.customData.hasOwnProperty("siteName"))&&(n.trackingId=n.customData.context_website||n.customData.siteName),n)}limit(t,r){return typeof t=="string"?dE(t,r):t}get baseUrl(){return sI(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}},wr;(function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"})(wr||(wr={}));var I;(function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer",e.generatedAnswerFeedbackSubmitV2="generatedAnswerFeedbackSubmitV2",e.generatedAnswerCitationClick="generatedAnswerCitationClick"})(I||(I={}));var Kh={[I.triggerNotify]:"queryPipelineTriggers",[I.triggerExecute]:"queryPipelineTriggers",[I.triggerQuery]:"queryPipelineTriggers",[I.triggerRedirect]:"queryPipelineTriggers",[I.queryError]:"errors",[I.queryErrorBack]:"errors",[I.queryErrorClear]:"errors",[I.queryErrorRetry]:"errors",[I.pagerNext]:"getMoreResults",[I.pagerPrevious]:"getMoreResults",[I.pagerNumber]:"getMoreResults",[I.pagerResize]:"getMoreResults",[I.pagerScrolling]:"getMoreResults",[I.facetSearch]:"facet",[I.facetShowLess]:"facet",[I.facetShowMore]:"facet",[I.recommendation]:"recommendation",[I.likeSmartSnippet]:"smartSnippet",[I.dislikeSmartSnippet]:"smartSnippet",[I.expandSmartSnippet]:"smartSnippet",[I.collapseSmartSnippet]:"smartSnippet",[I.openSmartSnippetFeedbackModal]:"smartSnippet",[I.closeSmartSnippetFeedbackModal]:"smartSnippet",[I.sendSmartSnippetReason]:"smartSnippet",[I.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[I.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[I.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[I.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[I.clearRecentQueries]:"recentQueries",[I.recentResultClick]:"recentlyClickedDocuments",[I.clearRecentResults]:"recentlyClickedDocuments",[I.showLessFoldedResults]:"folding",[I.caseDetach]:"case",[I.likeGeneratedAnswer]:"generatedAnswer",[I.dislikeGeneratedAnswer]:"generatedAnswer",[I.openGeneratedAnswerSource]:"generatedAnswer",[I.generatedAnswerStreamEnd]:"generatedAnswer",[I.generatedAnswerSourceHover]:"generatedAnswer",[I.generatedAnswerCopyToClipboard]:"generatedAnswer",[I.generatedAnswerHideAnswers]:"generatedAnswer",[I.generatedAnswerShowAnswers]:"generatedAnswer",[I.generatedAnswerExpand]:"generatedAnswer",[I.generatedAnswerCollapse]:"generatedAnswer",[I.generatedAnswerFeedbackSubmit]:"generatedAnswer",[I.generatedAnswerFeedbackSubmitV2]:"generatedAnswer",[wr.expandToFullUI]:"interface",[wr.openUserActions]:"User Actions",[wr.showPrecedingSessions]:"User Actions",[wr.showFollowingSessions]:"User Actions",[wr.clickViewedDocument]:"User Actions",[wr.clickPageView]:"User Actions",[wr.createArticle]:"createArticle"},za=class{constructor(){this.runtime=new nu,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(t){return Promise.resolve({eventType:t,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ne.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ne.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ne.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ne.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return rS}};function uI(e){let t="";return e.filter(r=>{let n=r!==t;return t=r,n})}function lI(e){return e.map(t=>t.replace(/;/g,""))}function cS(e){let r=e.join(";");return r.length<=256?r:cS(e.slice(1))}var Jh=e=>{let t=lI(e),r=uI(t);return cS(r)};function Xh(e){let t=typeof e.partialQueries=="string"?e.partialQueries:Jh(e.partialQueries),r=typeof e.suggestions=="string"?e.suggestions:Jh(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var ou=class{constructor(t,r){this.opts=t,this.provider=r;let n=t.enableAnalytics===!1||au();this.coveoAnalyticsClient=n?new za:new Mt(t)}disable(){this.coveoAnalyticsClient=new za}enable(){this.coveoAnalyticsClient=new Mt(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(I.interfaceLoad)}logInterfaceLoad(){return P(this,void 0,void 0,function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(I.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return P(this,void 0,void 0,function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendation(){return this.makeCustomEvent(I.recommendation)}logRecommendation(){return P(this,void 0,void 0,function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})})}makeRecommendationOpen(t,r){return this.makeClickEvent(I.recommendationOpen,t,r)}logRecommendationOpen(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeRecommendationOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterClearAll(t){return this.makeSearchEvent(I.staticFilterClearAll,t)}logStaticFilterClearAll(t){return P(this,void 0,void 0,function*(){return(yield this.makeStaticFilterClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterSelect(t){return this.makeSearchEvent(I.staticFilterSelect,t)}logStaticFilterSelect(t){return P(this,void 0,void 0,function*(){return(yield this.makeStaticFilterSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeStaticFilterDeselect(t){return this.makeSearchEvent(I.staticFilterDeselect,t)}logStaticFilterDeselect(t){return P(this,void 0,void 0,function*(){return(yield this.makeStaticFilterDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFetchMoreResults(){return this.makeCustomEvent(I.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return P(this,void 0,void 0,function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})})}makeInterfaceChange(t){return this.makeSearchEvent(I.interfaceChange,t)}logInterfaceChange(t){return P(this,void 0,void 0,function*(){return(yield this.makeInterfaceChange(t)).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanAutomatic(){return this.makeSearchEvent(I.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return P(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})})}makeDidYouMeanClick(){return this.makeSearchEvent(I.didyoumeanClick)}logDidYouMeanClick(){return P(this,void 0,void 0,function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})})}makeResultsSort(t){return this.makeSearchEvent(I.resultsSort,t)}logResultsSort(t){return P(this,void 0,void 0,function*(){return(yield this.makeResultsSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxSubmit(){return this.makeSearchEvent(I.searchboxSubmit)}logSearchboxSubmit(){return P(this,void 0,void 0,function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxClear(){return this.makeSearchEvent(I.searchboxClear)}logSearchboxClear(){return P(this,void 0,void 0,function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})})}makeSearchboxAsYouType(){return this.makeSearchEvent(I.searchboxAsYouType)}logSearchboxAsYouType(){return P(this,void 0,void 0,function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbFacet(t){return this.makeSearchEvent(I.breadcrumbFacet,t)}logBreadcrumbFacet(t){return P(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbFacet(t)).log({searchUID:this.provider.getSearchUID()})})}makeBreadcrumbResetAll(){return this.makeSearchEvent(I.breadcrumbResetAll)}logBreadcrumbResetAll(){return P(this,void 0,void 0,function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})})}makeDocumentQuickview(t,r){return this.makeClickEvent(I.documentQuickview,t,r)}logDocumentQuickview(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeDocumentQuickview(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeDocumentOpen(t,r){return this.makeClickEvent(I.documentOpen,t,r)}logDocumentOpen(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeDocumentOpen(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxAnalytics(t){return this.makeSearchEvent(I.omniboxAnalytics,Xh(t))}logOmniboxAnalytics(t){return P(this,void 0,void 0,function*(){return(yield this.makeOmniboxAnalytics(t)).log({searchUID:this.provider.getSearchUID()})})}makeOmniboxFromLink(t){return this.makeSearchEvent(I.omniboxFromLink,Xh(t))}logOmniboxFromLink(t){return P(this,void 0,void 0,function*(){return(yield this.makeOmniboxFromLink(t)).log({searchUID:this.provider.getSearchUID()})})}makeSearchFromLink(){return this.makeSearchEvent(I.searchFromLink)}logSearchFromLink(){return P(this,void 0,void 0,function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})})}makeTriggerNotify(t){return this.makeCustomEvent(I.triggerNotify,t)}logTriggerNotify(t){return P(this,void 0,void 0,function*(){return(yield this.makeTriggerNotify(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerExecute(t){return this.makeCustomEvent(I.triggerExecute,t)}logTriggerExecute(t){return P(this,void 0,void 0,function*(){return(yield this.makeTriggerExecute(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerQuery(){return this.makeCustomEvent(I.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return P(this,void 0,void 0,function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})})}makeUndoTriggerQuery(t){return this.makeSearchEvent(I.undoTriggerQuery,t)}logUndoTriggerQuery(t){return P(this,void 0,void 0,function*(){return(yield this.makeUndoTriggerQuery(t)).log({searchUID:this.provider.getSearchUID()})})}makeTriggerRedirect(t){return this.makeCustomEvent(I.triggerRedirect,Object.assign(Object.assign({},t),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(t){return P(this,void 0,void 0,function*(){return(yield this.makeTriggerRedirect(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerResize(t){return this.makeCustomEvent(I.pagerResize,t)}logPagerResize(t){return P(this,void 0,void 0,function*(){return(yield this.makePagerResize(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNumber(t){return this.makeCustomEvent(I.pagerNumber,t)}logPagerNumber(t){return P(this,void 0,void 0,function*(){return(yield this.makePagerNumber(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerNext(t){return this.makeCustomEvent(I.pagerNext,t)}logPagerNext(t){return P(this,void 0,void 0,function*(){return(yield this.makePagerNext(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerPrevious(t){return this.makeCustomEvent(I.pagerPrevious,t)}logPagerPrevious(t){return P(this,void 0,void 0,function*(){return(yield this.makePagerPrevious(t)).log({searchUID:this.provider.getSearchUID()})})}makePagerScrolling(){return this.makeCustomEvent(I.pagerScrolling)}logPagerScrolling(){return P(this,void 0,void 0,function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})})}makeFacetClearAll(t){return this.makeSearchEvent(I.facetClearAll,t)}logFacetClearAll(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetClearAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSearch(t){return this.makeSearchEvent(I.facetSearch,t)}logFacetSearch(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetSearch(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelect(t){return this.makeSearchEvent(I.facetSelect,t)}logFacetSelect(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetSelect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetDeselect(t){return this.makeSearchEvent(I.facetDeselect,t)}logFacetDeselect(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetDeselect(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetExclude(t){return this.makeSearchEvent(I.facetExclude,t)}logFacetExclude(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetExclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUnexclude(t){return this.makeSearchEvent(I.facetUnexclude,t)}logFacetUnexclude(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetUnexclude(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetSelectAll(t){return this.makeSearchEvent(I.facetSelectAll,t)}logFacetSelectAll(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetSelectAll(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetUpdateSort(t){return this.makeSearchEvent(I.facetUpdateSort,t)}logFacetUpdateSort(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetUpdateSort(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowMore(t){return this.makeCustomEvent(I.facetShowMore,t)}logFacetShowMore(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetShowMore(t)).log({searchUID:this.provider.getSearchUID()})})}makeFacetShowLess(t){return this.makeCustomEvent(I.facetShowLess,t)}logFacetShowLess(t){return P(this,void 0,void 0,function*(){return(yield this.makeFacetShowLess(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryError(t){return this.makeCustomEvent(I.queryError,t)}logQueryError(t){return P(this,void 0,void 0,function*(){return(yield this.makeQueryError(t)).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorBack(){return P(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(I.queryErrorBack);return{description:t.description,log:()=>P(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(I.queryErrorBack)})}})}logQueryErrorBack(){return P(this,void 0,void 0,function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorRetry(){return P(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(I.queryErrorRetry);return{description:t.description,log:()=>P(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(I.queryErrorRetry)})}})}logQueryErrorRetry(){return P(this,void 0,void 0,function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})})}makeQueryErrorClear(){return P(this,void 0,void 0,function*(){let t=yield this.makeCustomEvent(I.queryErrorClear);return{description:t.description,log:()=>P(this,void 0,void 0,function*(){return yield t.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(I.queryErrorClear)})}})}logQueryErrorClear(){return P(this,void 0,void 0,function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})})}makeLikeSmartSnippet(){return this.makeCustomEvent(I.likeSmartSnippet)}logLikeSmartSnippet(){return P(this,void 0,void 0,function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeDislikeSmartSnippet(){return this.makeCustomEvent(I.dislikeSmartSnippet)}logDislikeSmartSnippet(){return P(this,void 0,void 0,function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippet(){return this.makeCustomEvent(I.expandSmartSnippet)}logExpandSmartSnippet(){return P(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippet(){return this.makeCustomEvent(I.collapseSmartSnippet)}logCollapseSmartSnippet(){return P(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(I.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return P(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(I.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return P(this,void 0,void 0,function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})})}makeSmartSnippetFeedbackReason(t,r){return this.makeCustomEvent(I.sendSmartSnippetReason,{reason:t,details:r})}logSmartSnippetFeedbackReason(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeSmartSnippetFeedbackReason(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeExpandSmartSnippetSuggestion(t){return this.makeCustomEvent(I.expandSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logExpandSmartSnippetSuggestion(t){return P(this,void 0,void 0,function*(){return(yield this.makeExpandSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeCollapseSmartSnippetSuggestion(t){return this.makeCustomEvent(I.collapseSmartSnippetSuggestion,"documentId"in t?t:{documentId:t})}logCollapseSmartSnippetSuggestion(t){return P(this,void 0,void 0,function*(){return(yield this.makeCollapseSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreSmartSnippetSuggestion(t){return this.makeCustomEvent(I.showMoreSmartSnippetSuggestion,t)}logShowMoreSmartSnippetSuggestion(t){return P(this,void 0,void 0,function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessSmartSnippetSuggestion(t){return this.makeCustomEvent(I.showLessSmartSnippetSuggestion,t)}logShowLessSmartSnippetSuggestion(t){return P(this,void 0,void 0,function*(){return(yield this.makeShowLessSmartSnippetSuggestion(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSource(t,r){return this.makeClickEvent(I.openSmartSnippetSource,t,r)}logOpenSmartSnippetSource(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionSource(t,r){return this.makeClickEvent(I.openSmartSnippetSuggestionSource,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}makeCopyToClipboard(t,r){return this.makeClickEvent(I.copyToClipboard,t,r)}logCopyToClipboard(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeCopyToClipboard(t,r)).log({searchUID:this.provider.getSearchUID()})})}logOpenSmartSnippetSuggestionSource(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetInlineLink(t,r){return this.makeClickEvent(I.openSmartSnippetInlineLink,t,{contentIDKey:r.contentIDKey,contentIDValue:r.contentIDValue},r)}logOpenSmartSnippetInlineLink(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeOpenSmartSnippetSuggestionInlineLink(t,r){return this.makeClickEvent(I.openSmartSnippetSuggestionInlineLink,t,{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logOpenSmartSnippetSuggestionInlineLink(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeRecentQueryClick(){return this.makeSearchEvent(I.recentQueryClick)}logRecentQueryClick(){return P(this,void 0,void 0,function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentQueries(){return this.makeCustomEvent(I.clearRecentQueries)}logClearRecentQueries(){return P(this,void 0,void 0,function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})})}makeRecentResultClick(t,r){return this.makeCustomEvent(I.recentResultClick,{info:t,identifier:r})}logRecentResultClick(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeRecentResultClick(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeClearRecentResults(){return this.makeCustomEvent(I.clearRecentResults)}logClearRecentResults(){return P(this,void 0,void 0,function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})})}makeNoResultsBack(){return this.makeSearchEvent(I.noResultsBack)}logNoResultsBack(){return P(this,void 0,void 0,function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})})}makeShowMoreFoldedResults(t,r){return this.makeClickEvent(I.showMoreFoldedResults,t,r)}logShowMoreFoldedResults(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeShowMoreFoldedResults(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeShowLessFoldedResults(){return this.makeCustomEvent(I.showLessFoldedResults)}logShowLessFoldedResults(){return P(this,void 0,void 0,function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})})}makeEventDescription(t,r){var n;return{actionCause:r,customData:(n=t.payload)===null||n===void 0?void 0:n.customData}}makeCustomEvent(t,r,n=Kh[t]){return P(this,void 0,void 0,function*(){this.coveoAnalyticsClient.getParameters;let a=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),o=Object.assign(Object.assign({},yield this.getBaseEventRequest(a)),{eventType:n,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(o);return{description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEvent(t,r,n=Kh[t]){return P(this,void 0,void 0,function*(){return(yield this.makeCustomEvent(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}makeCustomEventWithType(t,r,n){return P(this,void 0,void 0,function*(){let a=Object.assign(Object.assign({},this.provider.getBaseMetadata()),n),o=Object.assign(Object.assign({},yield this.getBaseEventRequest(a)),{eventType:r,eventValue:t}),i=yield this.coveoAnalyticsClient.makeCustomEvent(o);return{description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({lastSearchQueryUid:s})}})}logCustomEventWithType(t,r,n){return P(this,void 0,void 0,function*(){return(yield this.makeCustomEventWithType(t,r,n)).log({searchUID:this.provider.getSearchUID()})})}logSearchEvent(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeSearchEvent(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeSearchEvent(t,r){return P(this,void 0,void 0,function*(){let n=yield this.getBaseSearchEventRequest(t,r),a=yield this.coveoAnalyticsClient.makeSearchEvent(n);return{description:this.makeEventDescription(a,t),log:({searchUID:o})=>a.log({searchQueryUid:o})}})}makeClickEvent(t,r,n,a){return P(this,void 0,void 0,function*(){let o=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),a))),{queryPipeline:this.provider.getPipeline(),actionCause:t}),i=yield this.coveoAnalyticsClient.makeClickEvent(o);return{description:this.makeEventDescription(i,t),log:({searchUID:s})=>i.log({searchQueryUid:s})}})}logClickEvent(t,r,n,a){return P(this,void 0,void 0,function*(){return(yield this.makeClickEvent(t,r,n,a)).log({searchUID:this.provider.getSearchUID()})})}getBaseSearchEventRequest(t,r){var n,a;return P(this,void 0,void 0,function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},r),(a=(n=this.provider).getGeneratedAnswerMetadata)===null||a===void 0?void 0:a.call(n)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:t})})}getBaseEventRequest(t){return P(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:r,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})})}getOrigins(){var t,r;return{originContext:(r=(t=this.provider).getOriginContext)===null||r===void 0?void 0:r.call(t),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Mt?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let t=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",r=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},t&&{splitTestRunName:t}),r&&{splitTestRunVersion:r})}makeLikeGeneratedAnswer(t){return this.makeCustomEvent(I.likeGeneratedAnswer,t)}logLikeGeneratedAnswer(t){return P(this,void 0,void 0,function*(){return(yield this.makeLikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeDislikeGeneratedAnswer(t){return this.makeCustomEvent(I.dislikeGeneratedAnswer,t)}logDislikeGeneratedAnswer(t){return P(this,void 0,void 0,function*(){return(yield this.makeDislikeGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeOpenGeneratedAnswerSource(t){return this.makeCustomEvent(I.openGeneratedAnswerSource,t)}logOpenGeneratedAnswerSource(t){return P(this,void 0,void 0,function*(){return(yield this.makeOpenGeneratedAnswerSource(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCitationClick(t,r){return this.makeClickEvent(I.generatedAnswerCitationClick,Object.assign(Object.assign({},t),{documentPosition:1}),{contentIDKey:r.documentId.contentIdKey,contentIDValue:r.documentId.contentIdValue},r)}logGeneratedAnswerCitationClick(t,r){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCitationClick(t,r)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerSourceHover(t){return this.makeCustomEvent(I.generatedAnswerSourceHover,t)}logGeneratedAnswerSourceHover(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerSourceHover(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCopyToClipboard(t){return this.makeCustomEvent(I.generatedAnswerCopyToClipboard,t)}logGeneratedAnswerCopyToClipboard(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerHideAnswers(t){return this.makeCustomEvent(I.generatedAnswerHideAnswers,t)}logGeneratedAnswerHideAnswers(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerHideAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerShowAnswers(t){return this.makeCustomEvent(I.generatedAnswerShowAnswers,t)}logGeneratedAnswerShowAnswers(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerShowAnswers(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerExpand(t){return this.makeCustomEvent(I.generatedAnswerExpand,t)}logGeneratedAnswerExpand(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerExpand(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerCollapse(t){return this.makeCustomEvent(I.generatedAnswerCollapse,t)}logGeneratedAnswerCollapse(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerCollapse(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmit(t){return this.makeCustomEvent(I.generatedAnswerFeedbackSubmit,t)}logGeneratedAnswerFeedbackSubmit(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(t)).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerFeedbackSubmitV2(t){return this.makeCustomEvent(I.generatedAnswerFeedbackSubmitV2,t)}logGeneratedAnswerFeedbackSubmitV2(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerFeedbackSubmitV2(t)).log({searchUID:this.provider.getSearchUID()})})}makeRephraseGeneratedAnswer(t){return this.makeSearchEvent(I.rephraseGeneratedAnswer,t)}logRephraseGeneratedAnswer(t){return P(this,void 0,void 0,function*(){return(yield this.makeRephraseGeneratedAnswer(t)).log({searchUID:this.provider.getSearchUID()})})}makeRetryGeneratedAnswer(){return this.makeSearchEvent(I.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return P(this,void 0,void 0,function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})})}makeGeneratedAnswerStreamEnd(t){return this.makeCustomEvent(I.generatedAnswerStreamEnd,t)}logGeneratedAnswerStreamEnd(t){return P(this,void 0,void 0,function*(){return(yield this.makeGeneratedAnswerStreamEnd(t)).log({searchUID:this.provider.getSearchUID()})})}},iu=Object.assign({},Ss),Zh=Object.keys(iu).map(e=>iu[e]),Ga=class extends bm{constructor({client:t,uuidGenerator:r=Zn}){super({client:t,uuidGenerator:r}),this.ticket={}}getApi(t){let r=super.getApi(t);if(r!==null)return r;switch(t){case"setTicket":return this.setTicket;default:return null}}addHooks(){this.addHooksForEvent(),this.addHooksForPageView(),this.addHooksForSVCEvents()}setTicket(t){this.ticket=t}clearPluginData(){this.ticket={}}addHooksForSVCEvents(){this.client.registerBeforeSendEventHook((t,...[r])=>Zh.indexOf(t)!==-1?this.addSVCDataToPayload(t,r):r),this.client.registerAfterSendEventHook((t,...[r])=>(Zh.indexOf(t)!==-1&&this.updateLocationInformation(t,r),r))}addHooksForPageView(){this.client.addEventTypeMapping(iu.pageview,{newEventType:ne.collect,variableLengthArgumentsNames:["page"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addHooksForEvent(){this.client.addEventTypeMapping(iu.event,{newEventType:ne.collect,variableLengthArgumentsNames:["eventCategory","eventAction","eventLabel","eventValue"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addSVCDataToPayload(t,r){var n;let a=Object.assign(Object.assign(Object.assign(Object.assign({},this.getLocationInformation(t,r)),this.getDefaultContextInformation(t)),this.action?{svcAction:this.action}:{}),Object.keys((n=this.actionData)!==null&&n!==void 0?n:{}).length>0?{svcActionData:this.actionData}:{}),o=this.getTicketPayload();return this.clearData(),Object.assign(Object.assign(Object.assign({},o),a),r)}getTicketPayload(){return yE(this.ticket)}};Ga.Id="svc";var su;(function(e){e.click="click",e.flowStart="flowStart"})(su||(su={}));var ut;(function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.documentSuggestionClick="documentSuggestionClick",e.documentSuggestionQuickview="documentSuggestionQuickview",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"})(ut||(ut={}));var cu;(function(e){e.quit="Quit",e.solved="Solved"})(cu||(cu={}));var uu=class{constructor(t,r){var n;this.options=t,this.provider=r;let a=((n=t.enableAnalytics)!==null&&n!==void 0?n:!0)&&!au();this.coveoAnalyticsClient=a?new Mt(t):new za,this.svc=new Ga({client:this.coveoAnalyticsClient})}disable(){this.coveoAnalyticsClient=new za,this.svc=new Ga({client:this.coveoAnalyticsClient})}enable(){this.coveoAnalyticsClient=new Mt(this.options),this.svc=new Ga({client:this.coveoAnalyticsClient})}logEnterInterface(t){return this.svc.setAction(ut.enterInterface),this.svc.setTicket(t.ticket),this.sendFlowStartEvent()}logUpdateCaseField(t){return this.svc.setAction(ut.fieldUpdate,{fieldName:t.fieldName}),this.svc.setTicket(t.ticket),this.sendClickEvent()}logSelectFieldSuggestion(t){return this.svc.setAction(ut.fieldSuggestionClick,t.suggestion),this.svc.setTicket(t.ticket),this.sendClickEvent()}logSelectDocumentSuggestion(t){return this.logClickEvent(ut.documentSuggestionClick,t.suggestion.suggestion,{contentIDKey:"permanentId",contentIDValue:t.suggestion.permanentId})}logQuickviewDocumentSuggestion(t){return this.logClickEvent(ut.documentSuggestionQuickview,t.suggestion.suggestion,{contentIDKey:"permanentId",contentIDValue:t.suggestion.permanentId})}logRateDocumentSuggestion(t){return this.svc.setAction(ut.suggestionRate,Object.assign({rate:t.rating},t.suggestion)),this.svc.setTicket(t.ticket),this.sendClickEvent()}logMoveToNextCaseStep(t){return this.svc.setAction(ut.nextCaseStep,{stage:t?.stage}),this.svc.setTicket(t.ticket),this.sendClickEvent()}logCaseCancelled(t){return this.svc.setAction(ut.caseCancelled,{reason:cu.quit}),this.svc.setTicket(t.ticket),this.sendClickEvent()}logCaseSolved(t){return this.svc.setAction(ut.caseSolved,{reason:cu.solved}),this.svc.setTicket(t.ticket),this.sendClickEvent()}logCaseCreated(t){return this.svc.setAction(ut.caseCreated),this.svc.setTicket(t.ticket),this.sendClickEvent()}sendFlowStartEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",su.flowStart,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}sendClickEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",su.click,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}getBaseEventRequest(t){var r,n;return P(this,void 0,void 0,function*(){let a=Object.assign({},t);return Object.assign(Object.assign({},this.getOrigins()),{customData:a,language:(r=this.provider)===null||r===void 0?void 0:r.getLanguage(),anonymous:(n=this.provider)===null||n===void 0?void 0:n.getIsAnonymous(),clientId:yield this.getClientId()})})}getClientId(){return this.coveoAnalyticsClient instanceof Mt?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getOrigins(){var t,r,n,a,o;return{originContext:(r=(t=this.provider)===null||t===void 0?void 0:t.getOriginContext)===null||r===void 0?void 0:r.call(t),originLevel1:(n=this.provider)===null||n===void 0?void 0:n.getOriginLevel1(),originLevel2:(a=this.provider)===null||a===void 0?void 0:a.getOriginLevel2(),originLevel3:(o=this.provider)===null||o===void 0?void 0:o.getOriginLevel3()}}logClickEvent(t,r,n,a){var o,i;return P(this,void 0,void 0,function*(){let s=Object.assign(Object.assign(Object.assign({},r),yield this.getBaseEventRequest(Object.assign(Object.assign({},n),a))),{searchQueryUid:(i=(o=this.provider)===null||o===void 0?void 0:o.getSearchUID())!==null&&i!==void 0?i:"",actionCause:t});return this.coveoAnalyticsClient.sendClickEvent(s)})}};var Wr=()=>"default";var dI=e=>{let t=e.configuration.search.locale.split("-")[0];return!t||t.length!==2?"en":t},ea=class{constructor(t){this.getState=t;le(this,"state");this.state=t()}getLanguage(){return dI(this.state)}getBaseMetadata(){let{context:t,configuration:r}=this.state,n=t?.contextValues||{},a={};for(let[o,i]of Object.entries(n)){let s=`context_${o}`;a[s]=i}return r.analytics.analyticsMode==="legacy"&&(a.coveoHeadlessVersion=Xn),a}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||Wr()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}};var uS=e=>new Mt(e).getCurrentVisitorId(),As=(e,t)=>typeof t=="function"?(...r)=>{let n=ts(r[0]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Fs=(e,t)=>(...r)=>{let n=ts(r[1]);try{return t.apply(t,r)}catch(a){return e.error(a,"Error in analytics hook. Returning original request."),n}};var Rs=class extends ea{getSearchUID(){return this.state.documentSuggestion?.status.lastResponseId??""}},lS=({logger:e,getState:t,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:n,provider:a=new Rs(t)})=>{let o=t(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl??Me(o.configuration.organizationId,o.configuration.environment,"analytics"),c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new uu({enableAnalytics:u,token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:As(e,n),beforeSendHooks:[Fs(e,r),(p,m)=>(e.info({...m,type:p,endpoint:s,token:i},"Analytics request"),m)]},a);return u||l.disable(),l};function Wa(){return{desiredCount:5,numberOfValues:8,set:{}}}function pI(e,t){return!!t&&t.facetId in e.facetSet}var Qt=(e,t)=>e.search?.response.facets.find(r=>r.facetId===t),Nm=(e,t)=>e.facetSet[t]?.request,bs=(e,t)=>{let r=Qt(e,t);return pI(e,r)?r:void 0},mI=(e,t)=>bs(e,t)?.values.filter(r=>r.state==="selected")||[],dS=(e,t)=>bs(e,t)?.values.filter(r=>r.state!=="idle")||[],Lt=e=>e.search.isLoading;function pS(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;let n=r.find(a=>a.state==="selected");return n&&(t=[...t,n],r=[]),{parents:t,values:r}}function Ke(e){let{activeValue:t,ancestryMap:r}=fI(e);return t?gI(t,r):[]}function fI(e){let t=[...e],r=new Map;for(;t.length>0;){let n=t.shift();if(n.state==="selected")return{activeValue:n,ancestryMap:r};if(r)for(let a of n.children)r.set(a,n);t.unshift(...n.children)}return{}}function gI(e,t){let r=[];if(!e)return[];let n=e;do r.unshift(n),n=t.get(n);while(n);return r}function yI(e,t){return!!t&&t.facetId in e.categoryFacetSet}var Mm=(e,t)=>{let r=Qt(e,t);if(yI(e,r))return r},Qm=(e,t)=>e.categoryFacetSet[t]?.request,mS=(e,t)=>{let r=Mm(e,t);return Ke(r?.values??[])},Lm=(e,t)=>{let r=Qm(e,t);return Ke(r?.currentValues??[])};function Ya(){return{}}function fS(e){return{request:e}}function Ka(){return{}}function gS(e){return{request:e}}function Ja(){return{}}function yS(e){return{request:e,hasBreadcrumbs:!0}}function Xa(){return{}}var Za=(e,t)=>{let r=xS(t,e),n=r?r.field:"",a=Bm(n,e);return{facetId:e,facetField:n,facetTitle:a}};function eo(e,t){let{facetId:r,facetValue:n}=e,a=Za(r,t),o=AS(t,r);return{...a,facetValue:o==="hierarchical"?CS(t,r):n}}function nt(e){return{facetSet:e.facetSet??Xa(),categoryFacetSet:e.categoryFacetSet??Ya(),dateFacetSet:e.dateFacetSet??Ka(),numericFacetSet:e.numericFacetSet??Ja(),automaticFacetSet:e.automaticFacetSet??Wa()}}var Um=e=>{let t=[];return CI(e).forEach((r,n)=>{let a=AS(e,r.facetId),o=bI(r,n+1);if(SI(r)){if(!!!Lm(e,r.facetId).length)return;t.push({...o,...FI(e,r.facetId),facetType:a,state:"selected"});return}r.currentValues.forEach((i,s)=>{if(i.state==="idle")return;let c=hS(i,s+1,a),u=hI(r)?SS(i):AI(i);t.push({...o,...c,...u})})}),xI(e).forEach((r,n)=>{let a=RI(r,n+1);r.values.forEach((o,i)=>{if(o.state==="idle")return;let s=hS(o,i+1,"specific"),c=SS(o);t.push({...a,...s,...c})})}),t},hI=e=>e.type==="specific",SI=e=>e.type==="hierarchical",CI=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map(t=>t.request),xI=e=>[...Object.values(e.automaticFacetSet.set)].map(t=>t.response),hS=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),AI=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),SS=e=>({displayValue:e.value,value:e.value}),CS=(e,t)=>Lm(e,t).map(n=>n.value).join(";"),FI=(e,t)=>{let n=CS(e,t);return{value:n,valuePosition:1,displayValue:n}},RI=(e,t)=>({title:Bm(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),bI=(e,t)=>({title:Bm(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Bm=(e,t)=>`${e}_${t}`,xS=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,AS=(e,t)=>{let r=xS(e,t);return r?r.type:"specific"};import{isNullOrUndefined as vI}from"../bueno/v1.1.0/bueno.esm.js";var de=e=>{if(wI(e)){let t=Object.values(e.answer.queries).pop()?.data;return typeof t=="object"&&t!==null&&"answerId"in t?t.answerId:void 0}if(PI(e))return e.search?.response?.extendedResults?.generativeQuestionAnsweringId},wI=e=>"answer"in e&&"generatedAnswer"in e&&!vI(e.generatedAnswer?.answerConfigurationId),PI=e=>"search"in e&&e.search!==void 0&&typeof e.search=="object",FS=e=>e.generatedAnswer?.fieldsToIncludeInCitations,vs=Y(e=>e.generatedAnswer?.citations,(e,t)=>t,(e,t)=>e?.find(r=>r.id===t));var Fe=()=>({q:"",enableQuerySyntax:!1});import{EnumValue as RS,isArray as EI,RecordValue as II,StringValue as kI}from"../bueno/v1.1.0/bueno.esm.js";var lu=(r=>(r.Ascending="ascending",r.Descending="descending",r))(lu||{}),to=(o=>(o.Relevancy="relevancy",o.QRE="qre",o.Date="date",o.Field="field",o.NoSort="nosort",o))(to||{}),Pr=e=>{if(EI(e))return e.map(t=>Pr(t)).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},ws=()=>({by:"relevancy"}),_m=e=>({by:"date",order:e}),$m=(e,t)=>({by:"field",order:t,field:e}),Gm=()=>({by:"qre"}),Hm=()=>({by:"nosort"}),bS=new II({values:{by:new RS({enum:to,required:!0}),order:new RS({enum:lu}),field:new kI}});function dt(){return Pr(ws())}var ro=class e{static set(t,r,n){let a,o,i;n&&(o=new Date,o.setTime(o.getTime()+n));let s=window.location.hostname,c=/^(\d{1,3}\.){3}\d{1,3}$/,u=/^([0-9a-fA-F]{0,4}:){2,7}[0-9a-fA-F]{0,4}$/;c.test(s)||u.test(s)||s.indexOf(".")===-1?zm(t,r,o):(i=s.split("."),a=i[i.length-2]+"."+i[i.length-1],zm(t,r,o,a))}static get(t){let r=t+"=",n=document.cookie.split(";");for(let a=0;a<n.length;a++){let o=n[a];if(o=o.replace(/^\s+/,""),o.lastIndexOf(r,0)===0)return o.substring(r.length,o.length)}return null}static erase(t){e.set(t,"",-1)}};function zm(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function TI(){return typeof navigator<"u"}function vS(){try{return typeof localStorage<"u"}catch{return!1}}function wS(){try{return typeof sessionStorage<"u"}catch{return!1}}function PS(){return!!(TI()&&navigator.cookieEnabled)}var ES=null;function IS(){return ES||(vS()?localStorage:PS()?new Wm:wS()?sessionStorage:new Ym)}var no=class no{getItem(t){return ro.get(`${no.prefix}${t}`)}removeItem(t){ro.erase(`${no.prefix}${t}`)}setItem(t,r,n){ro.set(`${no.prefix}${t}`,r,n)}};le(no,"prefix","coveo_");var Wm=no;var Ym=class{getItem(t){return null}removeItem(t){}setItem(t,r){}};var du="__coveo.analytics.history",OI=20,qI=1e3*60,DI=75,ta=class ta{constructor(t){le(this,"store");this.store=t||IS()}static getInstance(t){return ta.instance||(ta.instance=new ta(t)),ta.instance}addElement(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=this.getHistoryWithInternalTime();r!==null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t])}async addElementAsync(t){t.internalTime=new Date().getTime(),t=this.cropQueryElement(this.stripEmptyQuery(t));let r=await this.getHistoryWithInternalTimeAsync();r!==null?this.isValidEntry(t)&&this.setHistory([t].concat(r)):this.setHistory([t])}getHistory(){let t=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(t))}async getHistoryAsync(){let t=await this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(t))}getHistoryWithInternalTime(){try{let t=this.store.getItem(du);return t&&typeof t=="string"?JSON.parse(t):[]}catch{return[]}}async getHistoryWithInternalTimeAsync(){try{let t=await this.store.getItem(du);return t?JSON.parse(t):[]}catch{return[]}}setHistory(t){try{this.store.setItem(du,JSON.stringify(t.slice(0,OI)))}catch{}}clear(){try{this.store.removeItem(du)}catch{}}getMostRecentElement(){let t=this.getHistoryWithInternalTime();return Array.isArray(t)?t.sort((n,a)=>(a.internalTime||0)-(n.internalTime||0))[0]:null}cropQueryElement(t){return t.name&&t.value&&t.name.toLowerCase()==="query"&&(t.value=t.value.slice(0,DI)),t}isValidEntry(t){let r=this.getMostRecentElement();return r&&r.value===t.value?(t.internalTime||0)-(r.internalTime||0)>qI:!0}stripInternalTime(t){return Array.isArray(t)?t.map(r=>{let{name:n,time:a,value:o}=r;return{name:n,time:a,value:o}}):[]}stripEmptyQuery(t){let{name:r,time:n,value:a}=t;return r&&typeof a=="string"&&r.toLowerCase()==="query"&&a.trim()===""?{name:r,time:n}:t}stripEmptyQueries(t){return t.map(r=>this.stripEmptyQuery(r))}};le(ta,"instance",null);var Km=ta,pt=Km;var Ps=class Ps extends ea{constructor(){super(...arguments);le(this,"getFacetRequest",r=>this.state.facetSet?.[r]?.request||this.state.categoryFacetSet?.[r]?.request||this.state.dateFacetSet?.[r]?.request||this.state.numericFacetSet?.[r]?.request||this.state.automaticFacetSet?.set[r]?.response)}getFacetState(){return Um(nt(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||Ps.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let r=this.getState();return r.search?.searchResponseId||r.search?.response.searchUid||tt().response.searchUid}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let r=!!this.getSplitTestRunName(),n=this.state.search?.response.pipeline||this.state.pipeline||Ps.fallbackPipelineName;return r?n:void 0}getBaseMetadata(){let r=this.getState(),n=super.getBaseMetadata(),a=de(r);return a&&(n.generativeQuestionAnsweringId=a),n}getFacetMetadata(r,n){let o=this.getFacetRequest(r)?.field??"";return{...this.getBaseMetadata(),facetId:r,facetField:o,facetValue:n,facetTitle:`${o}_${r}`}}getFacetClearAllMetadata(r){let a=this.getFacetRequest(r)?.field??"";return{...this.getBaseMetadata(),facetId:r,facetField:a,facetTitle:`${a}_${r}`}}getFacetUpdateSortMetadata(r,n){let o=this.getFacetRequest(r)?.field??"";return{...this.getBaseMetadata(),facetId:r,facetField:o,criteria:n,facetTitle:`${o}_${r}`}}getRangeBreadcrumbFacetMetadata(r,n){let o=this.getFacetRequest(r)?.field??"";return{...this.getBaseMetadata(),facetId:r,facetField:o,facetRangeEnd:n.end,facetRangeEndInclusive:n.endInclusive,facetRangeStart:n.start,facetTitle:`${o}_${r}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??dt()}}getStaticFilterToggleMetadata(r,n){return{...this.getBaseMetadata(),staticFilterId:r,staticFilterValue:n}}getStaticFilterClearAllMetadata(r){return{...this.getBaseMetadata(),staticFilterId:r}}getUndoTriggerQueryMetadata(r){return{...this.getBaseMetadata(),undoneQuery:r}}getCategoryBreadcrumbFacetMetadata(r,n){let o=this.getFacetRequest(r)?.field??"";return{...this.getBaseMetadata(),categoryFacetId:r,categoryFacetField:o,categoryFacetPath:n,categoryFacetTitle:`${o}_${r}`}}getOmniboxAnalyticsMetadata(r,n){let a=this.state.querySuggest?.[r],o=a.completions.map(u=>u.expression),i=a.partialQueries.length-1,s=a.partialQueries[i]||"",c=a.responseId;return{...this.getBaseMetadata(),suggestionRanking:o.indexOf(n),partialQuery:s,partialQueries:a.partialQueries.length>0?a.partialQueries:"",suggestions:o.length>0?o:"",querySuggestResponseId:c}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(r){return{...this.getBaseMetadata(),...r}}getGeneratedAnswerMetadata(){let r=this.getState(),n={};return r.generatedAnswer?.isVisible!==void 0&&(n.showGeneratedAnswer=r.generatedAnswer.isVisible),n}get resultURIs(){return this.results?.map(r=>({documentUri:r.uri,documentUriHash:r.raw.urihash}))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||Fe().q}get responseTime(){return this.state.search?.duration||tt().duration}get numberOfResults(){return this.state.search?.response.totalCountFiltered||tt().response.totalCountFiltered}};le(Ps,"fallbackPipelineName","default");var Yr=Ps,kS=({logger:e,getState:t,analyticsClientMiddleware:r=(o,i)=>i,preprocessRequest:n,provider:a})=>{let o=t(),i=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl??Me(o.configuration.organizationId,o.configuration.environment,"analytics"),c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new ou({token:i,endpoint:s,runtimeEnvironment:c,preprocessRequest:As(e,n),beforeSendHooks:[Fs(e,r),(p,m)=>(e.info({...m,type:p,endpoint:s,token:i},"Analytics request"),m)]},a);return u||l.disable(),l},Jm=()=>{let t=pt.getInstance().getHistory().reverse().find(r=>r.name==="PageView"&&r.value);return t?t.value:""};function pu(e){let t=TS(e),r=[e,...t].filter(a=>a.parentResult).map(a=>a.parentResult);return fy([e,...t,...r],a=>a.uniqueId)}function TS(e){return e.childResults?e.childResults.flatMap(t=>[t,...TS(t)]):[]}var Er=()=>"";function OS(e,t){return{...new Yr(t).getBaseMetadata(),actionCause:e,type:e}}function NI(e){return Object.assign(e,{instantlyCallable:!0})}function MI(e,t){let r=o=>NI(G(e,o)),n=r(async(o,{getState:i,extra:s})=>{let{analyticsClientMiddleware:c,preprocessRequest:u,logger:l}=s;return await(await t({getState:i,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})).log({state:i(),extra:s})});return Object.assign(n,{prepare:async({getState:o,analyticsClientMiddleware:i,preprocessRequest:s,logger:c})=>{let{description:u,log:l}=await t({getState:o,analyticsClientMiddleware:i,preprocessRequest:s,logger:c});return{description:u,action:r(async(p,{getState:m,extra:d})=>await l({state:m(),extra:d}))}}}),n}var qS=(e,t,r)=>{function n(...a){let o=a.length===1?{...a[0],__legacy__getBuilder:t(a[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:a[0],__legacy__getBuilder:t(a[1]),__legacy__provider:a[2],analyticsConfigurator:e,providerClass:r};return UI(o)}return n},QI=e=>e.configuration.analytics.analyticsMode==="legacy",LI=e=>e.configuration.analytics.analyticsMode==="next",UI=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:a,analyticsConfigurator:o,providerClass:i})=>(r??(r=s=>new i(s)),MI(e,async({getState:s,analyticsClientMiddleware:c,preprocessRequest:u,logger:l})=>{let p=[],m={log:async({state:y})=>{for(let x of p)await x(y)}},d=s(),f=o({getState:s,logger:l,analyticsClientMiddleware:c,preprocessRequest:u,provider:r(s)}),C=await t(f,s());m.description=C?.description,p.push(async y=>{QI(y)&&await BI(C,r,y,l,f.coveoAnalyticsClient)});let{emit:g}=hs(d);return p.push(async y=>{if(LI(y)&&a&&n){let x=n(y);await JI(g,a,x)}}),m}));async function BI(e,t,r,n,a){t(()=>r);let o=await e?.log({searchUID:t(()=>r).getSearchUID()});n.info({client:a,response:o},"Analytics response")}var _I=e=>r=>(n,a)=>Promise.resolve({description:{actionCause:e},log:async o=>{r(n,a)}}),Q=qS(e=>kS({...e,provider:e.provider||new Yr(e.getState)}),e=>e,Yr),N_=qS(lS,_I("caseAssist"),Rs);var Re=(e,t)=>{let r=o=>o+(t.pagination?.firstResult??0),n=-1,a=t.search?.results;return n=NS(e,a),n<0&&(n=KI(e,a)),n<0&&(n=0),GI(e,r(n),t)};var DS=(e,t)=>({sourceName:$I(e),documentPosition:1,documentTitle:e.title,documentUri:e.uri,documentUrl:e.clickUri,queryPipeline:t.pipeline||Er()});function $I(e){let t=e.source;return Xm(t)?"unknown":t}var jS=e=>({contentIdKey:"permanentid",contentIdValue:e.permanentid||""});function GI(e,t,r){let n=e.raw.collection;return{collectionName:typeof n=="string"?n:"default",documentAuthor:WI(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:YI(e),queryPipeline:r.pipeline||Er()}}var pe=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),VS={urihash:new mu,sourcetype:new mu,permanentid:new mu},fu={uniqueId:j,raw:new jI({values:VS}),title:j,uri:j,clickUri:j,rankingModifier:new mu({required:!1,emptyAllowed:!0})};function HI(e){return Object.assign({},...Object.keys(VS).map(t=>({[t]:e[t]})))}function zI(e){return Object.assign({},...Object.keys(fu).map(t=>({[t]:e[t]})),{raw:HI(e.raw)})}function WI(e){let t=e.raw.author;return Xm(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function YI(e){let t=e.raw.source;return Xm(t)?"unknown":t}var Je=e=>new VI(fu).validate(zI(e));function KI(e,t){for(let[r,n]of t.entries()){let a=pu(n);if(NS(e,a)!==-1)return r}return-1}function NS(e,t=[]){return t.findIndex(({uniqueId:r})=>r===e.uniqueId)}async function JI(e,t,r){await e(t,r)}var Zm=e=>F(e,{evt:j,type:me}),MS=e=>Q("analytics/generic/search",t=>{Zm(e);let{evt:r,meta:n}=e;return t.makeSearchEvent(r,n)}),QS=e=>Q("analytics/generic/click",(t,r)=>(Je(e.result),Zm(e),t.makeClickEvent(e.evt,Re(e.result,r),pe(e.result),e.meta))),LS=e=>Q("analytics/generic/custom",t=>(Zm(e),t.makeCustomEventWithType(e.evt,e.type,e.meta))),gu=()=>Q("analytics/interface/load",e=>e.makeInterfaceLoad()),Kr=()=>Q("analytics/interface/change",(e,t)=>e.makeInterfaceChange({interfaceChangeTo:t.configuration.analytics.originLevel2})),yu=()=>Q("analytics/interface/searchFromLink",e=>e.makeSearchFromLink()),hu=e=>Q("analytics/interface/omniboxFromLink",t=>t.makeOmniboxFromLink(e)),US=()=>({actionCause:"interfaceLoad"}),ao=()=>({actionCause:"interfaceChange"}),BS=()=>({actionCause:"searchFromLink"}),_S=()=>({actionCause:"omniboxFromLink"});import{ArrayValue as XI,BooleanValue as $S,RecordValue as ZI,StringValue as Es,Value as ek}from"../bueno/v1.1.0/bueno.esm.js";var ef=()=>me,GS=()=>j,wt=S("configuration/updateBasicConfiguration",e=>F(e,{accessToken:me,environment:new Es({required:!1,constrainTo:["prod","hipaa","stg","dev"]}),organizationId:me})),mt=S("configuration/updateSearchConfiguration",e=>F(e,{proxyBaseUrl:new Es({required:!1,url:!0}),pipeline:new Es({required:!1,emptyAllowed:!0}),searchHub:me,timezone:me,locale:me,authenticationProviders:new XI({required:!1,each:j})})),tk={enabled:new $S({default:!0}),originContext:ef(),originLevel2:ef(),originLevel3:ef(),proxyBaseUrl:new Es({required:!1,url:!0}),runtimeEnvironment:new ek,anonymous:new $S({default:!1}),deviceId:me,userDisplayName:me,documentLocation:me,trackingId:Wy,analyticsMode:new Es({constrainTo:["legacy","next"],required:!1,default:"next"}),source:new ZI({options:{required:!1},values:Lh.reduce((e,t)=>(e[t]=zy,e),{})})},Jr=S("configuration/updateAnalyticsConfiguration",e=>F(e,tk)),oo=S("configuration/analytics/disable"),io=S("configuration/analytics/enable"),Su=S("configuration/analytics/originlevel2",e=>F(e,{originLevel2:GS()})),Cu=S("configuration/analytics/originlevel3",e=>F(e,{originLevel3:GS()}));import{BooleanValue as HS,NumberValue as zS,RecordValue as Xr,StringValue as Is}from"../bueno/v1.1.0/bueno.esm.js";var xu={q:new Is,enableQuerySyntax:new HS,aq:new Is,cq:new Is,firstResult:new zS({min:0}),numberOfResults:new zS({min:0}),sortCriteria:new Is,f:new Xr,fExcluded:new Xr,cf:new Xr,nf:new Xr,mnf:new Xr,df:new Xr,debug:new HS,sf:new Xr,tab:new Is,af:new Xr};var ie=S("searchParameters/restore",e=>F(e,xu)),so=S("searchParameters/restoreTab",e=>F(e,j));var Zr=S("debug/enable"),co=S("debug/disable");var en=()=>!1;var uo=$(en(),e=>{e.addCase(Zr,()=>!0).addCase(co,()=>!1).addCase(ie,(t,r)=>r.payload.debug??t)});var tf=S("history/undo"),rf=S("history/redo"),at=S("history/snapshot"),ks=G("history/back",async(e,{dispatch:t})=>{t(tf()),await t(oe())}),Au=G("history/forward",async(e,{dispatch:t})=>{t(rf()),await t(oe())}),oe=G("history/change",async(e,{getState:t})=>t().history.present);import{StringValue as rk}from"../bueno/v1.1.0/bueno.esm.js";var lo=S("pipeline/set",e=>F(e,new rk({required:!0,emptyAllowed:!0})));var po=$(Er(),e=>{e.addCase(lo,(t,r)=>r.payload).addCase(oe.fulfilled,(t,r)=>r.payload?.pipeline??t).addCase(mt,(t,r)=>r.payload.pipeline||t)});import{BooleanValue as FC,NumberValue as RC,StringValue as Bk}from"../bueno/v1.1.0/bueno.esm.js";var be=S("breadcrumb/deselectAll"),mo=S("breadcrumb/deselectAllNonBreadcrumbs");import{BooleanValue as nk}from"../bueno/v1.1.0/bueno.esm.js";var Ut=S("facet/updateFacetAutoSelection",e=>F(e,{allow:new nk({required:!0})}));var Ts=class extends Yr{constructor(r){super(r);this.getState=r}get activeInstantResultQuery(){let r=this.getState().instantResults;for(let n in r)for(let a in r[n].cache)if(r[n].cache[a].isActive)return r[n].q;return null}get activeInstantResultCache(){let r=this.getState().instantResults;for(let n in r)for(let a in r[n].cache)if(r[n].cache[a].isActive)return r[n].cache[a];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??Fe().q}get responseTime(){return this.activeInstantResultCache?.duration??tt().duration}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??tt().response.totalCountFiltered}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}};var WS=e=>Q({prefix:"analytics/instantResult/open",__legacy__getBuilder:(t,r)=>(Je(e),t.makeDocumentOpen(Re(e,r),pe(e))),__legacy__provider:t=>new Ts(t),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=Re(e,t),n=pe(e);return{responseId:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}),YS=()=>Q("analytics/instantResult/searchboxAsYouType",e=>e.makeSearchboxAsYouType(),e=>new Ts(e)),KS=()=>({actionCause:"searchboxAsYouType"});var nf={id:j},ak={...nf,q:ce},fo=S("instantResults/register",e=>F(e,nf)),Bt=S("instantResults/updateQuery",e=>F(e,ak)),go=S("instantResults/clearExpired",e=>F(e,nf));import{NumberValue as ok}from"../bueno/v1.1.0/bueno.esm.js";var Fu=new ok({required:!0,min:0}),yo=S("pagination/registerNumberOfResults",e=>F(e,Fu)),ho=S("pagination/updateNumberOfResults",e=>F(e,Fu)),So=S("pagination/registerPage",e=>F(e,Fu)),_t=S("pagination/updatePage",e=>F(e,Fu)),Co=S("pagination/nextPage"),xo=S("pagination/previousPage");import{BooleanValue as ik,StringValue as sk}from"../bueno/v1.1.0/bueno.esm.js";var Xe=S("query/updateQuery",e=>F(e,{q:new sk,enableQuerySyntax:new ik}));import{isNullOrUndefined as ck}from"../bueno/v1.1.0/bueno.esm.js";var tn=(e,t,r)=>({analytics:{clientId:t.clientId,clientTimestamp:new Date().toISOString(),documentReferrer:t.referrer,documentLocation:t.location,originContext:e.originContext,...r&&{actionCause:r.actionCause},...r&&{customData:r.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.deviceId&&{deviceId:e.deviceId},...e.trackingId&&{trackingId:e.trackingId},capture:t.capture??t.clientId!=="",source:Hr(e)}});var Ao=(e,t,r)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??Pe(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:t.referrer,timezone:e.configuration.search.timezone,...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&tn(e.configuration.analytics,t,r),...e.excerptLength&&!ck(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});import{NumberValue as hC}from"../bueno/v1.1.0/bueno.esm.js";import{isNullOrUndefined as uk}from"../bueno/v1.1.0/bueno.esm.js";var Fo=async(e,t)=>{let r=e.analyticsMode==="next";return{analytics:{clientId:await uS(e),clientTimestamp:new Date().toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...Jm()&&{pageId:Jm()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:Hr(e)}}}};var rn=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??Pe(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{actionsHistory:pt.getInstance().getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await Fo(e.configuration.analytics,t),...e.excerptLength&&!uk(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var Pt=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}});var af=()=>Q("search/logFetchMoreResults",e=>e.makeFetchMoreResults()),nn=e=>Q("search/queryError",(t,r)=>t.makeQueryError({query:r.query?.q||Fe().q,aq:r.advancedSearchQueries?.aq||Pt().aq,cq:r.advancedSearchQueries?.cq||Pt().cq,dq:r.advancedSearchQueries?.dq||Pt().dq,errorType:e.type,errorMessage:e.message}));var Ds=Cr(Ru(),1),rC=Cr(JS(),1);import{NumberValue as dk,Schema as pk,StringValue as tC}from"../bueno/v1.1.0/bueno.esm.js";var bu=Cr(Ru(),1),ZS=Cr(XS(),1);bu.default.extend(ZS.default);var Os="YYYY/MM/DD@HH:mm:ss",lk="1401-01-01";function ra(e,t){let r=(0,bu.default)(e,t);return!r.isValid()&&!t?(0,bu.default)(e,Os):r}function qs(e){return e.format(Os)}function eC(e){return qs(ra(e))===e}function vu(e,t){let r=ra(e,t);if(!r.isValid()){let n=". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information.",a=` with the format "${t}"`;throw new Error(`Could not parse the provided date "${e}"${t?a:n}`)}pf(r)}function pf(e){if(e.isBefore(lk))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}Ds.default.extend(rC.default);var nC=["past","now","next"],aC=["minute","hour","day","week","month","quarter","year"],mk=e=>{let t=e==="now";return{amount:new dk({required:!t,min:1}),unit:new tC({required:!t,constrainTo:aC}),period:new tC({required:!0,constrainTo:nC})}};function na(e){if(typeof e=="string"&&!$t(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t=typeof e=="string"?mf(e):e;new pk(mk(t.period)).validate(t);let r=iC(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);pf(r)}function oC(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}function iC(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,Ds.default)().subtract(r,n);case"next":return(0,Ds.default)().add(r,n);case"now":return(0,Ds.default)()}}function js(e){return qs(iC(mf(e)))}function sC(e){return e.toLocaleLowerCase().split("-")}function $t(e){let[t,r,n]=sC(e);if(t==="now")return!0;if(!nC.includes(t)||!aC.includes(n))return!1;let a=parseInt(r);return!(Number.isNaN(a)||a<=0)}function cC(e){return!!e&&typeof e=="object"&&"period"in e}function mf(e){let[t,r,n]=sC(e);return t==="now"?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function fk(e){return na(e),mf(e)}function uC(e){return e.type==="dateRange"}function lC(e){return`start${e}`}function dC(e){return`end${e}`}var ff=()=>({dateFacetValueMap:{}});function gk(e,t,r){let n=e.start,a=e.end;return $t(n)&&(n=js(n),r.dateFacetValueMap[t][lC(n)]=e.start),$t(a)&&(a=js(a),r.dateFacetValueMap[t][dC(a)]=e.end),{...e,start:n,end:a}}function gf(e,t){if(uC(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map(a=>gk(a,r,t))}}return e}function an(e){let t=ff();return{request:{...e,facets:e.facets?.map(n=>gf(n,t))},mappings:t}}function yk(e,t,r){return{...e,start:r.dateFacetValueMap[t][lC(e.start)]||e.start,end:r.dateFacetValueMap[t][dC(e.end)]||e.end}}function hk(e,t){return e.facetId in t.dateFacetValueMap}function Sk(e,t){return hk(e,t)?{...e,values:e.values.map(r=>yk(r,e.facetId,t))}:e}function wu(e,t){return"success"in e?{success:{...e.success,facets:e.success.facets?.map(n=>Sk(n,t))}}:e}import{isNullOrUndefined as yC}from"../bueno/v1.1.0/bueno.esm.js";import{StringValue as Ck}from"../bueno/v1.1.0/bueno.esm.js";var Ro=S("didYouMean/enable"),Pu=S("didYouMean/disable"),bo=S("didYouMean/automaticCorrections/disable"),Eu=S("didYouMean/automaticCorrections/enable"),ft=S("didYouMean/correction",e=>F(e,j)),aa=S("didYouMean/automaticCorrections/mode",e=>F(e,new Ck({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})));var Iu=()=>Q("analytics/didyoumean/click",e=>e.makeDidYouMeanClick()),yf=()=>Q("analytics/didyoumean/automatic",e=>e.makeDidYouMeanAutomatic()),pC=()=>({actionCause:"didYouMeanClick"}),mC=()=>({actionCause:"didYouMeanAutomatic"});function ku(){return{contextValues:{}}}function Tu(){return{contextValues:{}}}function hf(){return{enabled:!0,tabs:{}}}function Ou(){return{freezeFacetOrder:!1,facets:{}}}function vo(){return[]}function gt(){return{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0}}function qu(){return{}}function Du(){return{}}function ju(){return{}}function fC(){return Et({})}function Et(e){return{context:e.context||ku(),dictionaryFieldContext:e.dictionaryFieldContext||Tu(),facetSet:e.facetSet||Xa(),numericFacetSet:e.numericFacetSet||Ja(),dateFacetSet:e.dateFacetSet||Ka(),categoryFacetSet:e.categoryFacetSet||Ya(),automaticFacetSet:e.automaticFacetSet??Wa(),pagination:e.pagination||gt(),query:e.query||Fe(),tabSet:e.tabSet||ju(),advancedSearchQueries:e.advancedSearchQueries||Pt(),staticFilterSet:e.staticFilterSet||Du(),querySet:e.querySet||qu(),sortCriteria:e.sortCriteria||dt(),pipeline:e.pipeline||Er(),searchHub:e.searchHub||Wr(),facetOptions:e.facetOptions||Ou(),facetOrder:e.facetOrder??vo(),debug:e.debug??en()}}import{RecordValue as xk}from"../bueno/v1.1.0/bueno.esm.js";var Ak=new xk({values:{undoneQuery:ce},options:{required:!0}}),Vu=()=>Q("analytics/trigger/query",(e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null),Nu=e=>Q("analytics/trigger/query/undo",t=>(F(e,Ak),t.makeUndoTriggerQuery(e))),Mu=()=>Q("analytics/trigger/notify",(e,t)=>t.triggers?.notifications.length?e.makeTriggerNotify({notifications:t.triggers.notifications}):null),Qu=()=>Q("analytics/trigger/redirect",(e,t)=>t.triggers?.redirectTo?e.makeTriggerRedirect({redirectedTo:t.triggers.redirectTo}):null),Lu=()=>Q("analytics/trigger/execute",(e,t)=>t.triggers?.executions.length?e.makeTriggerExecute({executions:t.triggers.executions}):null);import{RecordValue as Fk,StringValue as Rk}from"../bueno/v1.1.0/bueno.esm.js";var on=S("trigger/query/ignore",e=>F(e,new Rk({emptyAllowed:!0,required:!0}))),wo=S("trigger/query/modification",e=>F(e,new Fk({values:{originalQuery:me,modification:me}})));function sn(e){return Object.values(e).map(t=>t.request)}function Vs(e,t){let r={};e.forEach(o=>{r[o.facetId]=o});let n=[];t.forEach(o=>{o in r&&(n.push(r[o]),delete r[o])});let a=Object.values(r);return[...n,...a]}function gC(e){return sn(e).map(t=>{let n=t.currentValues.some(({state:a})=>a!=="idle");return t.generateAutomaticRanges&&!n?{...t,currentValues:[]}:t})}var Sf={alphanumericDescending:{type:"alphanumeric",order:"descending"},alphanumericNaturalDescending:{type:"alphanumericNatural",order:"descending"}};function bk(e){return sn(e).map(t=>{let r=Sf[t.sortCriteria];return r?{...t,sortCriteria:r}:t})}function vk(e){return[...bk(e.facetSet??{}),...gC(e.numericFacetSet??{}),...gC(e.dateFacetSet??{}),...sn(e.categoryFacetSet??{})]}function wk(e){return vk(e).filter(({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0)}function Uu(e){return Vs(wk(e),e.facetOrder??[])}var cn=async(e,t)=>{let r=Ik(e),n=Uu(e),a=Pk(e),o=await rn(e,t),i=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return an({...o,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:i(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:a}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function Pk(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map(r=>r.response).map(Ek).filter(r=>r.currentValues.length>0):void 0}function Ek(e){let{field:t,label:r,values:n}=e,a=n.filter(o=>o.state==="selected");return{field:t,label:r,currentValues:a}}function Ik(e){let t=e.advancedSearchQueries?.cq.trim()||"",n=Object.values(e.tabSet||{}).find(o=>o.isActive)?.expression.trim()||"",a=kk(e);return[t,n,...a].filter(o=>!!o).join(" AND ")}function kk(e){return Object.values(e.staticFilterSet||{}).map(r=>{let n=r.values.filter(o=>o.state==="selected"&&!!o.expression.trim()),a=n.map(o=>o.expression).join(" OR ");return n.length>1?`(${a})`:a})}var un=class{constructor(t,r=n=>{this.dispatch(Xe({q:n}))}){this.config=t;this.onUpdateQueryForCorrection=r}async fetchFromAPI({mappings:t,request:r},n){let a=Date.now(),o=wu(await this.extra.apiClient.search(r,n),t),i=Date.now()-a,s=this.getState().query?.q||"";return{response:o,duration:i,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return Ee(t.response)?(this.dispatch(nn(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:a,automaticallyCorrectQuery:o}=r.didYouMean,{results:i,queryCorrections:s,queryCorrection:c}=n;if(!a||!o)return null;let u=i.length===0&&s&&s.length!==0,l=!yC(c)&&!yC(c.correctedQuery);if(!u&&!l)return null;let m=u?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(at(Et(this.getState()))),m}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:a}=n.queryCorrections[0],o=await this.automaticallyRetryQueryWithCorrection(a);return Ee(o.response)?(this.dispatch(nn(o.response.error)),this.rejectWithValue(o.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(t),this.dispatch(at(Et(this.getState()))),{...o,response:{...o.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r,analyticsAction:yf()})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:a}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:a,analyticsAction:yf()}}logOriginalAnalyticsQueryBeforeAutoCorrection(t){let r=this.getState(),n=this.getSuccessResponse(t);this.analyticsAction?.()(this.dispatch,()=>this.getStateAfterResponse(t.queryExecuted,t.duration,r,n),this.extra)}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(on("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let o=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(n);return Ee(i.response)?(this.dispatch(nn(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(at(Et(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:o,analyticsAction:Vu()})}getStateAfterResponse(t,r,n,a){return{...n,query:{q:t,enableQuerySyntax:n.query?.enableQuerySyntax??Fe().enableQuerySyntax},search:{...tt(),duration:r,response:a,results:a.results}}}processSuccessResponse(t){return this.dispatch(at(Et(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(t){return qc(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=await this.fetchFromAPI(await cn(this.getState()),{origin:"mainSearch"});return this.dispatch(ft(t)),r}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(wo({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await cn(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};var Po=G("search/executeSearch",async(e,t)=>{let r=t.getState();return await _u(r,t,e)}),Eo=G("search/fetchPage",async(e,t)=>{let r=t.getState();return await xf(r,t,e)}),Io=G("search/fetchMoreResults",async(e,t)=>{let r=t.getState();return await Af(t,r)}),Bu=G("search/fetchFacetValues",async(e,t)=>{let r=t.getState();return await Dk(t,e,r)}),SC=G("search/fetchInstantResults",async(e,t)=>Cf(e,t)),Tk=async(e,t)=>{let r=await cn(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},Ok=async(e,t,r)=>{let n=await rn(e);return an({...n,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t})},qk=async(e,t)=>{let r=await cn(e,t);return r.request.numberOfResults=0,r},CC=e=>{e.configuration.analytics.enabled&&pt.getInstance().addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})};async function Cf(e,t){F(e,{id:j,q:j,maxResultsPerQuery:new hC({required:!0,min:1}),cacheTimeout:new hC});let{q:r,maxResultsPerQuery:n}=e,a=t.getState(),o=new un({...t,analyticsAction:YS()},u=>{t.dispatch(Bt({q:u,id:e.id}))}),i=await Ok(a,r,n),s=await o.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),c=await o.process(s);return"response"in c?{results:c.response.results,searchUid:c.response.searchUid,analyticsAction:c.analyticsAction,totalCountFiltered:c.response.totalCountFiltered,duration:c.duration}:c}async function xf(e,t,r){CC(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:o}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:o}),s=new un({...t,analyticsAction:r}),c=await cn(e,i),u=await s.fetchFromAPI(c,{origin:"mainSearch"});return await s.process(u)}async function Af(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:a}=e.extra,{description:o}=await af().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:a}),i=new un({...e,analyticsAction:af()}),s=await Tk(t,o),c=await i.fetchFromAPI(s,{origin:"mainSearch"});return await i.process(c)}async function Dk(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:a,logger:o}=e.extra,{description:i}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:o}),s=new un({...e,analyticsAction:t}),c=await qk(r,i),u=await s.fetchFromAPI(c,{origin:"facetValues"});return await s.process(u)}async function _u(e,t,r){CC(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:o}=t.extra,{description:i}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:o});i?.actionCause&&t.dispatch(oa({actionCause:i.actionCause}));let s=await cn(e,i),c=new un({...t,analyticsAction:r}),u=await c.fetchFromAPI(s,{origin:"mainSearch"});return await c.process(u)}import{isNullOrUndefined as AC}from"../bueno/v1.1.0/bueno.esm.js";var $u=Y(e=>e.staticFilterSet,e=>Object.values(e||{}).map(r=>{let n=r.values.filter(o=>o.state==="selected"&&!!o.expression.trim()),a=n.map(o=>o.expression).join(" OR ");return n.length>1?`(${a})`:a}));var yt=async(e,t,r)=>{let n=Uk(e),a=jk(e),o=Vk(e),i=e.configuration.analytics.analyticsMode==="legacy"?await rn(e,r):Ao(e,t,r),s=()=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0;return an({...i,...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...n&&{cq:n},...a.length&&{facets:a},...e.pagination&&{numberOfResults:s(),firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:o}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function jk(e){return Vs(Mk(e),e.facetOrder??[])}function Vk(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map(r=>r.response).map(Nk).filter(r=>r.currentValues.length>0):void 0}function Nk(e){let{field:t,label:r,values:n}=e,a=n.filter(o=>o.state==="selected");return{field:t,label:r,currentValues:a}}function Mk(e){return Qk(e).filter(({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0)}function Qk(e){return[...Lk(e.facetSet??{}),...xC(e.numericFacetSet??{}),...xC(e.dateFacetSet??{}),...sn(e.categoryFacetSet??{})]}function Lk(e){return sn(e).map(t=>{let r=Sf[t.sortCriteria];return r?{...t,sortCriteria:r}:t})}function xC(e){return sn(e).map(t=>{let r=t.currentValues,n=r.some(({state:o})=>o!=="idle"),a=r.some(o=>o.previousState);return t.generateAutomaticRanges&&!n&&!a?{...t,currentValues:[]}:t})}function Uk(e){let t=e.advancedSearchQueries?.cq.trim()||"",n=Object.values(e.tabSet||{}).find(o=>o.isActive)?.expression.trim()||"",a=$u(e);return[t,n,...a].filter(o=>!!o).join(" AND ")}var ln=class{constructor(t,r=n=>{this.dispatch(Xe({q:n}))}){this.config=t;this.onUpdateQueryForCorrection=r}async fetchFromAPI({mappings:t,request:r},n){let a=Date.now(),o=wu(await this.extra.apiClient.search(r,n),t),i=Date.now()-a,s=this.getState().query?.q||"";return{response:o,duration:i,queryExecuted:s,requestExecuted:r}}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}processQueryErrorOrContinue(t){return Ee(t.response)?(this.dispatch(nn(t.response.error)),this.rejectWithValue(t.response.error)):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{enableDidYouMean:a,automaticallyCorrectQuery:o}=r.didYouMean,{results:i,queryCorrections:s,queryCorrection:c}=n;if(!a||!o)return null;let u=i.length===0&&s&&s.length!==0,l=!AC(c)&&!AC(c.correctedQuery);if(!u&&!l)return null;let m=u?await this.processLegacyDidYouMeanAutoCorrection(t):this.processModernDidYouMeanAutoCorrection(t);return this.dispatch(at(Et(this.getState()))),m}async processLegacyDidYouMeanAutoCorrection(t){let r=this.getCurrentQuery(),n=this.getSuccessResponse(t);if(!n.queryCorrections)return null;let{correctedQuery:a}=n.queryCorrections[0],o=await this.automaticallyRetryQueryWithCorrection(a);return Ee(o.response)?(this.dispatch(nn(o.response.error)),this.rejectWithValue(o.response.error)):(this.dispatch(at(Et(this.getState()))),{...o,response:{...o.response.success,queryCorrections:n.queryCorrections},automaticallyCorrected:!0,originalQuery:r})}processModernDidYouMeanAutoCorrection(t){let r=this.getSuccessResponse(t),{correctedQuery:n,originalQuery:a}=r.queryCorrection;return this.onUpdateQueryForCorrection(n),{...t,response:{...r},queryExecuted:n,automaticallyCorrected:!0,originalQuery:a}}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(on("")),null;let o=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(n);return Ee(i.response)?(this.dispatch(nn(i.response.error)),this.rejectWithValue(i.response.error)):(this.dispatch(at(Et(this.getState()))),{...i,response:{...i.response.success},automaticallyCorrected:!1,originalQuery:o})}processSuccessResponse(t){return this.dispatch(at(Et(this.getState()))),{...t,response:this.getSuccessResponse(t),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(t){return qc(t.response)?t.response.success:null}async automaticallyRetryQueryWithCorrection(t){this.onUpdateQueryForCorrection(t);let r=this.getState(),{actionCause:n}=mC(),a=await this.fetchFromAPI(await yt(r,this.extra.navigatorContext,{actionCause:n}),{origin:"mainSearch"});return this.dispatch(ft(t)),a}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(wo({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI(await yt(this.getState(),this.extra.navigatorContext),{origin:"mainSearch"})}getCurrentQuery(){let t=this.getState();return t.query?.q!==void 0?t.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}};var ko=G("search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;F(e,{q:new Bk,enableQuerySyntax:new FC,clearFilters:new FC}),e.clearFilters&&(r(be()),r(mo())),r(Ut({allow:!0})),r(Xe({q:e.q,enableQuerySyntax:e.enableQuerySyntax})),r(_t(1))}),oa=S("search/updateSearchAction"),V=G("search/executeSearch",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return _u(r,t,e.legacy);bC(r);let n=e.next?vC(e.next):void 0;t.dispatch(oa(e.next));let a=await yt(r,t.extra.navigatorContext,n),o=new ln({...t,analyticsAction:n??{}}),i=await o.fetchFromAPI(a,{origin:"mainSearch"});return await o.process(i)}),Ht=G("search/fetchPage",async(e,t)=>{let r=t.getState();if(bC(r),r.configuration.analytics.analyticsMode==="legacy"||!e.next)return xf(r,t,e.legacy);let n=new ln({...t,analyticsAction:e.next}),a=await yt(r,t.extra.navigatorContext,e.next),o=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(o)}),dn=G("search/fetchMoreResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Af(t,r);let n=OS("browseResults",t.getState),a=new ln({...t,analyticsAction:n}),o=await _k(r,t.extra.navigatorContext,n),i=await a.fetchFromAPI(o,{origin:"mainSearch"});return await a.process(i)}),zt=G("search/fetchFacetValues",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return _u(r,t,e.legacy);let n=new ln({...t,analyticsAction:{}}),a=await Gk(r,t.extra.navigatorContext),o=await n.fetchFromAPI(a,{origin:"facetValues"});return await n.process(o)}),To=G("search/fetchInstantResults",async(e,t)=>{let r=t.getState();if(r.configuration.analytics.analyticsMode==="legacy")return Cf(e,t);F(e,{id:j,q:j,maxResultsPerQuery:new RC({required:!0,min:1}),cacheTimeout:new RC});let{q:n,maxResultsPerQuery:a}=e,o=vC(KS()),i=await $k(r,t.extra.navigatorContext,n,a,o),s=new ln({...t,analyticsAction:o},l=>{t.dispatch(Bt({q:l,id:e.id}))}),c=await s.fetchFromAPI(i,{origin:"instantResults",disableAbortWarning:!0}),u=await s.process(c);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}),_k=async(e,t,r)=>{let n=await yt(e,t,r);return n.request={...n.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},n},$k=async(e,t,r,n,a)=>{let o=Ao(e,t,a);return an({...o,...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:n,q:r})},Gk=async(e,t,r)=>{let n=await yt(e,t,r);return n.request.numberOfResults=0,n},bC=e=>{e.configuration.analytics.enabled&&pt.getInstance().addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})},vC=e=>({actionCause:e.actionCause,type:e.actionCause});import{isNullOrUndefined as Gu}from"../bueno/v1.1.0/bueno.esm.js";var pn=(e,t)=>{let r=e;return Gu(r[t])?Gu(e.raw[t])?null:e.raw[t]:r[t]},Hk=e=>t=>e.every(r=>!Gu(pn(t,r))),zk=e=>t=>e.every(r=>Gu(pn(t,r))),Wk=(e,t)=>r=>{let n=wC(e,r);return t.some(a=>n.some(o=>`${o}`.toLowerCase()===a.toLowerCase()))},Yk=(e,t)=>r=>{let n=wC(e,r);return t.every(a=>n.every(o=>`${o}`.toLowerCase()!==a.toLowerCase()))},wC=(e,t)=>{let r=pn(t,e);return vc(r)?r:[r]},Kk={getResultProperty:pn,fieldsMustBeDefined:Hk,fieldsMustNotBeDefined:zk,fieldMustMatch:Wk,fieldMustNotMatch:Yk};function Ns(e){return e.search.response.searchUid!==""}function PC(e,t,r){return e.search.results.find(n=>pn(n,t)===r)}var EC=Y(e=>e.search,e=>e?.searchAction?.actionCause||"");var Oo=S("app/setError");function Ff(e,t){let r=t.payload??null;r&&(e.response=tt().response,e.results=[],e.questionAnswer=Na()),e.error=r,e.isLoading=!1}function bf(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function Jk(e,t){bf(e,t),e.results=t.payload.response.results.map(r=>({...r,searchUid:t.payload.response.searchUid})),e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}function Rf(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}var W=$(tt(),e=>{e.addCase(Po.rejected,(t,r)=>Ff(t,r)),e.addCase(Io.rejected,(t,r)=>Ff(t,r)),e.addCase(Eo.rejected,(t,r)=>Ff(t,r)),e.addCase(Po.fulfilled,(t,r)=>{Jk(t,r)}),e.addCase(Io.fulfilled,(t,r)=>{bf(t,r),t.results=[...t.results,...r.payload.response.results.map(n=>({...n,searchUid:r.payload.response.searchUid}))]}),e.addCase(Eo.fulfilled,(t,r)=>{bf(t,r),t.results=[...r.payload.response.results.map(n=>({...n,searchUid:r.payload.response.searchUid}))]}),e.addCase(Bu.fulfilled,(t,r)=>{t.response.facets=r.payload.response.facets,t.response.searchUid=r.payload.response.searchUid}),e.addCase(Po.pending,Rf),e.addCase(Io.pending,Rf),e.addCase(Eo.pending,Rf),e.addCase(oa,(t,r)=>{t.searchAction=r.payload}),e.addCase(Oo,(t,r)=>{t.error=r.payload,t.isLoading=!1})});import{StringValue as Xk}from"../bueno/v1.1.0/bueno.esm.js";var qo=S("searchHub/set",e=>F(e,new Xk({required:!0,emptyAllowed:!0})));var Do=$(Wr(),e=>{e.addCase(qo,(t,r)=>r.payload).addCase(oe.fulfilled,(t,r)=>r.payload?.searchHub??t).addCase(mt,(t,r)=>r.payload.searchHub||t)});var IC=()=>({referrer:null,userAgent:null,location:null,clientId:""}),vf=(e,t)=>{let{referrer:r,userAgent:n,location:a,clientId:o}=e.getMeta("");return{...t?t():{},referrer:r,userAgent:n,location:a,clientId:o}};var wf=Y(e=>e.advancedSearchQueries,e=>{if(!e)return{};let{aq:t,cq:r,dq:n,lq:a}=e;return{...t&&{aq:t},...r&&{cq:r},...n&&{dq:n},...a&&{lq:a}}});var kC=Y(e=>e.context,e=>e);import{ArrayValue as qC,BooleanValue as lT,NumberValue as dT,RecordValue as pT,StringValue as Wu}from"../bueno/v1.1.0/bueno.esm.js";var Hu=e=>{if(e==="yes")return!0;if(e==="no")return!1},Zk=()=>Q("analytics/generatedAnswer/retry",e=>e.makeRetryGeneratedAnswer()),eT=e=>Q({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let n=de(r),a=vs(r,e);return!n||!a?null:t.makeGeneratedAnswerCitationClick(DS(a,r),{generativeQuestionAnsweringId:n,citationId:a.id,documentId:jS(a)})},analyticsType:"Rga.CitationClick",analyticsPayloadBuilder:t=>{let r=vs(t,e);return{answerId:de(t)??"",citationId:e,itemMetadata:{uniqueFieldName:"permanentid",uniqueFieldValue:r?.permanentid??"",title:r?.title,url:r?.clickUri}}}}),tT=(e,t)=>Q({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let a=de(n),o=vs(n,e);return!a||!o?null:r.makeGeneratedAnswerSourceHover({generativeQuestionAnsweringId:a,permanentId:o.permanentid,citationId:o.id,citationHoverTimeMs:t})},analyticsType:"Rga.CitationHover",analyticsPayloadBuilder:r=>{let n=vs(r,e);return{answerId:de(r)??"",citationId:e,itemMetadata:{uniqueFieldName:"permanentid",uniqueFieldValue:n?.permanentid??"",title:n?.title,url:n?.clickUri},citationHoverTimeInMs:t}}}),rT=()=>Q({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeLikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"like"})}),nT=()=>Q({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeDislikeGeneratedAnswer({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"dislike"})}),aT=e=>Q({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let n=de(r);return n?t.makeGeneratedAnswerFeedbackSubmitV2({generativeQuestionAnsweringId:n,...e}):null},analyticsType:"Rga.SubmitFeedback",analyticsPayloadBuilder:t=>{let r=de(t),{helpful:n,readable:a,documented:o,hallucinationFree:i,correctTopic:s,documentUrl:c,details:u}=e;return{answerId:r??"",helpful:n,details:{readable:Hu(a),documented:Hu(o),correctTopic:Hu(s),hallucinationFree:Hu(i)},additionalNotes:u,correctAnswerUrl:c}}}),Ms=e=>Q({prefix:"analytics/generatedAnswer/streamEnd",__legacy__getBuilder:(t,r)=>{let n=de(r),a=e?!r.generatedAnswer?.answer||!r.generatedAnswer?.answer.length:void 0;return n?t.makeGeneratedAnswerStreamEnd({generativeQuestionAnsweringId:n,answerGenerated:e,answerTextIsEmpty:a}):null},analyticsType:"Rga.AnswerReceived",analyticsPayloadBuilder:t=>({answerId:de(t)??"",answerGenerated:e??!1})}),oT=()=>Q({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeGeneratedAnswerShowAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"show"})}),iT=()=>Q({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeGeneratedAnswerHideAnswers({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"hide"})}),sT=()=>Q({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeGeneratedAnswerExpand({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"expand"})}),cT=()=>Q({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeGeneratedAnswerCollapse({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"collapse"})}),uT=()=>Q({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let r=de(t);return r?e.makeGeneratedAnswerCopyToClipboard({generativeQuestionAnsweringId:r}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>({answerId:de(e)??"",action:"copyToClipboard"})});var Qs={logCopyGeneratedAnswer:uT,logGeneratedAnswerHideAnswers:iT,logGeneratedAnswerShowAnswers:oT,logGeneratedAnswerStreamEnd:Ms,logGeneratedAnswerFeedback:aT,logDislikeGeneratedAnswer:nT,logLikeGeneratedAnswer:rT,logHoverCitation:tT,logOpenGeneratedAnswerSource:eT,logRetryGeneratedAnswer:Zk,logGeneratedAnswerExpand:sT,logGeneratedAnswerCollapse:cT};var TC=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:Me(e.configuration.organizationId,e.configuration.environment),streamId:e.search.extendedResults?.generativeQuestionAnsweringId});var OC=["text/plain","text/markdown"];var jo=new Wu({required:!0}),DC=new Wu,Vo=new lT({required:!0}),mT={id:jo,title:jo,uri:jo,permanentid:jo,clickUri:DC},jC=new Wu({required:!0,constrainTo:OC}),No=S("generatedAnswer/setIsVisible",e=>F(e,Vo)),Us=S("generatedAnswer/setIsEnabled",e=>F(e,Vo)),Bs=S("generatedAnswer/updateMessage",e=>F(e,{textDelta:jo})),_s=S("generatedAnswer/updateCitations",e=>F(e,{citations:new qC({required:!0,each:new pT({values:mT})})})),Pf=S("generatedAnswer/updateError",e=>F(e,{message:DC,code:new dT({min:0})})),It=S("generatedAnswer/resetAnswer"),Yu=S("generatedAnswer/like"),Ku=S("generatedAnswer/dislike"),Ju=S("generatedAnswer/feedbackModal/open"),$s=S("generatedAnswer/expand"),Xu=S("generatedAnswer/collapse"),Zu=S("generatedAnswer/setId",e=>F(e,{id:new Wu({required:!0})})),el=S("generatedAnswer/feedbackModal/close"),Mo=S("generatedAnswer/sendFeedback"),Ls=S("generatedAnswer/setIsLoading",e=>F(e,Vo)),zu=S("generatedAnswer/setIsStreaming",e=>F(e,Vo)),Gs=S("generatedAnswer/setAnswerContentFormat",e=>F(e,jC)),tl=S("generatedAnswer/updateResponseFormat",e=>F(e,{contentFormat:new qC({each:jC,default:["text/plain"]})})),rl=S("knowledge/updateAnswerConfigurationId",e=>F(e,jo)),nl=S("generatedAnswer/registerFieldsToIncludeInCitations",e=>F(e,Dc)),Ef=S("generatedAnswer/setIsAnswerGenerated",e=>F(e,Vo)),ia=S("generatedAnswer/setCannotAnswer",e=>F(e,Vo)),VC=G("generatedAnswer/streamAnswer",async(e,t)=>{let r=t.getState(),{dispatch:n,extra:a,getState:o}=t,{search:i}=o(),{queryExecuted:s}=i,{setAbortControllerRef:c}=e,u=await TC(r),l=(d,f)=>{switch(d){case"genqa.headerMessageType":{let C=JSON.parse(f);n(Gs(C.contentFormat));break}case"genqa.messageType":n(Bs(JSON.parse(f)));break;case"genqa.citationsType":n(_s(JSON.parse(f)));break;case"genqa.endOfStreamType":{let C=JSON.parse(f).answerGenerated,g=s.length!==0&&!C;n(ia(g)),n(zu(!1)),n(Ef(C)),n(Ms(C));break}default:r.debug&&a.logger.warn(`Unknown payloadType: "${d}"`)}};n(Ls(!0));let p=d=>d.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,m=a.streamingClient?.streamGeneratedAnswer(u,{write:d=>{p(u)&&(n(Ls(!1)),d.payload&&d.payloadType&&l(d.payloadType,d.payload))},abort:d=>{p(u)&&n(Pf(d))},close:()=>{p(u)&&n(zu(!1))},resetAnswer:()=>{p(u)&&n(It())}});m?c(m):n(Ls(!1))});var NC=Y(e=>e.pipeline,e=>e);var If=Y(e=>e.query,e=>e);var MC=Y(e=>e.searchHub,e=>e);var He=Y(e=>e,e=>{if(!e)return"";for(let t in e)if(e[t].isActive)return e[t].id;return""}),QC=Y(e=>e,e=>{let t=He(e);return t&&e?e[t].expression:""});function LC(e){return{status:e,isUninitialized:e==="uninitialized",isLoading:e==="pending",isSuccess:e==="fulfilled",isError:e==="rejected"}}var UC=Vt;function ZC(e,t){if(e===t||!(UC(e)&&UC(t)||Array.isArray(e)&&Array.isArray(t)))return t;let r=Object.keys(t),n=Object.keys(e),a=r.length===n.length,o=Array.isArray(t)?[]:{};for(let i of r)o[i]=ZC(e[i],t[i]),a&&(a=e[i]===o[i]);return a?e:o}function Qo(e){let t=0;for(let r in e)t++;return t}var BC=e=>[].concat(...e);function fT(e){return new RegExp("(^|:)//").test(e)}function gT(){return typeof document>"u"?!0:document.visibilityState!=="hidden"}function il(e){return e!=null}function yT(){return typeof navigator>"u"||navigator.onLine===void 0?!0:navigator.onLine}var hT=e=>e.replace(/\/$/,""),ST=e=>e.replace(/^\//,"");function CT(e,t){if(!e)return t;if(!t)return e;if(fT(t))return t;let r=e.endsWith("/")||!t.startsWith("?")?"/":"";return e=hT(e),t=ST(t),`${e}${r}${t}`}function xT(e,t,r){return e.has(t)?e.get(t):e.set(t,r).get(t)}var _C=(...e)=>fetch(...e),AT=e=>e.status>=200&&e.status<=299,FT=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function $C(e){if(!Vt(e))return e;let t={...e};for(let[r,n]of Object.entries(t))n===void 0&&delete t[r];return t}function ex({baseUrl:e,prepareHeaders:t=p=>p,fetchFn:r=_C,paramsSerializer:n,isJsonContentType:a=FT,jsonContentType:o="application/json",jsonReplacer:i,timeout:s,responseHandler:c,validateStatus:u,...l}={}){return typeof fetch>"u"&&r===_C&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(m,d,f)=>{let{getState:C,extra:g,endpoint:y,forced:x,type:h}=d,A,{url:E,headers:v=new Headers(l.headers),params:R=void 0,responseHandler:b=c??"json",validateStatus:w=u??AT,timeout:k=s,...L}=typeof m=="string"?{url:m}:m,D,O=d.signal;k&&(D=new AbortController,d.signal.addEventListener("abort",D.abort),O=D.signal);let T={...l,signal:O,...L};v=new Headers($C(v)),T.headers=await t(v,{getState:C,arg:m,extra:g,endpoint:y,forced:x,type:h,extraOptions:f})||v;let M=J=>typeof J=="object"&&(Vt(J)||Array.isArray(J)||typeof J.toJSON=="function");if(!T.headers.has("content-type")&&M(T.body)&&T.headers.set("content-type",o),M(T.body)&&a(T.headers)&&(T.body=JSON.stringify(T.body,i)),R){let J=~E.indexOf("?")?"&":"?",re=n?n(R):new URLSearchParams($C(R));E+=J+re}E=CT(e,E);let q=new Request(E,T);A={request:new Request(E,T)};let B,z=!1,ee=D&&setTimeout(()=>{z=!0,D.abort()},k);try{B=await r(q)}catch(J){return{error:{status:z?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(J)},meta:A}}finally{ee&&clearTimeout(ee),D?.signal.removeEventListener("abort",D.abort)}let ae=B.clone();A.response=ae;let X,te="";try{let J;if(await Promise.all([p(B,b).then(re=>X=re,re=>J=re),ae.text().then(re=>te=re,()=>{})]),J)throw J}catch(J){return{error:{status:"PARSING_ERROR",originalStatus:B.status,data:te,error:String(J)},meta:A}}return w(B,X)?{data:X,meta:A}:{error:{status:B.status,data:X},meta:A}};async function p(m,d){if(typeof d=="function")return d(m);if(d==="content-type"&&(d=a(m.headers)?"json":"text"),d==="json"){let f=await m.text();return f.length?JSON.parse(f):null}return m.text()}}var Lo=class{constructor(e,t=void 0){this.value=e,this.meta=t}};async function RT(e=0,t=5){let r=Math.min(e,t),n=~~((Math.random()+.4)*(300<<r));await new Promise(a=>setTimeout(o=>a(o),n))}function bT(e,t){throw Object.assign(new Lo({error:e,meta:t}),{throwImmediately:!0})}var GC={},vT=(e,t)=>async(r,n,a)=>{let o=[5,(t||GC).maxRetries,(a||GC).maxRetries].filter(l=>l!==void 0),[i]=o.slice(-1),c={maxRetries:i,backoff:RT,retryCondition:(l,p,{attempt:m})=>m<=i,...t,...a},u=0;for(;;)try{let l=await e(r,n,a);if(l.error)throw new Lo(l);return l}catch(l){if(u++,l.throwImmediately){if(l instanceof Lo)return l.value;throw l}if(l instanceof Lo&&!c.retryCondition(l.value.error,r,{attempt:u,baseQueryApi:n,extraOptions:a}))return l.value;await c.backoff(u,c.maxRetries)}},tx=Object.assign(vT,{fail:bT}),Df=S("__rtkq/focused"),rx=S("__rtkq/unfocused"),jf=S("__rtkq/online"),nx=S("__rtkq/offline");function Vf(e){return e.type==="query"}function wT(e){return e.type==="mutation"}function Nf(e){return e.type==="infinitequery"}function Mf(e,t,r,n,a,o){return PT(e)?e(t,r,n,a).filter(il).map(Tf).map(o):Array.isArray(e)?e.map(Tf).map(o):[]}function PT(e){return typeof e=="function"}function Tf(e){return typeof e=="string"?{type:e}:e}function ET(e,t){return e.catch(t)}var zs=Symbol("forceQueryFn"),Of=e=>typeof e[zs]=="function";function IT({serializeQueryArgs:e,queryThunk:t,infiniteQueryThunk:r,mutationThunk:n,api:a,context:o}){let i=new Map,s=new Map,{unsubscribeQueryResult:c,removeMutationResult:u,updateSubscriptionOptions:l}=a.internalActions;return{buildInitiateQuery:y,buildInitiateInfiniteQuery:x,buildInitiateMutation:h,getRunningQueryThunk:p,getRunningMutationThunk:m,getRunningQueriesThunk:d,getRunningMutationsThunk:f};function p(A,E){return v=>{let R=o.endpointDefinitions[A],b=e({queryArgs:E,endpointDefinition:R,endpointName:A});return i.get(v)?.[b]}}function m(A,E){return v=>s.get(v)?.[E]}function d(){return A=>Object.values(i.get(A)||{}).filter(il)}function f(){return A=>Object.values(s.get(A)||{}).filter(il)}function C(A){}function g(A,E){let v=(R,{subscribe:b=!0,forceRefetch:w,subscriptionOptions:k,[zs]:L,...D}={})=>(O,T)=>{let M=e({queryArgs:R,endpointDefinition:E,endpointName:A}),q,U={...D,type:"query",subscribe:b,forceRefetch:w,subscriptionOptions:k,endpointName:A,originalArgs:R,queryCacheKey:M,[zs]:L};if(Vf(E))q=t(U);else{let{direction:se,initialPageParam:ye}=D;q=r({...U,direction:se,initialPageParam:ye})}let B=a.endpoints[A].select(R),z=O(q),ee=B(T());let{requestId:ae,abort:X}=z,te=ee.requestId!==ae,J=i.get(O)?.[M],re=()=>B(T()),he=Object.assign(L?z.then(re):te&&!J?Promise.resolve(ee):Promise.all([J,z]).then(re),{arg:R,requestId:ae,subscriptionOptions:k,queryCacheKey:M,abort:X,async unwrap(){let se=await he;if(se.isError)throw se.error;return se.data},refetch:()=>O(v(R,{subscribe:!1,forceRefetch:!0})),unsubscribe(){b&&O(c({queryCacheKey:M,requestId:ae}))},updateSubscriptionOptions(se){he.subscriptionOptions=se,O(l({endpointName:A,requestId:ae,queryCacheKey:M,options:se}))}});if(!J&&!te&&!L){let se=xT(i,O,{});se[M]=he,he.then(()=>{delete se[M],Qo(se)||i.delete(O)})}return he};return v}function y(A,E){return g(A,E)}function x(A,E){return g(A,E)}function h(A){return(E,{track:v=!0,fixedCacheKey:R}={})=>(b,w)=>{let k=n({type:"mutation",endpointName:A,originalArgs:E,track:v,fixedCacheKey:R}),L=b(k);let{requestId:D,abort:O,unwrap:T}=L,M=ET(L.unwrap().then(z=>({data:z})),z=>({error:z})),q=()=>{b(u({requestId:D,fixedCacheKey:R}))},U=Object.assign(M,{arg:L.arg,requestId:D,abort:O,unwrap:T,reset:q}),B=s.get(b)||{};return s.set(b,B),B[D]=U,U.then(()=>{delete B[D],Qo(B)||s.delete(b)}),R&&(B[R]=U,U.then(()=>{B[R]===U&&(delete B[R],Qo(B)||s.delete(b))})),U}}}function kT(e){return e}var al=(e={})=>({...e,[fs]:!0});function TT({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:n,api:a,assertTagType:o,selectors:i}){let s=(b,w,k,L)=>(D,O)=>{let T=r[b],M=n({queryArgs:w,endpointDefinition:T,endpointName:b});if(D(a.internalActions.queryResultPatched({queryCacheKey:M,patches:k})),!L)return;let q=a.endpoints[b].select(w)(O()),U=Mf(T.providesTags,q.data,void 0,w,{},o);D(a.internalActions.updateProvidedBy({queryCacheKey:M,providedTags:U}))};function c(b,w,k=0){let L=[w,...b];return k&&L.length>k?L.slice(0,-1):L}function u(b,w,k=0){let L=[...b,w];return k&&L.length>k?L.slice(1):L}let l=(b,w,k,L=!0)=>(D,O)=>{let M=a.endpoints[b].select(w)(O()),q={patches:[],inversePatches:[],undo:()=>D(a.util.patchQueryData(b,w,q.inversePatches,L))};if(M.status==="uninitialized")return q;let U;if("data"in M)if(Ye(M.data)){let[B,z,ee]=Bc(M.data,k);q.patches.push(...z),q.inversePatches.push(...ee),U=B}else U=k(M.data),q.patches.push({op:"replace",path:[],value:U}),q.inversePatches.push({op:"replace",path:[],value:M.data});return q.patches.length===0||D(a.util.patchQueryData(b,w,q.patches,L)),q},p=(b,w,k)=>L=>L(a.endpoints[b].initiate(w,{subscribe:!1,forceRefetch:!0,[zs]:()=>({data:k})})),m=(b,w)=>b.query&&b[w]?b[w]:kT,d=async(b,{signal:w,abort:k,rejectWithValue:L,fulfillWithValue:D,dispatch:O,getState:T,extra:M})=>{let q=r[b.endpointName];try{let U=m(q,"transformResponse"),B={signal:w,abort:k,dispatch:O,getState:T,extra:M,endpoint:b.endpointName,type:b.type,forced:b.type==="query"?f(b,T()):void 0,queryCacheKey:b.type==="query"?b.queryCacheKey:void 0},z=b.type==="query"?b[zs]:void 0,ee,ae=async(te,J,re,he)=>{if(J==null&&te.pages.length)return Promise.resolve({data:te});let se={queryArg:b.originalArgs,pageParam:J},ye=await X(se),Ce=he?c:u;return{data:{pages:Ce(te.pages,ye.data,re),pageParams:Ce(te.pageParams,J,re)}}};async function X(te){let J,{extraOptions:re}=q;if(z?J=z():q.query?J=await t(q.query(te),B,re):J=await q.queryFn(te,B,re,se=>t(se,B,re)),typeof process<"u",J.error)throw new Lo(J.error,J.meta);let he=await U(J.data,J.meta,te);return{...J,data:he}}if(b.type==="query"&&"infiniteQueryOptions"in q){let{infiniteQueryOptions:te}=q,{maxPages:J=1/0}=te,re,he={pages:[],pageParams:[]},se=i.selectQueryEntry(T(),b.queryCacheKey)?.data,Ce=f(b,T())&&!b.direction||!se?he:se;if("direction"in b&&b.direction&&Ce.pages.length){let ze=b.direction==="backward",Lr=(ze?ax:qf)(te,Ce);re=await ae(Ce,Lr,J,ze)}else{let{initialPageParam:ze=te.initialPageParam}=b,it=se?.pageParams??[],Lr=it[0]??ze,Oa=it.length;re=await ae(Ce,Lr,J),z&&(re={data:re.data.pages[0]});for(let qa=1;qa<Oa;qa++){let es=qf(te,re.data);re=await ae(re.data,es,J)}}ee=re}else ee=await X(b.originalArgs);return D(ee.data,al({fulfilledTimeStamp:Date.now(),baseQueryMeta:ee.meta}))}catch(U){let B=U;if(B instanceof Lo){let z=m(q,"transformErrorResponse");try{return L(await z(B.value,B.meta,b.originalArgs),al({baseQueryMeta:B.meta}))}catch(ee){B=ee}}throw typeof process<"u",console.error(B),B}};function f(b,w){let k=i.selectQueryEntry(w,b.queryCacheKey),L=i.selectConfig(w).refetchOnMountOrArgChange,D=k?.fulfilledTimeStamp,O=b.forceRefetch??(b.subscribe&&L);return O?O===!0||(Number(new Date)-Number(D))/1e3>=O:!1}let C=()=>G(`${e}/executeQuery`,d,{getPendingMeta({arg:w}){let k=r[w.endpointName];return al({startedTimeStamp:Date.now(),...Nf(k)?{direction:w.direction}:{}})},condition(w,{getState:k}){let L=k(),D=i.selectQueryEntry(L,w.queryCacheKey),O=D?.fulfilledTimeStamp,T=w.originalArgs,M=D?.originalArgs,q=r[w.endpointName],U=w.direction;return Of(w)?!0:D?.status==="pending"?!1:f(w,L)||Vf(q)&&q?.forceRefetch?.({currentArg:T,previousArg:M,endpointState:D,state:L})?!0:!(O&&!U)},dispatchConditionRejection:!0}),g=C(),y=C(),x=G(`${e}/executeMutation`,d,{getPendingMeta(){return al({startedTimeStamp:Date.now()})}}),h=b=>"force"in b,A=b=>"ifOlderThan"in b,E=(b,w,k)=>(L,D)=>{let O=h(k)&&k.force,T=A(k)&&k.ifOlderThan,M=(U=!0)=>{let B={forceRefetch:U,isPrefetch:!0};return a.endpoints[b].initiate(w,B)},q=a.endpoints[b].select(w)(D());if(O)L(M());else if(T){let U=q?.fulfilledTimeStamp;if(!U){L(M());return}(Number(new Date)-Number(new Date(U)))/1e3>=T&&L(M())}else L(M(!1))};function v(b){return w=>w?.meta?.arg?.endpointName===b}function R(b,w){return{matchPending:Ba(Hc(b),v(w)),matchFulfilled:Ba(br(b),v(w)),matchRejected:Ba(Kn(b),v(w))}}return{queryThunk:g,mutationThunk:x,infiniteQueryThunk:y,prefetch:E,updateQueryData:l,upsertQueryData:p,patchQueryData:s,buildMatchThunkActions:R}}function qf(e,{pages:t,pageParams:r}){let n=t.length-1;return e.getNextPageParam(t[n],t,r[n],r)}function ax(e,{pages:t,pageParams:r}){return e.getPreviousPageParam?.(t[0],t,r[0],r)}function ox(e,t,r,n){return Mf(r[e.meta.arg.endpointName][t],br(e)?e.payload:void 0,ys(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,n)}function ol(e,t,r){let n=e[t];n&&r(n)}function Ws(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function HC(e,t,r){let n=e[Ws(t)];n&&r(n)}var Hs={};function OT({reducerPath:e,queryThunk:t,mutationThunk:r,serializeQueryArgs:n,context:{endpointDefinitions:a,apiUid:o,extractRehydrationInfo:i,hasRehydrationInfo:s},assertTagType:c,config:u}){let l=S(`${e}/resetApiState`);function p(v,R,b,w){var k;v[k=R.queryCacheKey]??(v[k]={status:"uninitialized",endpointName:R.endpointName}),ol(v,R.queryCacheKey,L=>{L.status="pending",L.requestId=b&&L.requestId?L.requestId:w.requestId,R.originalArgs!==void 0&&(L.originalArgs=R.originalArgs),L.startedTimeStamp=w.startedTimeStamp;let D=a[w.arg.endpointName];Nf(D)&&"direction"in R&&(L.direction=R.direction)})}function m(v,R,b,w){ol(v,R.arg.queryCacheKey,k=>{if(k.requestId!==R.requestId&&!w)return;let{merge:L}=a[R.arg.endpointName];if(k.status="fulfilled",L)if(k.data!==void 0){let{fulfilledTimeStamp:D,arg:O,baseQueryMeta:T,requestId:M}=R,q=Rr(k.data,U=>L(U,b,{arg:O.originalArgs,baseQueryMeta:T,fulfilledTimeStamp:D,requestId:M}));k.data=q}else k.data=b;else k.data=a[R.arg.endpointName].structuralSharing??!0?ZC(rt(k.data)?sm(k.data):k.data,b):b;delete k.error,k.fulfilledTimeStamp=R.fulfilledTimeStamp})}let d=Jn({name:`${e}/queries`,initialState:Hs,reducers:{removeQueryResult:{reducer(v,{payload:{queryCacheKey:R}}){delete v[R]},prepare:_a()},cacheEntriesUpserted:{reducer(v,R){for(let b of R.payload){let{queryDescription:w,value:k}=b;p(v,w,!0,{arg:w,requestId:R.meta.requestId,startedTimeStamp:R.meta.timestamp}),m(v,{arg:w,requestId:R.meta.requestId,fulfilledTimeStamp:R.meta.timestamp,baseQueryMeta:{}},k,!0)}},prepare:v=>({payload:v.map(w=>{let{endpointName:k,arg:L,value:D}=w,O=a[k];return{queryDescription:{type:"query",endpointName:k,originalArgs:w.arg,queryCacheKey:n({queryArgs:L,endpointDefinition:O,endpointName:k})},value:D}}),meta:{[fs]:!0,requestId:Wc(),timestamp:Date.now()}})},queryResultPatched:{reducer(v,{payload:{queryCacheKey:R,patches:b}}){ol(v,R,w=>{w.data=um(w.data,b.concat())})},prepare:_a()}},extraReducers(v){v.addCase(t.pending,(R,{meta:b,meta:{arg:w}})=>{let k=Of(w);p(R,w,k,b)}).addCase(t.fulfilled,(R,{meta:b,payload:w})=>{let k=Of(b.arg);m(R,b,w,k)}).addCase(t.rejected,(R,{meta:{condition:b,arg:w,requestId:k},error:L,payload:D})=>{ol(R,w.queryCacheKey,O=>{if(!b){if(O.requestId!==k)return;O.status="rejected",O.error=D??L}})}).addMatcher(s,(R,b)=>{let{queries:w}=i(b);for(let[k,L]of Object.entries(w))(L?.status==="fulfilled"||L?.status==="rejected")&&(R[k]=L)})}}),f=Jn({name:`${e}/mutations`,initialState:Hs,reducers:{removeMutationResult:{reducer(v,{payload:R}){let b=Ws(R);b in v&&delete v[b]},prepare:_a()}},extraReducers(v){v.addCase(r.pending,(R,{meta:b,meta:{requestId:w,arg:k,startedTimeStamp:L}})=>{k.track&&(R[Ws(b)]={requestId:w,status:"pending",endpointName:k.endpointName,startedTimeStamp:L})}).addCase(r.fulfilled,(R,{payload:b,meta:w})=>{w.arg.track&&HC(R,w,k=>{k.requestId===w.requestId&&(k.status="fulfilled",k.data=b,k.fulfilledTimeStamp=w.fulfilledTimeStamp)})}).addCase(r.rejected,(R,{payload:b,error:w,meta:k})=>{k.arg.track&&HC(R,k,L=>{L.requestId===k.requestId&&(L.status="rejected",L.error=b??w)})}).addMatcher(s,(R,b)=>{let{mutations:w}=i(b);for(let[k,L]of Object.entries(w))(L?.status==="fulfilled"||L?.status==="rejected")&&k!==L?.requestId&&(R[k]=L)})}}),C=Jn({name:`${e}/invalidation`,initialState:Hs,reducers:{updateProvidedBy:{reducer(v,R){var k,L;let{queryCacheKey:b,providedTags:w}=R.payload;for(let D of Object.values(v))for(let O of Object.values(D)){let T=O.indexOf(b);T!==-1&&O.splice(T,1)}for(let{type:D,id:O}of w){let T=(k=v[D]??(v[D]={}))[L=O||"__internal_without_id"]??(k[L]=[]);T.includes(b)||T.push(b)}},prepare:_a()}},extraReducers(v){v.addCase(d.actions.removeQueryResult,(R,{payload:{queryCacheKey:b}})=>{for(let w of Object.values(R))for(let k of Object.values(w)){let L=k.indexOf(b);L!==-1&&k.splice(L,1)}}).addMatcher(s,(R,b)=>{var k,L;let{provided:w}=i(b);for(let[D,O]of Object.entries(w))for(let[T,M]of Object.entries(O)){let q=(k=R[D]??(R[D]={}))[L=T||"__internal_without_id"]??(k[L]=[]);for(let U of M)q.includes(U)||q.push(U)}}).addMatcher(Nt(br(t),ys(t)),(R,b)=>{let w=ox(b,"providesTags",a,c),{queryCacheKey:k}=b.meta.arg;C.caseReducers.updateProvidedBy(R,C.actions.updateProvidedBy({queryCacheKey:k,providedTags:w}))})}}),g=Jn({name:`${e}/subscriptions`,initialState:Hs,reducers:{updateSubscriptionOptions(v,R){},unsubscribeQueryResult(v,R){},internal_getRTKQSubscriptions(){}}}),y=Jn({name:`${e}/internalSubscriptions`,initialState:Hs,reducers:{subscriptionsUpdated:{reducer(v,R){return um(v,R.payload)},prepare:_a()}}}),x=Jn({name:`${e}/config`,initialState:{online:yT(),focused:gT(),middlewareRegistered:!1,...u},reducers:{middlewareRegistered(v,{payload:R}){v.middlewareRegistered=v.middlewareRegistered==="conflict"||o!==R?"conflict":!0}},extraReducers:v=>{v.addCase(jf,R=>{R.online=!0}).addCase(nx,R=>{R.online=!1}).addCase(Df,R=>{R.focused=!0}).addCase(rx,R=>{R.focused=!1}).addMatcher(s,R=>({...R}))}}),h=Ma({queries:d.reducer,mutations:f.reducer,provided:C.reducer,subscriptions:y.reducer,config:x.reducer}),A=(v,R)=>h(l.match(R)?void 0:v,R),E={...x.actions,...d.actions,...g.actions,...y.actions,...f.actions,...C.actions,resetApiState:l};return{reducer:A,actions:E}}var kf=Symbol.for("RTKQ/skipToken"),ix={status:"uninitialized"},zC=Rr(ix,()=>{}),WC=Rr(ix,()=>{});function qT({serializeQueryArgs:e,reducerPath:t,createSelector:r}){let n=h=>zC,a=h=>WC;return{buildQuerySelector:m,buildInfiniteQuerySelector:d,buildMutationSelector:f,selectInvalidatedBy:C,selectCachedArgsForQuery:g,selectApiState:i,selectQueries:s,selectMutations:u,selectQueryEntry:c,selectConfig:l};function o(h){return{...h,...LC(h.status)}}function i(h){return h[t]}function s(h){return i(h)?.queries}function c(h,A){return s(h)?.[A]}function u(h){return i(h)?.mutations}function l(h){return i(h)?.config}function p(h,A,E){return v=>{if(v===kf)return r(n,E);let R=e({queryArgs:v,endpointDefinition:A,endpointName:h});return r(w=>c(w,R)??zC,E)}}function m(h,A){return p(h,A,o)}function d(h,A){let{infiniteQueryOptions:E}=A;function v(R){let b={...R,...LC(R.status)},{isLoading:w,isError:k,direction:L}=b,D=L==="forward",O=L==="backward";return{...b,hasNextPage:y(E,b.data),hasPreviousPage:x(E,b.data),isFetchingNextPage:w&&D,isFetchingPreviousPage:w&&O,isFetchNextPageError:k&&D,isFetchPreviousPageError:k&&O}}return p(h,A,v)}function f(){return h=>{let A;return typeof h=="object"?A=Ws(h)??kf:A=h,r(A===kf?a:R=>i(R)?.mutations?.[A]??WC,o)}}function C(h,A){let E=h[t],v=new Set;for(let R of A.filter(il).map(Tf)){let b=E.provided[R.type];if(!b)continue;let w=(R.id!==void 0?b[R.id]:BC(Object.values(b)))??[];for(let k of w)v.add(k)}return BC(Array.from(v.values()).map(R=>{let b=E.queries[R];return b?[{queryCacheKey:R,endpointName:b.endpointName,originalArgs:b.originalArgs}]:[]}))}function g(h,A){return Object.values(s(h)).filter(E=>E?.endpointName===A&&E.status!=="uninitialized").map(E=>E.originalArgs)}function y(h,A){return A?qf(h,A)!=null:!1}function x(h,A){return!A||!h.getPreviousPageParam?!1:ax(h,A)!=null}}var YC=WeakMap?new WeakMap:void 0,KC=({endpointName:e,queryArgs:t})=>{let r="",n=YC?.get(t);if(typeof n=="string")r=n;else{let a=JSON.stringify(t,(o,i)=>(i=typeof i=="bigint"?{$bigint:i.toString()}:i,i=Vt(i)?Object.keys(i).sort().reduce((s,c)=>(s[c]=i[c],s),{}):i,i));Vt(t)&&YC?.set(t,a),r=a}return`${e}(${r})`};function DT(...e){return function(r){let n=Ua(u=>r.extractRehydrationInfo?.(u,{reducerPath:r.reducerPath??"api"})),a={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...r,extractRehydrationInfo:n,serializeQueryArgs(u){let l=KC;if("serializeQueryArgs"in u.endpointDefinition){let p=u.endpointDefinition.serializeQueryArgs;l=m=>{let d=p(m);return typeof d=="string"?d:KC({...m,queryArgs:d})}}else r.serializeQueryArgs&&(l=r.serializeQueryArgs);return l(u)},tagTypes:[...r.tagTypes||[]]},o={endpointDefinitions:{},batch(u){u()},apiUid:Wc(),extractRehydrationInfo:n,hasRehydrationInfo:Ua(u=>n(u)!=null)},i={injectEndpoints:c,enhanceEndpoints({addTagTypes:u,endpoints:l}){if(u)for(let p of u)a.tagTypes.includes(p)||a.tagTypes.push(p);if(l)for(let[p,m]of Object.entries(l))typeof m=="function"?m(o.endpointDefinitions[p]):Object.assign(o.endpointDefinitions[p]||{},m);return i}},s=e.map(u=>u.init(i,a,o));function c(u){let l=u.endpoints({query:p=>({...p,type:"query"}),mutation:p=>({...p,type:"mutation"}),infiniteQuery:p=>({...p,type:"infinitequery"})});for(let[p,m]of Object.entries(l)){if(u.overrideExisting!==!0&&p in o.endpointDefinitions){if(u.overrideExisting==="throw")throw new Error(bt(39));typeof process<"u";continue}typeof process<"u",o.endpointDefinitions[p]=m;for(let d of s)d.injectEndpoint(p,m)}return i}return i.injectEndpoints({endpoints:r.endpoints})}}function Ir(e,...t){return Object.assign(e,...t)}var jT=({api:e,queryThunk:t,internalState:r})=>{let n=`${e.reducerPath}/subscriptions`,a=null,o=null,{updateSubscriptionOptions:i,unsubscribeQueryResult:s}=e.internalActions,c=(d,f)=>{var g,y;if(i.match(f)){let{queryCacheKey:x,requestId:h,options:A}=f.payload;return d?.[x]?.[h]&&(d[x][h]=A),!0}if(s.match(f)){let{queryCacheKey:x,requestId:h}=f.payload;return d[x]&&delete d[x][h],!0}if(e.internalActions.removeQueryResult.match(f))return delete d[f.payload.queryCacheKey],!0;if(t.pending.match(f)){let{meta:{arg:x,requestId:h}}=f,A=d[g=x.queryCacheKey]??(d[g]={});return A[`${h}_running`]={},x.subscribe&&(A[h]=x.subscriptionOptions??A[h]??{}),!0}let C=!1;if(t.fulfilled.match(f)||t.rejected.match(f)){let x=d[f.meta.arg.queryCacheKey]||{},h=`${f.meta.requestId}_running`;C||(C=!!x[h]),delete x[h]}if(t.rejected.match(f)){let{meta:{condition:x,arg:h,requestId:A}}=f;if(x&&h.subscribe){let E=d[y=h.queryCacheKey]??(d[y]={});E[A]=h.subscriptionOptions??E[A]??{},C=!0}}return C},u=()=>r.currentSubscriptions,m={getSubscriptions:u,getSubscriptionCount:d=>{let C=u()[d]??{};return Qo(C)},isRequestSubscribed:(d,f)=>!!u()?.[d]?.[f]};return(d,f)=>{if(a||(a=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(d))return a=r.currentSubscriptions={},o=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(d))return[!1,m];let C=c(r.currentSubscriptions,d),g=!0;if(C){o||(o=setTimeout(()=>{let h=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,A]=Bc(a,()=>h);f.next(e.internalActions.subscriptionsUpdated(A)),a=h,o=null},500));let y=typeof d.type=="string"&&!!d.type.startsWith(n),x=t.rejected.match(d)&&d.meta.condition&&!!d.meta.arg.subscribe;g=!y&&!x}return[g,!1]}};function VT(e){for(let t in e)return!1;return!0}var NT=2147483647/1e3-1,MT=({reducerPath:e,api:t,queryThunk:r,context:n,internalState:a,selectors:{selectQueryEntry:o,selectConfig:i}})=>{let{removeQueryResult:s,unsubscribeQueryResult:c,cacheEntriesUpserted:u}=t.internalActions,l=Nt(c.match,r.fulfilled,r.rejected,u.match);function p(g){let y=a.currentSubscriptions[g];return!!y&&!VT(y)}let m={},d=(g,y,x)=>{let h=y.getState(),A=i(h);if(l(g)){let E;if(u.match(g))E=g.payload.map(v=>v.queryDescription.queryCacheKey);else{let{queryCacheKey:v}=c.match(g)?g.payload:g.meta.arg;E=[v]}f(E,y,A)}if(t.util.resetApiState.match(g))for(let[E,v]of Object.entries(m))v&&clearTimeout(v),delete m[E];if(n.hasRehydrationInfo(g)){let{queries:E}=n.extractRehydrationInfo(g);f(Object.keys(E),y,A)}};function f(g,y,x){let h=y.getState();for(let A of g){let E=o(h,A);C(A,E?.endpointName,y,x)}}function C(g,y,x,h){let E=n.endpointDefinitions[y]?.keepUnusedDataFor??h.keepUnusedDataFor;if(E===1/0)return;let v=Math.max(0,Math.min(E,NT));if(!p(g)){let R=m[g];R&&clearTimeout(R),m[g]=setTimeout(()=>{p(g)||x.dispatch(s({queryCacheKey:g})),delete m[g]},v*1e3)}}return d},JC=new Error("Promise never resolved before cacheEntryRemoved."),QT=({api:e,reducerPath:t,context:r,queryThunk:n,mutationThunk:a,internalState:o,selectors:{selectQueryEntry:i,selectApiState:s}})=>{let c=zc(n),u=zc(a),l=br(n,a),p={};function m(y,x,h){let A=p[y];A?.valueResolved&&(A.valueResolved({data:x,meta:h}),delete A.valueResolved)}function d(y){let x=p[y];x&&(delete p[y],x.cacheEntryRemoved())}let f=(y,x,h)=>{let A=C(y);function E(v,R,b,w){let k=i(h,R),L=i(x.getState(),R);!k&&L&&g(v,w,R,x,b)}if(n.pending.match(y))E(y.meta.arg.endpointName,A,y.meta.requestId,y.meta.arg.originalArgs);else if(e.internalActions.cacheEntriesUpserted.match(y))for(let{queryDescription:v,value:R}of y.payload){let{endpointName:b,originalArgs:w,queryCacheKey:k}=v;E(b,k,y.meta.requestId,w),m(k,R,{})}else if(a.pending.match(y))x.getState()[t].mutations[A]&&g(y.meta.arg.endpointName,y.meta.arg.originalArgs,A,x,y.meta.requestId);else if(l(y))m(A,y.payload,y.meta.baseQueryMeta);else if(e.internalActions.removeQueryResult.match(y)||e.internalActions.removeMutationResult.match(y))d(A);else if(e.util.resetApiState.match(y))for(let v of Object.keys(p))d(v)};function C(y){return c(y)?y.meta.arg.queryCacheKey:u(y)?y.meta.arg.fixedCacheKey??y.meta.requestId:e.internalActions.removeQueryResult.match(y)?y.payload.queryCacheKey:e.internalActions.removeMutationResult.match(y)?Ws(y.payload):""}function g(y,x,h,A,E){let v=r.endpointDefinitions[y],R=v?.onCacheEntryAdded;if(!R)return;let b={},w=new Promise(M=>{b.cacheEntryRemoved=M}),k=Promise.race([new Promise(M=>{b.valueResolved=M}),w.then(()=>{throw JC})]);k.catch(()=>{}),p[h]=b;let L=e.endpoints[y].select(v.type==="query"?x:h),D=A.dispatch((M,q,U)=>U),O={...A,getCacheEntry:()=>L(A.getState()),requestId:E,extra:D,updateCachedData:v.type==="query"?M=>A.dispatch(e.util.updateQueryData(y,x,M)):void 0,cacheDataLoaded:k,cacheEntryRemoved:w},T=R(x,O);Promise.resolve(T).catch(M=>{if(M!==JC)throw M})}return f},LT=({api:e,context:{apiUid:t},reducerPath:r})=>(n,a)=>{e.util.resetApiState.match(n)&&a.dispatch(e.internalActions.middlewareRegistered(t)),typeof process<"u"},UT=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:n,queryThunk:a,api:o,assertTagType:i,refetchQuery:s,internalState:c})=>{let{removeQueryResult:u}=o.internalActions,l=Nt(br(n),ys(n)),p=Nt(br(n,a),Kn(n,a)),m=[],d=(g,y)=>{l(g)?C(ox(g,"invalidatesTags",r,i),y):p(g)?C([],y):o.util.invalidateTags.match(g)&&C(Mf(g.payload,void 0,void 0,void 0,void 0,i),y)};function f(g){let{queries:y,mutations:x}=g;for(let h of[y,x])for(let A in h)if(h[A]?.status==="pending")return!0;return!1}function C(g,y){let x=y.getState(),h=x[e];if(m.push(...g),h.config.invalidationBehavior==="delayed"&&f(h))return;let A=m;if(m=[],A.length===0)return;let E=o.util.selectInvalidatedBy(x,A);t.batch(()=>{let v=Array.from(E.values());for(let{queryCacheKey:R}of v){let b=h.queries[R],w=c.currentSubscriptions[R]??{};b&&(Qo(w)===0?y.dispatch(u({queryCacheKey:R})):b.status!=="uninitialized"&&y.dispatch(s(b)))}})}return d},BT=({reducerPath:e,queryThunk:t,api:r,refetchQuery:n,internalState:a})=>{let o={},i=(d,f)=>{(r.internalActions.updateSubscriptionOptions.match(d)||r.internalActions.unsubscribeQueryResult.match(d))&&u(d.payload,f),(t.pending.match(d)||t.rejected.match(d)&&d.meta.condition)&&u(d.meta.arg,f),(t.fulfilled.match(d)||t.rejected.match(d)&&!d.meta.condition)&&c(d.meta.arg,f),r.util.resetApiState.match(d)&&p()};function s(d,f){let g=f.getState()[e].queries[d],y=a.currentSubscriptions[d];if(!(!g||g.status==="uninitialized"))return y}function c({queryCacheKey:d},f){let C=f.getState()[e],g=C.queries[d],y=a.currentSubscriptions[d];if(!g||g.status==="uninitialized")return;let{lowestPollingInterval:x,skipPollingIfUnfocused:h}=m(y);if(!Number.isFinite(x))return;let A=o[d];A?.timeout&&(clearTimeout(A.timeout),A.timeout=void 0);let E=Date.now()+x;o[d]={nextPollTimestamp:E,pollingInterval:x,timeout:setTimeout(()=>{(C.config.focused||!h)&&f.dispatch(n(g)),c({queryCacheKey:d},f)},x)}}function u({queryCacheKey:d},f){let g=f.getState()[e].queries[d],y=a.currentSubscriptions[d];if(!g||g.status==="uninitialized")return;let{lowestPollingInterval:x}=m(y);if(!Number.isFinite(x)){l(d);return}let h=o[d],A=Date.now()+x;(!h||A<h.nextPollTimestamp)&&c({queryCacheKey:d},f)}function l(d){let f=o[d];f?.timeout&&clearTimeout(f.timeout),delete o[d]}function p(){for(let d of Object.keys(o))l(d)}function m(d={}){let f=!1,C=Number.POSITIVE_INFINITY;for(let g in d)d[g].pollingInterval&&(C=Math.min(d[g].pollingInterval,C),f=d[g].skipPollingIfUnfocused||f);return{lowestPollingInterval:C,skipPollingIfUnfocused:f}}return i},_T=({api:e,context:t,queryThunk:r,mutationThunk:n})=>{let a=Hc(r,n),o=Kn(r,n),i=br(r,n),s={};return(u,l)=>{if(a(u)){let{requestId:p,arg:{endpointName:m,originalArgs:d}}=u.meta,f=t.endpointDefinitions[m],C=f?.onQueryStarted;if(C){let g={},y=new Promise((E,v)=>{g.resolve=E,g.reject=v});y.catch(()=>{}),s[p]=g;let x=e.endpoints[m].select(f.type==="query"?d:p),h=l.dispatch((E,v,R)=>R),A={...l,getCacheEntry:()=>x(l.getState()),requestId:p,extra:h,updateCachedData:f.type==="query"?E=>l.dispatch(e.util.updateQueryData(m,d,E)):void 0,queryFulfilled:y};C(d,A)}}else if(i(u)){let{requestId:p,baseQueryMeta:m}=u.meta;s[p]?.resolve({data:u.payload,meta:m}),delete s[p]}else if(o(u)){let{requestId:p,rejectedWithValue:m,baseQueryMeta:d}=u.meta;s[p]?.reject({error:u.payload??u.error,isUnhandledError:!m,meta:d}),delete s[p]}}},$T=({reducerPath:e,context:t,api:r,refetchQuery:n,internalState:a})=>{let{removeQueryResult:o}=r.internalActions,i=(c,u)=>{Df.match(c)&&s(u,"refetchOnFocus"),jf.match(c)&&s(u,"refetchOnReconnect")};function s(c,u){let l=c.getState()[e],p=l.queries,m=a.currentSubscriptions;t.batch(()=>{for(let d of Object.keys(m)){let f=p[d],C=m[d];if(!C||!f)continue;(Object.values(C).some(y=>y[u]===!0)||Object.values(C).every(y=>y[u]===void 0)&&l.config[u])&&(Qo(C)===0?c.dispatch(o({queryCacheKey:d})):f.status!=="uninitialized"&&c.dispatch(n(f)))}})}return i};function GT(e){let{reducerPath:t,queryThunk:r,api:n,context:a}=e,{apiUid:o}=a,i={invalidateTags:S(`${t}/invalidateTags`)},s=p=>p.type.startsWith(`${t}/`),c=[LT,MT,UT,BT,QT,_T];return{middleware:p=>{let m=!1,f={...e,internalState:{currentSubscriptions:{}},refetchQuery:l,isThisApiSliceAction:s},C=c.map(x=>x(f)),g=jT(f),y=$T(f);return x=>h=>{if(!Vc(h))return x(h);m||(m=!0,p.dispatch(n.internalActions.middlewareRegistered(o)));let A={...p,next:x},E=p.getState(),[v,R]=g(h,A,E),b;if(v?b=x(h):b=R,p.getState()[t]&&(y(h,A,E),s(h)||a.hasRehydrationInfo(h)))for(let w of C)w(h,A,E);return b}},actions:i};function l(p){return e.api.endpoints[p.endpointName].initiate(p.originalArgs,{subscribe:!1,forceRefetch:!0})}}var XC=Symbol(),HT=({createSelector:e=Y}={})=>({name:XC,init(t,{baseQuery:r,tagTypes:n,reducerPath:a,serializeQueryArgs:o,keepUnusedDataFor:i,refetchOnMountOrArgChange:s,refetchOnFocus:c,refetchOnReconnect:u,invalidationBehavior:l},p){ch();let m=X=>(typeof process<"u",X);Object.assign(t,{reducerPath:a,endpoints:{},internalActions:{onOnline:jf,onOffline:nx,onFocus:Df,onFocusLost:rx},util:{}});let d=qT({serializeQueryArgs:o,reducerPath:a,createSelector:e}),{selectInvalidatedBy:f,selectCachedArgsForQuery:C,buildQuerySelector:g,buildInfiniteQuerySelector:y,buildMutationSelector:x}=d;Ir(t.util,{selectInvalidatedBy:f,selectCachedArgsForQuery:C});let{queryThunk:h,infiniteQueryThunk:A,mutationThunk:E,patchQueryData:v,updateQueryData:R,upsertQueryData:b,prefetch:w,buildMatchThunkActions:k}=TT({baseQuery:r,reducerPath:a,context:p,api:t,serializeQueryArgs:o,assertTagType:m,selectors:d}),{reducer:L,actions:D}=OT({context:p,queryThunk:h,infiniteQueryThunk:A,mutationThunk:E,serializeQueryArgs:o,reducerPath:a,assertTagType:m,config:{refetchOnFocus:c,refetchOnReconnect:u,refetchOnMountOrArgChange:s,keepUnusedDataFor:i,reducerPath:a,invalidationBehavior:l}});Ir(t.util,{patchQueryData:v,updateQueryData:R,upsertQueryData:b,prefetch:w,resetApiState:D.resetApiState,upsertQueryEntries:D.cacheEntriesUpserted}),Ir(t.internalActions,D);let{middleware:O,actions:T}=GT({reducerPath:a,context:p,queryThunk:h,mutationThunk:E,infiniteQueryThunk:A,api:t,assertTagType:m,selectors:d});Ir(t.util,T),Ir(t,{reducer:L,middleware:O});let{buildInitiateQuery:M,buildInitiateInfiniteQuery:q,buildInitiateMutation:U,getRunningMutationThunk:B,getRunningMutationsThunk:z,getRunningQueriesThunk:ee,getRunningQueryThunk:ae}=IT({queryThunk:h,mutationThunk:E,infiniteQueryThunk:A,api:t,serializeQueryArgs:o,context:p});return Ir(t.util,{getRunningMutationThunk:B,getRunningMutationsThunk:z,getRunningQueryThunk:ae,getRunningQueriesThunk:ee}),{name:XC,injectEndpoint(X,te){var he;let re=(he=t.endpoints)[X]??(he[X]={});Vf(te)&&Ir(re,{name:X,select:g(X,te),initiate:M(X,te)},k(h,X)),wT(te)&&Ir(re,{name:X,select:x(),initiate:U(X)},k(E,X)),Nf(te)&&Ir(re,{name:X,select:y(X,te),initiate:q(X,te)},k(h,X))}}}}),sx=DT(HT());var zT=async(e,t,r)=>{let n=t.getState(),{accessToken:a,environment:o,organizationId:i}=n.configuration,s=n.generatedAnswer.answerConfigurationId,c={...e,headers:{...e?.headers||{},Authorization:`Bearer ${a}`}};try{let u=Me(i,o);return{data:ex({baseUrl:`${u}/rest/organizations/${i}/answer/v1/configs/${s}`})(c,t,r)}}catch(u){return{error:u}}},sl=sx({reducerPath:"answer",baseQuery:tx(zT,{maxRetries:3}),endpoints:()=>({})});var WT=(e,t)=>{let{contentFormat:r}=t;e.contentFormat=r,e.isStreaming=!0,e.isLoading=!1},YT=(e,t)=>{e.answer===void 0?e.answer=t.textDelta:typeof t.textDelta=="string"&&(e.answer=e.answer.concat(t.textDelta))},KT=(e,t)=>{e.citations=t.citations},JT=(e,t)=>{e.generated=t.answerGenerated,e.isStreaming=!1},XT=(e,t)=>{e.error={message:t.errorMessage,code:t.code},e.isStreaming=!1,e.isLoading=!1,console.error(`${t.errorMessage} - code ${t.code}`)},ZT=(e,t,r)=>{let n=JSON.parse(e.data);n.finishReason==="ERROR"&&n.errorMessage&&XT(t,n);let a=n.payload.length?JSON.parse(n.payload):{};switch(n.payloadType){case"genqa.headerMessageType":a.contentFormat&&(WT(t,a),r(Gs(a.contentFormat)));break;case"genqa.messageType":a.textDelta&&(YT(t,a),r(Bs({textDelta:a.textDelta})));break;case"genqa.citationsType":a.citations&&(KT(t,a),r(_s({citations:a.citations})));break;case"genqa.endOfStreamType":JT(t,a),r(Ms(a.answerGenerated??!1));break}},sa=sl.injectEndpoints({overrideExisting:!0,endpoints:e=>({getAnswer:e.query({queryFn:()=>({data:{contentFormat:void 0,answer:void 0,citations:void 0,error:void 0,generated:!1,isStreaming:!0,isLoading:!0}}),serializeQueryArgs:({endpointName:t,queryArgs:r})=>{let{analytics:n,...a}=r;return`${t}(${JSON.stringify(a)})`},async onCacheEntryAdded(t,{getState:r,cacheDataLoaded:n,updateCachedData:a,dispatch:o}){await n;let{configuration:i,generatedAnswer:s,insightConfiguration:c}=r(),{organizationId:u,environment:l,accessToken:p}=i,m=Me(u,l),d=`${m}/rest/organizations/${u}/insight/v1/configs/${c?.insightId}/answer/${s.answerConfigurationId}/generate`,f=`${m}/rest/organizations/${u}/answer/v1/configs/${s.answerConfigurationId}/generate`;await Ec(c?d:f,{method:"POST",body:JSON.stringify(t),headers:{Authorization:`Bearer ${p}`,Accept:"application/json","Content-Type":"application/json","Accept-Encoding":"*"},fetch,onopen:async C=>{let g=C.headers.get("x-answer-id");g&&a(y=>{y.answerId=g})},onmessage:C=>{a(g=>{ZT(C,g,o)})},onerror:C=>{throw C},onclose:()=>{a(C=>{o(ia(!C.generated))})}})}})})}),cx=Y(e=>If(e)?.q,e=>e.search.requestId,e=>e.generatedAnswer.cannotAnswer,e=>e.configuration.analytics.analyticsMode,e=>e.search.searchAction?.actionCause,(e,t,r,n,a)=>({q:e,requestId:t,cannotAnswer:r,analyticsMode:n,actionCause:a})),cl={},eO=(e,t)=>({...cl,[e]:Uu(t)?.map(r=>gf(r,ff())).sort((r,n)=>r.facetId>n.facetId?1:n.facetId>r.facetId?-1:0)}),tO=e=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,rO=e=>{let t=wf(e),r=nO(e);return{...t,...r&&{cq:r}}},nO=e=>{let t=QC(e.tabSet),r=$u(e),{cq:n}=wf(e);return[t,...r,n].filter(a=>!!a).join(" AND ")},ux=(e,t,r)=>{let n=If(e)?.q,{aq:a,cq:o,dq:i,lq:s}=rO(e),c=kC(e),u=t==="select"?{}:tn(e.configuration.analytics,r,{actionCause:EC(e)}),l=MC(e),p=NC(e),m=FS(e)??[];return n&&t==="fetch"&&(cl=eO(n,e)),{q:n,...a&&{aq:a},...o&&{cq:o},...i&&{dq:i},...s&&{lq:s},...e.query&&{enableQuerySyntax:e.query.enableQuerySyntax},...c?.contextValues&&{context:c.contextValues},pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:m}},...l?.length&&{searchHub:l},...p?.length&&{pipeline:p},...cl[n]?.length&&{facets:cl[n]},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="next",options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&e.didYouMean.queryCorrectionMode==="legacy"},...e.pagination&&{numberOfResults:tO(e),firstResult:e.pagination.firstResult},tab:He(e.tabSet),...u}},ul=(e,t)=>sa.endpoints.getAnswer.initiate(ux(e,"fetch",t)),Qf=(e,t)=>sa.endpoints.getAnswer.select(ux(e,"select",t||IC()))(e);var lx=$(Xn,e=>e);import{isNullOrUndefined as aO}from"../bueno/v1.1.0/bueno.esm.js";function oO(e){let t=e.payload?.analyticsAction;return dx(e)&&!aO(t)}function dx(e){return"type"in e}var px=e=>t=>r=>{let n;oO(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let a=t(r);return dx(r)&&(r.type==="search/executeSearch/fullfilled"&&n===void 0&&console.error("No analytics action associated with search:",r),r.type==="recommendation/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with recommendation:",r),r.type==="productRecommendations/get/fullfilled"&&n===void 0&&console.error("No analytics action associated with product recommendation:",r)),n!==void 0&&e.dispatch(n),a};import{isNullOrUndefined as ve}from"../bueno/v1.1.0/bueno.esm.js";import{RecordValue as iO}from"../bueno/v1.1.0/bueno.esm.js";var Uo=S("tab/register",e=>{let t=new iO({values:{id:j,expression:ce}});return F(e,t)}),kt=S("tab/updateActiveTab",e=>F(e,j));var ll=Cr(Ru(),1),gx=Cr(mx(),1),yx=Cr(fx(),1);ll.default.extend(yx.default);ll.default.extend(gx.default);var Bo=()=>({organizationId:"",accessToken:"",search:{locale:"en-US",timezone:ll.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",analyticsMode:"next",source:{}},knowledge:{answerConfigurationId:""},environment:"prod"});var sO=/(^|; )Coveo-Pendragon=([^;]*)/;function $f(){return typeof window>"u"?!1:sO.exec(document.cookie)?.pop()||null}var dl=$(Bo(),e=>e.addCase(wt,(t,r)=>{cO(t,r.payload)}).addCase(mt,(t,r)=>{uO(t,r.payload)}).addCase(Jr,(t,r)=>{lO(t,r.payload)}).addCase(oo,t=>{t.analytics.enabled=!1}).addCase(io,t=>{t.analytics.enabled=!0}).addCase(Su,(t,r)=>{t.analytics.originLevel2=r.payload.originLevel2}).addCase(Cu,(t,r)=>{t.analytics.originLevel3=r.payload.originLevel3}).addCase(kt,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(so,(t,r)=>{t.analytics.originLevel2=r.payload}).addCase(ie,(t,r)=>{ve(r.payload.tab)||(t.analytics.originLevel2=r.payload.tab)}));function cO(e,t){ve(t.accessToken)||(e.accessToken=t.accessToken),e.environment=t.environment??"prod",ve(t.organizationId)||(e.organizationId=t.organizationId)}function uO(e,t){ve(t.proxyBaseUrl)||(e.search.apiBaseUrl=t.proxyBaseUrl),ve(t.locale)||(e.search.locale=t.locale),ve(t.timezone)||(e.search.timezone=t.timezone),ve(t.authenticationProviders)||(e.search.authenticationProviders=t.authenticationProviders)}function lO(e,t){ve(t.enabled)||(e.analytics.enabled=t.enabled),ve(t.originContext)||(e.analytics.originContext=t.originContext),ve(t.originLevel2)||(e.analytics.originLevel2=t.originLevel2),ve(t.originLevel3)||(e.analytics.originLevel3=t.originLevel3),ve(t.proxyBaseUrl)||(e.analytics.apiBaseUrl=t.proxyBaseUrl),ve(t.trackingId)||(e.analytics.trackingId=t.trackingId),ve(t.analyticsMode)||(e.analytics.analyticsMode=t.analyticsMode),ve(t.source)||(e.analytics.source=t.source);try{let r=$f();r&&(e.analytics.analyticsMode="next",e.analytics.trackingId=r)}catch{}ve(t.runtimeEnvironment)||(e.analytics.runtimeEnvironment=t.runtimeEnvironment),ve(t.anonymous)||(e.analytics.anonymous=t.anonymous),ve(t.deviceId)||(e.analytics.deviceId=t.deviceId),ve(t.userDisplayName)||(e.analytics.userDisplayName=t.userDisplayName),ve(t.documentLocation)||(e.analytics.documentLocation=t.documentLocation)}var H=dl;function dO(e){return e.instantlyCallable}var hx=()=>e=>t=>e(dO(t)?t():t);var Sx=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let a=n.error,o=[n.payload?.errorCode,n.payload?.message].filter(Boolean).join(" - ");if(n.payload?.ignored||e.error(o||a.stack||a.message||a.name||"Error",`Action dispatch error ${n.type}`,r),n.error.name!=="SchemaValidationError")return t(r)},Cx=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));function xx(e,t){let r={...e},n,a=o=>(i,s)=>{let c=o(i,s);return n?n(c,s):c};return{get combinedReducer(){let o=yy(Object.entries(t).filter(([i])=>!(i in r)).map(([i,s])=>[i,()=>s]));return a(Ma({...o,...r}))},containsAll(o){return Object.keys(o).every(s=>s in r)},add(o){Object.keys(o).filter(i=>!(i in r)).forEach(i=>{r[i]=o[i]})},addCrossReducer(o){n=o}}}function pl(e,t,r){var n,a,o;t===void 0&&(t=50),r===void 0&&(r={});var i=(n=r.isImmediate)!=null&&n,s=(a=r.callback)!=null&&a,c=r.maxWait,u=Date.now(),l=[];function p(){if(c!==void 0){var d=Date.now()-u;if(d+t>=c)return c-d}return t}var m=function(){var d=[].slice.call(arguments),f=this;return new Promise(function(C,g){var y=i&&o===void 0;if(o!==void 0&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,u=Date.now(),!i){var h=e.apply(f,d);s&&s(h),l.forEach(function(A){return(0,A.resolve)(h)}),l=[]}},p()),y){var x=e.apply(f,d);return s&&s(x),C(x)}l.push({resolve:C,reject:g})})};return m.cancel=function(d){o!==void 0&&clearTimeout(o),l.forEach(function(f){return(0,f.reject)(d)}),l=[]},m}function Gf(e){if(!e||!pO(e))return null;try{let r=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=atob(r),a=decodeURIComponent(n.split("").map(o=>`%${`00${o.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return JSON.parse(a)}catch{return null}}function Ax(e,t=60){if(!e)return!1;let r=Gf(e);if(!r||typeof r.exp!="number")return!1;let n=Math.floor(Date.now()/1e3);return r.exp<=n+t}function pO(e){return e?/^[A-Za-z0-9_-]{2,}(?:\.[A-Za-z0-9_-]{2,}){2}$/.test(e):!1}function Rx(e,t){let r=0,n=pl(()=>{r=0},500);return a=>o=>async i=>{if(!(typeof i=="function"))return o(i);let c=typeof t=="function";if(c){let p=a.getState(),m=gO(p);if(m&&Ax(m)){e.debug("Access token is expired or about to expire, attempting renewal.");try{let d=await t();d?(a.dispatch(wt({accessToken:d})),e.debug("Access token was renewed.")):e.warn("Access token renewal returned an empty token. Please check the #renewAccessToken function.")}catch(d){e.warn(d,"Access token renewal failed. A retry will occur if necessary.")}}}let u=await o(i);if(!mO(u))return u;if(!c)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),Fx(a,u.error),u;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),Fx(a,u.error),u;r++,n();let l=await fO(t);a.dispatch(wt({accessToken:l})),a.dispatch(i)}}function mO(e){return typeof e=="object"&&e!==null&&"error"in e&&e.error?.name===new Va().name}function Fx(e,t){e.dispatch(Oo({status:401,statusCode:401,message:t.message,type:t.name}))}async function fO(e){try{return await e()}catch{return""}}function gO(e){return e.configuration.accessToken}function bx({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:a}){return xh({reducer:e,preloadedState:t,devTools:{stateSanitizer:o=>o.history?{...o,history:"<<OMIT>>"}:o,name:a,shouldHotReload:!1},middleware:o=>o({thunk:{extraArgument:n}}).prepend(...r).concat(Cx(n.logger))})}function yO(e,t){let{analytics:r}=e,{analyticsClientMiddleware:n,...a}=r??{},o={...a,...r?.proxyBaseUrl&&{apiBaseUrl:r.proxyBaseUrl,nexApiBaseUrl:r.proxyBaseUrl}};return o.analyticsMode!=="next"&&gy()?(t.info("Analytics disabled since doNotTrack is active."),{...o,enabled:!1}):o}function vx(e,t){let r={...e.reducers,configuration:H,version:lx},n=hO({...e,reducers:r},t,H),{accessToken:a,environment:o,organizationId:i}=e.configuration;n.dispatch(wt({accessToken:a,environment:o,organizationId:i}));let s=yO(e.configuration,n.logger);return s&&n.dispatch(Jr(s)),n}function hO(e,t,r){let{reducers:n,navigatorContextProvider:a}=e,o=xx({...n,configurationReducer:r},e.preloadedState??{});e.crossReducer&&o.addCrossReducer(e.crossReducer);let i=t.logger,s={...t,get relay(){return hs(u.state,a)},get navigatorContext(){return vf(this.relay,a)}},c=SO(e,s,o),u={addReducers(l){o.containsAll(l)||(o.add(l),c.replaceReducer(o.combinedReducer))},dispatch:c.dispatch,subscribe:c.subscribe,enableAnalytics(){c.dispatch(io())},disableAnalytics(){c.dispatch(oo())},get state(){return c.getState()},get relay(){return hs(this.state,a)},get navigatorContext(){return vf(this.relay,a)},logger:i,store:c};return u}function SO(e,t,r){let{preloadedState:n,configuration:a}=e,o=a.name||"coveo-headless",i=CO(e,t.logger);return bx({preloadedState:n,reducer:r.combinedReducer,middlewares:i,thunkExtraArguments:t,name:o})}function CO(e,t){let{renewAccessToken:r}=e.configuration,n=Rx(t,r);return[hx,n,Sx(t),px].concat(sa.middleware,e.middlewares||[])}var xO=`[Warning] A component from the Coveo Headless library has been instantiated with the Analytics Mode: "Next".
However, this mode is not available for Coveo for Service features, and this configuration may not work as expected.
Please switch back to the "legacy" analytics mode to ensure proper functionality.
For more information, refer to the documentation: https://docs.coveo.com/en/o3r90189/build-a-search-ui/event-protocol`;function mn(e){e==="next"&&console.warn(xO)}var Dx=Cr(qx(),1);function jx(e){return(0,Dx.pino)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}function Vx(e,t){let r=MO(e),n=ct,a=QO(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:a,logger:t}}function MO(e){let{analytics:t}=e,r=(n,a)=>a;return t?.analyticsClientMiddleware||r}function QO(e){return e.preprocessRequest||Tc}import{isNullOrUndefined as Jf}from"../bueno/v1.1.0/bueno.esm.js";var Xf=(e,t,r,n,a,o)=>{let i=e[t];Jf(i)||Jf(a)||a!==i&&a!==n&&(o.warn(`Mismatch on access token (JWT Token) ${t} and engine configuration.`),o.warn(`To remove this warning, make sure that access token value [${i}] matches engine configuration value [${r}]`))},Zf=(e,t)=>!(Jf(e)||t===e),Ks=e=>{let t=Gf(e);return t||!1},Qx=(e,t)=>(Zf(e.searchHub,t.searchHub)&&(t.searchHub=e.searchHub),t),Nx=(e,t,r,n)=>(Xf(e,"searchHub",t.searchHub,Wr(),r,n),Qx(e,t)),Lx=(e,t)=>(Zf(e.pipeline,t.pipeline)&&(t.pipeline=e.pipeline),t),Mx=(e,t,r,n)=>(Xf(e,"pipeline",t.pipeline,Er(),r,n),Lx(e,t)),Ux=(e,t)=>(Zf(e.userDisplayName,t.configuration.analytics.userDisplayName)&&(t.configuration.analytics.userDisplayName=e.userDisplayName),t),LO=(e,t,r,n)=>(Xf(e,"userDisplayName",t.configuration.analytics.userDisplayName,Bo().analytics.userDisplayName,r,n),Ux(e,t)),Bx=e=>$({},t=>{t.addCase(qo,(r,n)=>{let a=Ks(r.configuration.accessToken);return a?Nx(a,r,n.payload,e):r}).addCase(lo,(r,n)=>{let a=Ks(r.configuration.accessToken);return a?Mx(a,r,n.payload,e):r}).addCase(wt,(r,n)=>{if(r.configuration.accessToken!==n.payload.accessToken)return r;let{accessToken:a}=n.payload;if(!a)return r;let o=Ks(a);return o?[Lx,Qx,Ux].reduce((i,s)=>s(o,i),r):r}).addCase(mt,(r,n)=>{let a=Ks(r.configuration.accessToken);if(!a)return r;let o=Nx(a,r,n.payload.searchHub,e);return Mx(a,o,n.payload?.pipeline,e)}).addCase(Jr,(r,n)=>{let a=Ks(r.configuration.accessToken);return a?LO(a,r,n.payload.userDisplayName,e):r})});import{ArrayValue as _O,RecordValue as $O,Schema as GO,StringValue as Gx}from"../bueno/v1.1.0/bueno.esm.js";import{BooleanValue as UO,RecordValue as BO,StringValue as gn}from"../bueno/v1.1.0/bueno.esm.js";var _x={organizationId:j,accessToken:j,name:new gn({required:!1,emptyAllowed:!1}),analytics:new BO({options:{required:!1},values:{enabled:new UO({required:!1}),originContext:new gn({required:!1}),originLevel2:new gn({required:!1}),originLevel3:new gn({required:!1}),analyticsMode:new gn({constrainTo:["legacy","next"],required:!1,default:"next"}),proxyBaseUrl:new gn({required:!1,url:!0}),trackingId:new gn({required:!1,emptyAllowed:!1,regex:/^[a-zA-Z0-9_\-.]{1,100}$/})}}),environment:new gn({required:!1,default:"prod",constrainTo:["prod","hipaa","stg","dev"]})};function $x(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457"}}var Hx=new GO({..._x,search:new $O({options:{required:!1},values:{pipeline:new Gx({required:!1,emptyAllowed:!0}),searchHub:me,locale:me,timezone:me,authenticationProviders:new _O({required:!1,each:j}),proxyBaseUrl:new Gx({required:!1,url:!0})}})});function zx(){return{...$x(),search:{searchHub:"default"}}}var HO={debug:uo,pipeline:po,searchHub:Do,search:W};function zO(e){let{search:t,organizationId:r,environment:n}=e,a=t?.proxyBaseUrl?t.proxyBaseUrl:Pe(r,n);return{...t,apiBaseUrl:a}}function WO(e){let t=jx(e.loggerOptions),{configuration:r}=e;YO(r,t);let n=KO(r,t),a=JO(t),o={...Vx(r,t),apiClient:n,streamingClient:a},i={...e,reducers:HO,crossReducer:Bx(t)},s=vx(i,o),c=zO(r);return c&&s.dispatch(mt(c)),{...s,get state(){return s.state},executeFirstSearch(u=gu()){if(Ns(s.state))return;let l=V({legacy:u,next:US()});s.dispatch(l)},executeFirstSearchAfterStandaloneSearchBoxRedirect(u){let{cause:l,metadata:p}=u;if(Ns(s.state))return;let m=p&&l==="omniboxFromLink",d=V({legacy:m?hu(p):yu(),next:m?_S():BS()});s.dispatch(d)}}}function YO(e,t){try{Hx.validate(e)}catch(r){throw t.error(r,"Search engine configuration error"),r}}function KO(e,t){let{search:r}=e;return new Oc({logger:t,preprocessRequest:e.preprocessRequest||Tc,postprocessSearchResponseMiddleware:r?.preprocessSearchResponseMiddleware||_y,postprocessFacetSearchResponseMiddleware:r?.preprocessFacetSearchResponseMiddleware||$y,postprocessQuerySuggestResponseMiddleware:r?.preprocessQuerySuggestResponseMiddleware||Gy})}function JO(e){return new Ic({logger:e})}import{NumberValue as Wx,RecordValue as rq}from"../bueno/v1.1.0/bueno.esm.js";import{NumberValue as XO}from"../bueno/v1.1.0/bueno.esm.js";var ua={value:j,numberOfResults:new XO({min:0}),state:j};var K=j;var nq=new Wx({min:1,default:8,required:!1}),aq=new Wx({min:1,max:20,default:5,required:!1}),oq={desiredCount:aq,numberOfValues:nq},$o=S("automaticFacet/setOptions",e=>F(e,oq)),Go=S("automaticFacet/deselectAll",e=>F(e,K)),iq=j,Wt=S("automaticFacet/toggleSelectValue",e=>F(e,{field:iq,selection:new rq({values:ua})}));import{ArrayValue as yl,BooleanValue as Yx,NumberValue as Kx,RecordValue as mq,StringValue as gl,Value as Jx}from"../bueno/v1.1.0/bueno.esm.js";import{ArrayValue as sq,BooleanValue as cq,NumberValue as uq,StringValue as lq,Value as dq}from"../bueno/v1.1.0/bueno.esm.js";var pq={state:new dq({required:!0}),numberOfResults:new uq({required:!0,min:0}),value:new lq({required:!0,emptyAllowed:!0}),path:new sq({required:!0,each:j}),moreValuesAvailable:new cq({required:!1})};function eg(e){e.children.forEach(t=>{eg(t)}),ct({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},pq)}var Ho={facetId:K,field:j,tabs:new mq({options:{required:!1},values:{included:new yl({each:new gl}),excluded:new yl({each:new gl})}}),activeTab:new gl({required:!1}),delimitingCharacter:new gl({required:!1,emptyAllowed:!0}),filterFacetCount:new Yx({required:!1}),injectionDepth:new Kx({required:!1,min:0}),numberOfValues:new Kx({required:!1,min:1}),sortCriteria:new Jx({required:!1}),basePath:new yl({required:!1,each:j}),filterByBasePath:new Yx({required:!1})};var Yt=S("categoryFacet/register",e=>F(e,Ho)),yn=S("categoryFacet/toggleSelectValue",e=>{try{return ct(e.facetId,j),eg(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Fr(t)}}}),Kt=S("categoryFacet/deselectAll",e=>F(e,Ho.facetId)),la=S("categoryFacet/updateNumberOfValues",e=>F(e,{facetId:Ho.facetId,numberOfValues:Ho.numberOfValues})),zo=S("categoryFacet/updateSortCriterion",e=>F(e,{facetId:Ho.facetId,criterion:new Jx})),hl=S("categoryFacet/updateBasePath",e=>F(e,{facetId:Ho.facetId,basePath:new yl({each:j})}));import{ArrayValue as fq}from"../bueno/v1.1.0/bueno.esm.js";var gq={categoryFacetId:K,categoryFacetPath:new fq({required:!0,each:j})},yq=(e,{categoryFacetId:t,categoryFacetPath:r})=>{let a=e.categoryFacetSet[t]?.request.field,o=`${a}_${t}`;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:a,categoryFacetTitle:o}},Sl=e=>Q("analytics/categoryFacet/breadcrumb",(t,r)=>(F(e,gq),t.makeBreadcrumbFacet(yq(r,e)))),Xx=()=>({actionCause:"breadcrumbFacet"});import{BooleanValue as hq}from"../bueno/v1.1.0/bueno.esm.js";var Z=S("facetOptions/update",(e={freezeFacetOrder:!0})=>F(e,{freezeFacetOrder:new hq({required:!1})})),Le=S("facetOptions/facet/enable",e=>F(e,K)),fe=S("facetOptions/facet/disable",e=>F(e,K));import{ArrayValue as Aq,NumberValue as Fq,RecordValue as Rq}from"../bueno/v1.1.0/bueno.esm.js";import{NumberValue as Sq,RecordValue as Cq,StringValue as xq}from"../bueno/v1.1.0/bueno.esm.js";var Js={facetId:K,captions:new Cq({options:{required:!1}}),numberOfValues:new Sq({required:!1,min:1}),query:new xq({required:!1,emptyAllowed:!0})};var bq={path:new Aq({required:!0,each:j}),displayValue:ce,rawValue:ce,count:new Fq({required:!0,min:0})},Wo=S("categoryFacet/selectSearchResult",e=>F(e,{facetId:K,value:new Rq({values:bq})})),Yo=S("categoryFacetSearch/register",e=>F(e,Js));function Ko(e,t){let{facetId:r,criterion:n}=t,a=e[r]?.request;a&&(a.sortCriteria=n)}function Xs(e){e&&(e.currentValues=e.currentValues.map(t=>({...t,previousState:t.state!=="idle"?t.state:void 0,state:"idle"})),e.preventAutoSelect=!0)}function Cl(e,t){e&&(e.numberOfValues=t)}function xl(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function tg(e,t,r){e.currentValues=vq(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function vq(e,t){if(!e.length)return[];let r=Zx(e[0],t),n=r;for(let a of e.splice(1)){let o=Zx(a,t);n.children.push(o),n=o}return n.state="selected",n.retrieveChildren=!0,[r]}function Zx(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var Jt=$(Ya(),e=>{e.addCase(Yt,(t,r)=>{let n=r.payload,{facetId:a}=n;if(a in t)return;let o=Pq(n),i=o.numberOfValues;t[a]={request:o,initialNumberOfValues:i}}).addCase(oe.fulfilled,(t,r)=>r.payload?.categoryFacetSet??t).addCase(ie,(t,r)=>{let n=r.payload.cf||{};Object.keys(t).forEach(a=>{let o=t[a].request,i=n[a]||[];(i.length||o.currentValues.length)&&tg(o,i,t[a].initialNumberOfValues)})}).addCase(zo,(t,r)=>{let{facetId:n,criterion:a}=r.payload,o=t[n]?.request;o&&(o.sortCriteria=a)}).addCase(hl,(t,r)=>{let{facetId:n,basePath:a}=r.payload,o=t[n]?.request;o&&(o.basePath=[...a])}).addCase(yn,(t,r)=>{let{facetId:n,selection:a,retrieveCount:o}=r.payload,i=t[n]?.request;if(!i)return;let{path:s}=a,c=s.slice(0,s.length-1),u=wq(i,c,o);if(u.length){let p=u[0];p.retrieveChildren=!0,p.state="selected",p.previousState="idle",p.children=[];return}let l=tA(a.value,o);l.state="selected",l.previousState="idle",u.push(l),i.numberOfValues=1}).addCase(Kt,(t,r)=>{let n=r.payload;xl(t,n)}).addCase(be,t=>{Object.keys(t).forEach(r=>xl(t,r))}).addCase(Ut,(t,r)=>Object.keys(t).forEach(n=>{t[n].request.preventAutoSelect=!r.payload.allow})).addCase(la,(t,r)=>{let{facetId:n,numberOfValues:a}=r.payload,o=t[n]?.request;if(o){if(!o.currentValues.length)return Cl(o,a);Eq(t,r.payload)}}).addCase(Wo,(t,r)=>{let{facetId:n,value:a}=r.payload,o=t[n];if(!o)return;let i=[...a.path,a.rawValue];tg(o.request,i,o.initialNumberOfValues)}).addCase(zt.fulfilled,(t,r)=>{eA(t,r.payload.response.facets)}).addCase(V.fulfilled,(t,r)=>{eA(t,r.payload.response.facets)}).addCase(fe,(t,r)=>{xl(t,r.payload)})}),Zs={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function wq(e,t,r){let n=e.currentValues;for(let a of t){let o=n[0];(!o||a!==o.value)&&(o=tA(a,r),n.length=0,n.push(o)),o.retrieveChildren=!1,o.previousState=void 0,o.state="idle",n=o.children}return n}function Pq(e){return{...Zs,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}function tA(e,t){return{value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function eA(e,t){t.forEach(r=>{if(!Iq(e,r))return;let n=r.facetId,a=e[n]?.request;if(!a)return;let o=kq(a,r);a.currentValues=o?[]:a.currentValues,a.preventAutoSelect=!1})}function Eq(e,t){let{facetId:r,numberOfValues:n}=t,a=e[r]?.request.currentValues[0];if(a){for(;a.children.length&&a?.state!=="selected";)a=a.children[0];a.retrieveCount=n}}function Iq(e,t){return t.facetId in e}function kq(e,t){let r=Ke(e.currentValues),n=Ke(t.values);return r.length!==n.length}import{ArrayValue as sA,BooleanValue as ig,NumberValue as ag,RecordValue as sg,StringValue as vl,Value as og}from"../bueno/v1.1.0/bueno.esm.js";import{ArrayValue as rg,BooleanValue as Al,NumberValue as rA,RecordValue as ng,StringValue as hn}from"../bueno/v1.1.0/bueno.esm.js";var Xt=new hn({regex:/^[a-zA-Z0-9-_]+$/}),Zt=new hn({required:!0}),nA=new rg({each:new hn}),aA=new hn,oA=new Al,er=new Al,tr=new rA({min:0}),Tt=new rA({min:1}),Fl=new Al({required:!0}),Tq=new ng,Oq=new hn,qq={captions:Tq,numberOfValues:Tt,query:Oq},Jo=new ng({values:qq}),Rl=new ng({options:{required:!1},values:{type:new hn({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new rg({required:!0,max:25,each:new hn({emptyAllowed:!1,required:!0})})}}),iA=new Al,bl=new rg({min:1,max:25,required:!1,each:new hn({emptyAllowed:!1,required:!0})});var Dq={facetId:K,field:new vl({required:!0,emptyAllowed:!0}),tabs:new sg({options:{required:!1},values:{included:new sA({each:new vl}),excluded:new sA({each:new vl})}}),activeTab:new vl({required:!1}),filterFacetCount:new ig({required:!1}),injectionDepth:new ag({required:!1,min:0}),numberOfValues:new ag({required:!1,min:1}),sortCriteria:new og({required:!1}),resultsMustMatch:new og({required:!1}),allowedValues:Rl,customSort:bl},rr=S("facet/register",e=>F(e,Dq)),nr=S("facet/toggleSelectValue",e=>F(e,{facetId:K,selection:new sg({values:ua})})),ar=S("facet/toggleExcludeValue",e=>F(e,{facetId:K,selection:new sg({values:ua})})),ge=S("facet/deselectAll",e=>F(e,K)),Xo=S("facet/updateSortCriterion",e=>F(e,{facetId:K,criterion:new og({required:!0})})),da=S("facet/updateNumberOfValues",e=>F(e,{facetId:K,numberOfValues:new ag({required:!0,min:1})})),pa=S("facet/updateIsFieldExpanded",e=>F(e,{facetId:K,isFieldExpanded:new ig({required:!0})})),Tr=S("facet/updateFreezeCurrentValues",e=>F(e,{facetId:K,freezeCurrentValues:new ig({required:!0})}));import{Value as jq}from"../bueno/v1.1.0/bueno.esm.js";var Zo=e=>Q("analytics/facet/showMore",(t,r)=>{F(e,K);let n=Za(e,nt(r));return t.makeFacetShowMore(n)}),ei=e=>Q("analytics/facet/showLess",(t,r)=>{F(e,K);let n=Za(e,nt(r));return t.makeFacetShowLess(n)}),or=e=>Q("analytics/facet/sortChange",(t,r)=>{F(e,{facetId:K,criterion:new jq({required:!0})});let{facetId:n,criterion:a}=e,o=nt(r),s={...Za(n,o),criteria:a};return t.makeFacetUpdateSort(s)}),Ie=e=>Q("analytics/facet/reset",(t,r)=>{F(e,K);let n=nt(r),a=Za(e,n);return t.makeFacetClearAll(a)}),Se=e=>Q("analytics/facet/select",(t,r)=>{F(e,{facetId:K,facetValue:j});let n=nt(r),a=eo(e,n);return t.makeFacetSelect(a)}),ot=e=>Q("analytics/facet/exclude",(t,r)=>{F(e,{facetId:K,facetValue:j});let n=nt(r),a=eo(e,n);return t.makeFacetExclude(a)}),Ot=e=>Q("analytics/facet/deselect",(t,r)=>{F(e,{facetId:K,facetValue:j});let n=nt(r),a=eo(e,n);return t.makeFacetDeselect(a)}),Or=e=>Q("analytics/facet/unexclude",(t,r)=>{F(e,{facetId:K,facetValue:j});let n=nt(r),a=eo(e,n);return t.makeFacetUnexclude(a)}),ti=e=>Q("analytics/facet/breadcrumb",(t,r)=>{F(e,{facetId:K,facetValue:j});let n=eo(e,nt(r));return t.makeBreadcrumbFacet(n)}),Ue=()=>({actionCause:"facetClearAll"}),we=()=>({actionCause:"facetSelect"}),qr=()=>({actionCause:"facetExclude"}),Dr=()=>({actionCause:"facetDeselect"}),cA=()=>({actionCause:"facetUnexclude"}),wl=()=>({actionCause:"breadcrumbFacet"});import{NumberValue as Vq,RecordValue as Nq}from"../bueno/v1.1.0/bueno.esm.js";var uA={facetId:K,value:new Nq({values:{displayValue:ce,rawValue:ce,count:new Vq({required:!0,min:0})}})},Pl=S("facetSearch/register",e=>F(e,Js)),Sn=S("facetSearch/update",e=>F(e,Js)),ma=S("facetSearch/toggleSelectValue",e=>F(e,uA)),fa=S("facetSearch/toggleExcludeValue",e=>F(e,uA));var ht=$(Xa(),e=>{e.addCase(rr,(t,r)=>{let{facetId:n}=r.payload;n in t||(t[n]=yS(Mq(r.payload)))}).addCase(oe.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.facetSet).length!==0)return r.payload.facetSet}).addCase(ie,(t,r)=>{let n=r.payload.f||{},a=r.payload.fExcluded||{};Object.keys(t).forEach(i=>{let{request:s}=t[i],c=n[i]||[],u=a[i]||[],l=c.length+u.length,p=s.currentValues.filter(m=>!c.includes(m.value)&&!u.includes(m.value));s.currentValues=[...c.map(dA),...u.map(pA),...p.map(Lq)],s.preventAutoSelect=l>0,s.numberOfValues=Math.max(l,s.numberOfValues)})}).addCase(nr,(t,r)=>{let{facetId:n,selection:a}=r.payload,o=t[n]?.request;if(!o)return;o.preventAutoSelect=!0;let i=o.currentValues.find(c=>c.value===a.value);if(!i){El(o,a);return}let s=i.state==="selected";i.previousState=i.state,i.state=s?"idle":"selected",o.freezeCurrentValues=!0}).addCase(ar,(t,r)=>{let{facetId:n,selection:a}=r.payload,o=t[n]?.request;if(!o)return;o.preventAutoSelect=!0;let i=o.currentValues.find(c=>c.value===a.value);if(!i){El(o,a);return}let s=i.state==="excluded";i.previousState=i.state,i.state=s?"idle":"excluded",o.freezeCurrentValues=!0}).addCase(Tr,(t,r)=>{let{facetId:n,freezeCurrentValues:a}=r.payload,o=t[n]?.request;o&&(o.freezeCurrentValues=a)}).addCase(ge,(t,r)=>{Xs(t[r.payload]?.request)}).addCase(be,t=>{Object.values(t).filter(r=>r.hasBreadcrumbs).forEach(({request:r})=>Xs(r))}).addCase(mo,t=>{Object.values(t).filter(r=>!r.hasBreadcrumbs).forEach(({request:r})=>Xs(r))}).addCase(Ut,(t,r)=>Object.values(t).forEach(n=>{n.request.preventAutoSelect=!r.payload.allow})).addCase(Xo,(t,r)=>{Ko(t,r.payload)}).addCase(da,(t,r)=>{let{facetId:n,numberOfValues:a}=r.payload;Cl(t[n]?.request,a)}).addCase(pa,(t,r)=>{let{facetId:n,isFieldExpanded:a}=r.payload,o=t[n]?.request;o&&(o.isFieldExpanded=a)}).addCase(V.fulfilled,(t,r)=>{r.payload.response.facets.forEach(a=>lA(t[a.facetId]?.request,a))}).addCase(zt.fulfilled,(t,r)=>{r.payload.response.facets.forEach(a=>lA(t[a.facetId]?.request,a))}).addCase(ma,(t,r)=>{let{facetId:n,value:a}=r.payload,o=t[n]?.request;if(!o)return;let{rawValue:i}=a,{currentValues:s}=o,c=s.find(l=>l.value===i);if(c){c.state="selected";return}let u=dA(i);El(o,u),o.freezeCurrentValues=!0,o.preventAutoSelect=!0}).addCase(fa,(t,r)=>{let{facetId:n,value:a}=r.payload,o=t[n]?.request;if(!o)return;let{rawValue:i}=a,{currentValues:s}=o,c=s.find(l=>l.value===i);if(c){c.state="excluded";return}let u=pA(i);El(o,u),o.freezeCurrentValues=!0,o.preventAutoSelect=!0}).addCase(fe,(t,r)=>{if(!(r.payload in t))return;let{request:n}=t[r.payload];Xs(n)})});function El(e,t){let{currentValues:r}=e,n=r.findIndex(o=>o.state==="idle"),a=n===-1?r.length:n;e.currentValues.splice(a,0,t),n>-1&&e.currentValues.pop(),e.numberOfValues=e.currentValues.length}function lA(e,t){e&&(e.currentValues=t.values.map(Qq),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var ec={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function Mq(e){return{...ec,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}function Qq(e){let{value:t,state:r}=e;return{value:t,state:r}}function dA(e){return{value:e,state:"selected"}}function pA(e){return{value:e,state:"excluded"}}function Lq(e){return{...e,state:"idle"}}var Il=()=>Q("analytics/facet/deselectAllBreadcrumbs",e=>e.makeBreadcrumbResetAll());import{ArrayValue as Tl,BooleanValue as ug,NumberValue as yA,RecordValue as tc,StringValue as cg,Value as hA}from"../bueno/v1.1.0/bueno.esm.js";function ga(e){let t=mA(e.start,e),r=mA(e.end,e),n=e.endInclusive??!1,a=e.state??"idle";return{start:t,end:r,endInclusive:n,state:a}}function mA(e,t){let{dateFormat:r}=t;return cC(e)?(na(e),oC(e)):typeof e=="string"&&$t(e)?(na(e),e):(vu(e,r),qs(ra(e,r)))}import{Value as Uq}from"../bueno/v1.1.0/bueno.esm.js";var ri=S("rangeFacet/updateSortCriterion",e=>F(e,{facetId:K,criterion:new Uq({required:!0})}));import{BooleanValue as gA,NumberValue as kl,RecordValue as fA}from"../bueno/v1.1.0/bueno.esm.js";var ya={state:j,start:new kl({required:!0}),end:new kl({required:!0}),endInclusive:new gA({required:!0}),numberOfResults:new kl({required:!0,min:0})},ha={start:j,end:j,endInclusive:new gA({required:!0}),state:j,numberOfResults:new kl({required:!0,min:0})},Sa=e=>({facetId:K,selection:typeof e.start=="string"?new fA({values:ha}):new fA({values:ya})});var Bq={start:j,end:j,endInclusive:new ug({required:!0}),state:j},_q={facetId:K,field:j,tabs:new tc({options:{required:!1},values:{included:new Tl({each:new cg}),excluded:new Tl({each:new cg})}}),activeTab:new cg({required:!1}),currentValues:new Tl({required:!1,each:new tc({values:Bq})}),generateAutomaticRanges:new ug({required:!0}),filterFacetCount:new ug({required:!1}),injectionDepth:new yA({required:!1,min:0}),numberOfValues:new yA({required:!1,min:1}),sortCriteria:new hA({required:!1}),rangeAlgorithm:new hA({required:!1})};function SA(e){return $t(e)?js(e):e}function Ol(e){e.currentValues&&e.currentValues.forEach(t=>{let{start:r,end:n}=ga(t);if(ra(SA(r)).isAfter(ra(SA(n))))throw new Error(`The start value is greater than the end value for the date range ${t.start} to ${t.end}`)})}var ir=S("dateFacet/register",e=>{try{return ct(e,_q),Ol(e),{payload:e,error:null}}catch(t){return{payload:e,error:Fr(t)}}}),sr=S("dateFacet/toggleSelectValue",e=>F(e,{facetId:K,selection:new tc({values:ha})})),cr=S("dateFacet/toggleExcludeValue",e=>F(e,{facetId:K,selection:new tc({values:ha})})),jr=S("dateFacet/updateFacetValues",e=>{try{return ct(e,{facetId:K,values:new Tl({each:new tc({values:ha})})}),Ol({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Fr(t)}}}),ql=ri,Dl=ge;var jl=(e,{facetId:t,selection:r})=>{let a=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field,o=`${a}_${t}`;return{facetId:t,facetField:a,facetTitle:o,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},Vl=()=>({actionCause:"breadcrumbFacet"});var rc=e=>Q("analytics/dateFacet/breadcrumb",(t,r)=>{F(e,Sa(e.selection));let n=jl(r,e);return t.makeBreadcrumbFacet(n)}),lg=Vl;function $q(e,t){return!!t&&t.facetId in e.dateFacetSet}var CA=(e,t)=>{let r=Qt(e,t);if($q(e,r))return r},xA=(e,t)=>(CA(e,t)||{values:[]}).values.filter(n=>n.state==="selected"),AA=(e,t)=>(CA(e,t)||{values:[]}).values.filter(n=>n.state!=="idle");var Ml={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function Ql(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let a=FA(r);r.numberOfValues=a,e[n]=t}function Ll(e,t,r){let n=e[t]?.request;n&&(n.currentValues=r,n.numberOfValues=FA(n))}function Ul(e,t,r){let n=e[t]?.request;if(!n)return;let a=Nl(n.currentValues,r);if(!a)return;let o=a.state==="selected";a.previousState=a.state,a.state=o?"idle":"selected",n.preventAutoSelect=!0}function Bl(e,t,r){let n=e[t]?.request;if(!n)return;let a=Nl(n.currentValues,r);if(!a)return;let o=a.state==="excluded";a.previousState=a.state,a.state=o?"idle":"excluded",n.preventAutoSelect=!0}function Cn(e,t){let r=e[t]?.request;r&&r.currentValues.forEach(n=>{n.state!=="idle"&&(n.previousState=n.state),n.state="idle"})}function _l(e,t){Object.entries(e).forEach(([r,{request:n}])=>{let a=t[r]||[];n.currentValues.forEach(s=>(!!Nl(a,s)&&(s.state="selected"),s));let o=a.filter(s=>!Nl(n.currentValues,s)),i=n.currentValues;i.push(...o),n.numberOfValues=Math.max(n.numberOfValues,i.length)})}function $l(e,t,r){t.forEach(n=>{let a=n.facetId,o=e[a]?.request;if(!o)return;let i=r(n.values);o.currentValues=i,o.preventAutoSelect=!1})}function Nl(e,t){let{start:r,end:n}=t;return e.find(a=>a.start===r&&a.end===n)}function FA(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var ur=$(Ka(),e=>{e.addCase(ir,(t,r)=>{let{payload:n}=r,a=Gq(n);Ql(t,fS(a))}).addCase(oe.fulfilled,(t,r)=>r.payload?.dateFacetSet??t).addCase(ie,(t,r)=>{let n=r.payload.df||{};_l(t,n)}).addCase(sr,(t,r)=>{let{facetId:n,selection:a}=r.payload;Ul(t,n,a)}).addCase(cr,(t,r)=>{let{facetId:n,selection:a}=r.payload;Bl(t,n,a)}).addCase(jr,(t,r)=>{let{facetId:n,values:a}=r.payload;Ll(t,n,a)}).addCase(Dl,(t,r)=>{Cn(t,r.payload)}).addCase(be,t=>{Object.keys(t).forEach(r=>{Cn(t,r)})}).addCase(ql,(t,r)=>{Ko(t,r.payload)}).addCase(V.fulfilled,(t,r)=>{let n=r.payload.response.facets;$l(t,n,Hq)}).addCase(fe,(t,r)=>{Cn(t,r.payload)})});function Gq(e){return{...Ml,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}function Hq(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}import{ArrayValue as Gl,BooleanValue as pg,NumberValue as Hl,RecordValue as nc,StringValue as dg,Value as RA}from"../bueno/v1.1.0/bueno.esm.js";var zq={state:j,start:new Hl({required:!0}),end:new Hl({required:!0}),endInclusive:new pg({required:!0})},Wq={facetId:K,field:j,tabs:new nc({options:{required:!1},values:{included:new Gl({each:new dg}),excluded:new Gl({each:new dg})}}),activeTab:new dg({required:!1}),currentValues:new Gl({required:!1,each:new nc({values:zq})}),generateAutomaticRanges:new pg({required:!0}),filterFacetCount:new pg({required:!1}),injectionDepth:new Hl({required:!1,min:0}),numberOfValues:new Hl({required:!1,min:1}),sortCriteria:new RA({required:!1}),rangeAlgorithm:new RA({required:!1})};function zl(e){e.currentValues&&e.currentValues.forEach(({start:t,end:r})=>{if(t>r)throw new Error(`The start value is greater than the end value for the numeric range ${t} to ${r}`)})}var lr=S("numericFacet/register",e=>{try{return F(e,Wq),zl(e),{payload:e,error:null}}catch(t){return{payload:e,error:Fr(t)}}}),dr=S("numericFacet/toggleSelectValue",e=>F(e,{facetId:K,selection:new nc({values:ya})})),pr=S("numericFacet/toggleExcludeValue",e=>F(e,{facetId:K,selection:new nc({values:ya})})),Vr=S("numericFacet/updateFacetValues",e=>{try{return ct(e,{facetId:K,values:new Gl({each:new nc({values:ya})})}),zl({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Fr(t)}}}),Wl=ri,Yl=ge;var ac=e=>Q("analytics/numericFacet/breadcrumb",(t,r)=>{F(e,Sa(e.selection));let n=jl(r,e);return t.makeBreadcrumbFacet(n)}),mg=Vl;function Yq(e,t){return!!t&&t.facetId in e.numericFacetSet}var bA=(e,t)=>{let r=Qt(e,t);if(Yq(e,r))return r},vA=(e,t)=>(bA(e,t)||{values:[]}).values.filter(n=>n.state!=="idle"),wA=(e,t)=>(bA(e,t)||{values:[]}).values.filter(n=>n.state==="selected");var St=$(Ja(),e=>{e.addCase(lr,(t,r)=>{let{payload:n}=r,a=Kq(n);Ql(t,gS(a))}).addCase(oe.fulfilled,(t,r)=>r.payload?.numericFacetSet??t).addCase(ie,(t,r)=>{let n=r.payload.nf||{};_l(t,n)}).addCase(dr,(t,r)=>{let{facetId:n,selection:a}=r.payload;Ul(t,n,a)}).addCase(pr,(t,r)=>{let{facetId:n,selection:a}=r.payload;Bl(t,n,a)}).addCase(Vr,(t,r)=>{let{facetId:n,values:a}=r.payload;Ll(t,n,a)}).addCase(Yl,(t,r)=>{Cn(t,r.payload)}).addCase(be,t=>{Object.keys(t).forEach(r=>{Cn(t,r)})}).addCase(Wl,(t,r)=>{Ko(t,r.payload)}).addCase(V.fulfilled,(t,r)=>{let n=r.payload.response.facets;$l(t,n,Jq)}).addCase(fe,(t,r)=>{Cn(t,r.payload)})});function Kq(e){return{...Ml,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}function Jq(e){return e.map(t=>{let{numberOfResults:r,...n}=t;return n})}import{ArrayValue as Xq,RecordValue as Zq,StringValue as eD}from"../bueno/v1.1.0/bueno.esm.js";var Ca=j,Kl=new Zq({options:{required:!0},values:{caption:ce,expression:ce,state:new eD({constrainTo:["idle","selected","excluded"]})}}),Jl=new Xq({required:!0,each:Kl});var ni=S("staticFilter/register",e=>F(e,{id:Ca,values:Jl})),Nr=S("staticFilter/toggleSelect",e=>F(e,{id:Ca,value:Kl})),Mr=S("staticFilter/toggleExclude",e=>F(e,{id:Ca,value:Kl})),xn=S("staticFilter/deselectAllFilterValues",e=>F(e,Ca)),Xl=e=>Q("analytics/staticFilter/select",t=>t.makeStaticFilterSelect(e)),ai=e=>Q("analytics/staticFilter/deselect",t=>t.makeStaticFilterDeselect(e)),Zl=e=>Q("analytics/staticFilter/clearAll",t=>t.makeStaticFilterClearAll(e));function _(e){let t,r=new Map,n=()=>r.size===0,a=o=>{try{let i=JSON.stringify(o),s=t!==i;return t=i,s}catch(i){return console.warn('Could not detect if state has changed, check the controller "get state method"',i),!0}};return{subscribe(o){o();let i=Symbol(),s;return n()&&(t=JSON.stringify(this.state),s=e.subscribe(()=>{a(this.state)&&r.forEach(c=>c())})),r.set(i,o),()=>{r.delete(i),n()&&s?.()}},get state(){return{}}}}var ed=e=>Object.keys(e.facetSet).map(t=>{let r=e.facetValuesSelector(e.engine.state,t).map(n=>({value:n,deselect:()=>{n.state==="selected"?e.executeToggleSelect({facetId:t,selection:n}):n.state==="excluded"&&e.executeToggleExclude({facetId:t,selection:n})}}));return{facetId:t,field:e.facetSet[t].request.field,values:r}}).filter(t=>t.values.length);function PA(e){let t=_(e),{dispatch:r}=e;return{...t,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(be())},deselectBreadcrumb(n){n.deselect()}}}function tD(e){if(!rD(e))throw N;let t=PA(e),{dispatch:r}=e,n=()=>e.state,a=()=>{let g={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:y,selection:x})=>{r(nr({facetId:y,selection:x})),r(Tr({facetId:y,freezeCurrentValues:!1})),r(V({legacy:ti({facetId:y,facetValue:x.value}),next:wl()}))},executeToggleExclude:({facetId:y,selection:x})=>{r(ar({facetId:y,selection:x})),r(Tr({facetId:y,freezeCurrentValues:!1})),r(V({legacy:ti({facetId:y,facetValue:x.value}),next:wl()}))},facetValuesSelector:dS};return ed(g)},o=()=>{let g={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:y=>{r(dr(y)),r(V({legacy:ac(y),next:mg()}))},executeToggleExclude:y=>{r(pr(y)),r(V({legacy:ac(y),next:mg()}))},facetValuesSelector:vA};return ed(g)},i=()=>{let g={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:y=>{r(sr(y)),r(V({legacy:rc(y),next:lg()}))},executeToggleExclude:y=>{r(cr(y)),r(V({legacy:rc(y),next:lg()}))},facetValuesSelector:AA};return ed(g)},s=()=>Object.keys(n().categoryFacetSet).map(c).filter(g=>g.path.length),c=g=>{let y=mS(n(),g);return{facetId:g,field:n().categoryFacetSet[g].request.field,path:y,deselect:()=>{r(Kt(g)),r(V({legacy:Sl({categoryFacetPath:y.map(x=>x.value),categoryFacetId:g}),next:Xx()}))}}},u=()=>{let g=n().staticFilterSet??{};return Object.values(g).map(l)},l=g=>{let{id:y,values:x}=g,h=x.filter(A=>A.state!=="idle").map(A=>p(y,A));return{id:y,values:h}},p=(g,y)=>({value:y,deselect:()=>{let{caption:x,expression:h}=y;y.state==="selected"?r(Nr({id:g,value:y})):y.state==="excluded"&&r(Mr({id:g,value:y})),r(V({legacy:ai({staticFilterId:g,staticFilterValue:{caption:x,expression:h}})}))}}),m=()=>{let g=n().automaticFacetSet?.set??{};return Object.values(g).map(y=>d(y.response)).filter(y=>y.values.length>0)},d=g=>{let{field:y,label:x}=g,h=g.values.filter(A=>A.state!=="idle").map(A=>f(y,A));return{facetId:y,field:y,label:x,values:h}},f=(g,y)=>({value:y,deselect:()=>{r(Wt({field:g,selection:y})),r(V({legacy:ti({facetId:g,facetValue:y.value}),next:wl()}))}});function C(){return!![...a(),...o(),...i(),...s(),...u(),...m()].length}return{...t,get state(){return{facetBreadcrumbs:a(),categoryFacetBreadcrumbs:s(),numericFacetBreadcrumbs:o(),dateFacetBreadcrumbs:i(),staticFilterBreadcrumbs:u(),automaticFacetBreadcrumbs:m(),hasBreadcrumbs:C()}},deselectAll:()=>{t.deselectAll(),r(V({legacy:Il()}))}}}function rD(e){return e.addReducers({configuration:H,search:W,facetSet:ht,numericFacetSet:St,dateFacetSet:ur,categoryFacetSet:Jt}),!0}import{RecordValue as cD,Schema as uD}from"../bueno/v1.1.0/bueno.esm.js";import{ArrayValue as nD,isString as aD}from"../bueno/v1.1.0/bueno.esm.js";var oD=new nD({each:j,required:!0}),EA=(e,t)=>(F(e,j),aD(t)?F(t,j):F(t,oD),{payload:{contextKey:e,contextValue:t}}),xa=S("context/set",e=>{for(let[t,r]of Object.entries(e))EA(t,r);return{payload:e}}),Aa=S("context/add",e=>EA(e.contextKey,e.contextValue)),Fa=S("context/remove",e=>F(e,j));var td=$(ku(),e=>{e.addCase(xa,(t,r)=>{t.contextValues=r.payload}).addCase(Aa,(t,r)=>{t.contextValues[r.payload.contextKey]=r.payload.contextValue}).addCase(Fa,(t,r)=>{delete t.contextValues[r.payload]}).addCase(oe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.context.contextValues)})});var iD=["caseId","caseNumber"],sD={caseId:"caseContext",caseNumber:"caseContext"},oc=class extends Error{constructor(t){super(`The key "${t}" is reserved for internal use. Use ${sD[t]} to set this value.}`)}};function fg(e){return iD.includes(e)}var lD=new uD({values:new cD({options:{required:!1}})});function IA(e,t={}){if(!mD(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o=Ae(e,lD,t.initialState,"buildContext");return o.values&&n(xa(o.values)),{...r,get state(){return{values:a().context.contextValues}},set(i){n(xa(i))},...a().configuration.analytics.analyticsMode==="legacy"?dD(n):pD(n)}}var dD=e=>({add(t,r){e(Aa({contextKey:t,contextValue:r}))},remove(t){e(Fa(t))}}),pD=e=>({add(t,r){if(fg(t))throw new oc(t);e(Aa({contextKey:t,contextValue:r}))},remove(t){if(fg(t))throw new oc(t);e(Fa(t))}});function mD(e){return e.addReducers({context:td}),!0}function fD(e,t){return IA(e,t)}var ke=$(Ou(),e=>{e.addCase(Z,(t,r)=>({...t,...r.payload})).addCase(V.fulfilled,t=>{t.freezeFacetOrder=!1}).addCase(V.rejected,t=>{t.freezeFacetOrder=!1}).addCase(oe.fulfilled,(t,r)=>r.payload?.facetOptions??t).addCase(Yt,(t,r)=>{let{facetId:n,tabs:a}=r.payload;rd(a,t,n)}).addCase(rr,(t,r)=>{let{facetId:n,tabs:a}=r.payload;rd(a,t,n)}).addCase(ir,(t,r)=>{let{facetId:n,tabs:a}=r.payload;rd(a,t,n)}).addCase(lr,(t,r)=>{let{facetId:n,tabs:a}=r.payload;rd(a,t,n)}).addCase(Le,(t,r)=>{t.facets[r.payload].enabled=!0}).addCase(fe,(t,r)=>{t.facets[r.payload].enabled=!1}).addCase(ie,(t,r)=>{[...Object.keys(r.payload.f??{}),...Object.keys(r.payload.fExcluded??{}),...Object.keys(r.payload.cf??{}),...Object.keys(r.payload.nf??{}),...Object.keys(r.payload.df??{})].forEach(n=>{n in t||(t.facets[n]=hf()),t.facets[n].enabled=!0})})});function rd(e,t,r){let n={...hf(),tabs:e??{}};t.facets[r]=n}var gg=(e,t)=>typeof e=="object"&&Object.keys({...e}).length===0||!t||!e?!0:e.excluded?.includes(t)?!1:!!(e.included&&(e.included.length===0||e.included.includes(t)));import{isNullOrUndefined as gD}from"../bueno/v1.1.0/bueno.esm.js";var oi=$(ju(),e=>{e.addCase(Uo,(t,r)=>{let n=r.payload,{id:a}=n;a in t||(t[a]={...n,isActive:!1})}).addCase(kt,(t,r)=>{let n=r.payload;kA(t,n)}).addCase(so,(t,r)=>{let n=r.payload;kA(t,n)}).addCase(oe.fulfilled,(t,r)=>r.payload?.tabSet??t).addCase(ie,(t,r)=>{let n=r.payload.tab;gD(n)||Object.keys(t).forEach(a=>{t[a].isActive=a===n})})});function kA(e,t){t in e&&Object.keys(e).forEach(n=>{e[n].isActive=n===t})}function nd(e){if(!yD(e))throw N;let t=_(e),r=Y(n=>n.tabSet,n=>Object.values(n).find(o=>o.isActive)?.id??"");return{...t,get state(){return{activeTab:r(e.state)}}}}function yD(e){return e.addReducers({tabSet:oi}),!0}function hD(e,t){if(!SD(e))throw N;let r=nd(e),n=f=>e.state.facetOptions.facets[f]?.enabled??!1,a=f=>e.state.facetSet?.[f]?.request?.currentValues??e.state.categoryFacetSet?.[f]?.request?.currentValues??e.state.numericFacetSet?.[f]?.request?.currentValues??e.state.dateFacetSet?.[f]?.request?.currentValues??null,o=f=>f in e.state.facetOptions.facets,i=f=>e.state.facetOptions.facets[f]?.tabs,s=()=>Da({isFacetRegistered:o(t.facetId),parentFacets:t.conditions.map(({parentFacetId:f})=>o(f)?{enabled:n(f),values:a(f)}:null),isTabEnabled:gg(i(t.facetId),r.state.activeTab)}),c=()=>{let f=s();return f===m?!1:(m=f,!0)},u=()=>t.conditions.length>0?t.conditions.some(f=>{if(!n(f.parentFacetId))return!1;let C=a(f.parentFacetId);return C===null?!1:f.condition(C)}):!0,l=()=>{e.state.facetSet&&Object.entries(e.state.facetSet).forEach(([f,C])=>C.request.freezeCurrentValues&&e.dispatch(Tr({facetId:f,freezeCurrentValues:!1})))},p=()=>{if(!o(t.facetId))return;let f=n(t.facetId),C=u(),g=gg(i(t.facetId),r.state.activeTab),y=C&&g;f!==y&&(e.dispatch(y?Le(t.facetId):fe(t.facetId)),l())},m=s(),d=e.subscribe(()=>{c()&&p()});return p(),{stopWatching(){d()}}}function SD(e){return e.addReducers({facetOptions:ke}),!0}import{ArrayValue as CD,RecordValue as TA}from"../bueno/v1.1.0/bueno.esm.js";var ii=S("dictionaryFieldContext/set",e=>{let t=new TA({options:{required:!0}}),r=F(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),a=new CD({each:ce}),o=F(n,a).error;return o?{payload:e,error:o}:{payload:e}}),si=S("dictionaryFieldContext/add",e=>{let t=new TA({options:{required:!0},values:{field:ce,key:ce}});return F(e,t)}),ci=S("dictionaryFieldContext/remove",e=>F(e,ce));var ad=$(Tu(),e=>{e.addCase(ii,(t,r)=>{t.contextValues=r.payload}).addCase(si,(t,r)=>{let{field:n,key:a}=r.payload;t.contextValues[n]=a}).addCase(ci,(t,r)=>{delete t.contextValues[r.payload]}).addCase(oe.fulfilled,(t,r)=>{r.payload&&(t.contextValues=r.payload.dictionaryFieldContext.contextValues)})});function xD(e){if(!AD(e))throw N;let t=_(e),{dispatch:r}=e,n=()=>e.state;return{...t,get state(){return{values:n().dictionaryFieldContext.contextValues}},set(a){r(ii(a))},add(a,o){r(si({field:a,key:o}))},remove(a){r(ci(a))}}}function AD(e){return e.addReducers({dictionaryFieldContext:ad}),!0}var OA=Y(e=>e.queryCorrection.correctedQuery!==""||e.wasCorrectedTo!=="",e=>e);var od=()=>({correctedQuery:"",wordCorrections:[],originalQuery:""}),qA=()=>({correctedQuery:"",corrections:[],originalQuery:""});function DA(){return{enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:od(),originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"}}var jA=(e,t)=>{let r={...qA(),...t,correctedQuery:t?.correctedQuery||t?.corrections[0]?.correctedQuery||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery};var id=$(DA(),e=>{e.addCase(Ro,t=>{t.enableDidYouMean=!0}).addCase(Pu,t=>{t.enableDidYouMean=!1}).addCase(Eu,t=>{t.automaticallyCorrectQuery=!0}).addCase(bo,t=>{t.automaticallyCorrectQuery=!1}).addCase(V.pending,t=>{t.queryCorrection=od(),t.wasAutomaticallyCorrected=!1,t.wasCorrectedTo=""}).addCase(V.fulfilled,(t,r)=>{let{queryCorrection:n,queryCorrections:a}=r.payload.response;if(t.queryCorrectionMode==="legacy"){let o=a?.[0]?a[0]:od();t.queryCorrection=o}t.queryCorrectionMode==="next"&&jA(t,n),t.wasAutomaticallyCorrected=r.payload.automaticallyCorrected,t.originalQuery=r.payload.originalQuery}).addCase(ft,(t,r)=>{t.wasCorrectedTo=r.payload}).addCase(aa,(t,r)=>{t.queryCorrectionMode=r.payload})});function VA(e,t={}){if(!FD(e))throw N;let r=_(e),{dispatch:n}=e;n(Ro()),t.options?.automaticallyCorrectQuery===!1&&n(bo()),n(aa(t.options?.queryCorrectionMode||"next"));let a=()=>e.state,o=()=>OA(a().didYouMean);return{...r,get state(){let i=a();return{originalQuery:i.didYouMean.originalQuery,wasCorrectedTo:i.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:i.didYouMean.wasAutomaticallyCorrected,queryCorrection:i.didYouMean.queryCorrection,hasQueryCorrection:o()}},applyCorrection(){n(ft(this.state.queryCorrection.correctedQuery))},updateQueryCorrectionMode(i){n(aa(i))}}}function FD(e){return e.addReducers({configuration:H,didYouMean:id}),!0}function RD(e,t={}){let r=VA(e,t),{dispatch:n}=e;return{...r,get state(){return r.state},applyCorrection(){r.applyCorrection(),n(V({legacy:Iu(),next:pC()}))}}}function NA(e){if(!bD(e))throw N;let t=_(e),r=()=>e.state;return{...t,sort(n){return Vs(n,this.state.facetIds)},get state(){return{facetIds:r().search.response.facets.map(o=>o.facetId)}}}}function bD(e){return e.addReducers({search:W,facetOptions:ke}),!0}function vD(e){return NA(e)}var sd=$(Wa(),e=>{e.addCase(V.fulfilled,(t,r)=>{t.set={},r.payload.response.generateAutomaticFacets?.facets?.forEach(a=>{t.set[a.field]={response:a}})}).addCase($o,(t,r)=>{r.payload.desiredCount&&(t.desiredCount=r.payload.desiredCount),r.payload.numberOfValues&&(t.numberOfValues=r.payload.numberOfValues)}).addCase(Wt,(t,r)=>{let{field:n,selection:a}=r.payload,o=t.set[n]?.response;if(!o)return;let i=o.values.find(c=>c.value===a.value);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected"}).addCase(Go,(t,r)=>{let n=r.payload,a=t.set[n]?.response;if(a)for(let o of a.values)o.state="idle"}).addCase(ie,(t,r)=>{let n=r.payload.af??{},a=Object.keys(t.set);for(let o in n)if(!t.set[o]){let i=wD(o),s=n[o].map(c=>MA(c));i.values.push(...s),t.set[o]={response:i}}for(let o of a)if(!(o in n)){let i=t.set[o]?.response;for(let s of i.values)s.state="idle"}for(let o in n){let i=t.set[o]?.response;if(i){let s=i.values,c=new Set(n[o]);for(let u of s)c.has(u.value)?(u.state="selected",c.delete(u.value)):u.state="idle";for(let u of c)i.values.push(MA(u))}}}).addCase(oe.fulfilled,(t,r)=>{if(r.payload&&Object.keys(r.payload.automaticFacetSet.set).length!==0)return r.payload.automaticFacetSet}).addCase(be,t=>{Object.values(t.set).forEach(({response:r})=>{r.values.forEach(n=>{n.state="idle"})})})});function wD(e){return{field:e,values:[],moreValuesAvailable:!1,label:"",indexScore:0}}function MA(e){return{value:e,state:"selected",numberOfResults:0}}var cd=e=>e.state==="selected",ud=e=>e.state==="excluded",ld=(e,t)=>{let r={facetId:e,facetValue:t.value};return cd(t)?Ot(r):Se(r)},dd=e=>cd(e)?Dr():we(),QA=(e,t)=>{let r={facetId:e,facetValue:t.value};return ud(t)?Or(r):ot(r)},LA=e=>ud(e)?cA():qr();function UA(e,t){let{dispatch:r}=e,n=_(e),{field:a}=t;return{...n,toggleSelect(o){r(Wt({field:a,selection:o})),r(V({legacy:ld(a,o),next:dd(o)}))},deselectAll(){r(Go(a)),r(V({legacy:Ie(a),next:Ue()}))},get state(){let o=e.state.automaticFacetSet?.set[a]?.response;return o?{field:o.field,label:o.label,values:o.values}:{field:"",values:[],label:""}}}}function BA(e){return{desiredCount:e.desiredCount,numberOfValues:e.numberOfValues}}function PD(e,t){if(!ED(e))throw N;let{dispatch:r}=e,n=BA(t.options);return r($o(n)),{..._(e),get state(){return{automaticFacets:e.state.search.response.generateAutomaticFacets?.facets.map(i=>UA(e,{field:i.field}))??[]}}}}function ED(e){return e.addReducers({automaticFacetSet:sd,configuration:H,search:W}),!0}import{ArrayValue as kD,EnumValue as _A,RecordValue as $A,StringValue as GA}from"../bueno/v1.1.0/bueno.esm.js";var pd=(r=>(r.Relevance="relevance",r.Fields="fields",r))(pd||{}),yg=(r=>(r.Ascending="asc",r.Descending="desc",r))(yg||{});var JJ=new $A({options:{required:!1},values:{by:new _A({enum:pd,required:!0}),fields:new kD({each:new $A({values:{field:new GA({required:!0}),direction:new _A({enum:yg}),displayName:new GA}})})}});var qt=e=>e.error!==void 0;function HA(e,t="prod"){return`${Me(e,t)}/rest/organizations/${e}/commerce/v2`}var zA=e=>OD(e.cartItems,e.cart);function OD(e,t){let r=e.reduce((n,a)=>{let{productId:o,quantity:i}=t[a];return o in n||(n[o]={productId:o,quantity:0}),n[o].quantity+=i,n},{});return[...Object.values(r)]}var ui=(e,t)=>{let{view:r,location:n,...a}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.commerce.apiBaseUrl??HA(e.configuration.organizationId,e.configuration.environment),organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...a,...e.configuration.analytics.enabled?{clientId:t.clientId}:{},context:{user:{...n,...t.userAgent?{userAgent:t.userAgent}:{}},view:{...r,...t.referrer?{referrer:t.referrer}:{}},capture:t.capture??e.configuration.analytics.enabled,cart:zA(e.cart),source:Hr(e.configuration.analytics)}}};var WA=(e,t,r)=>({...ui(e,t),...qD(e,r)}),qD=(e,t)=>{let r=t?e.commercePagination?.recommendations[t]:e.commercePagination?.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};var Ct=(e,t)=>({...WA(e,t),facets:[...DD(e)],...e.commerceSort&&{sort:jD(e.commerceSort.appliedSort)}});function DD(e){return!e.facetOrder||!e.commerceFacetSet?[]:e.facetOrder.filter(t=>e.commerceFacetSet?.[t]).map(t=>e.manualNumericFacetSet?.[t]?.manualRange?{facetId:t,field:t,numberOfValues:1,isFieldExpanded:!1,preventAutoSelect:!0,type:"numericalRange",values:[e.manualNumericFacetSet[t].manualRange],initialNumberOfValues:1}:e.commerceFacetSet[t].request).filter(t=>t&&t.values.length>0)}function jD(e){return e.by==="relevance"?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map(({name:t,direction:r})=>({field:t,direction:r}))}}var YA=(e,t,r,n)=>{let a=t.categoryFacetSearchSet[e].options.query,o=`*${a}*`,i=t.commerceFacetSet[ic(e)]?.request,s=i&&VD(i)?i&&ND(i):[],c=s.length?[s]:[],u=r?a:t.commerceQuery?.query,l=t.categoryFacetSearchSet[e].options.numberOfValues,{url:p,accessToken:m,organizationId:d,trackingId:f,language:C,country:g,currency:y,clientId:x,context:h,...A}=Ct(t,n);return{url:p,accessToken:m,organizationId:d,facetId:ic(e),facetQuery:r?"*":o,numberOfValues:l,ignorePaths:c,trackingId:f,language:C,country:g,currency:y,clientId:x,context:h,query:u,...!r&&{...A}}};function VD(e){return e.type==="hierarchical"}var ND=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t};var KA=(e,t,r,n)=>{let a=t.facetSearchSet[e].options.query,o=t.facetSearchSet[e].options.numberOfValues,i=`*${a}*`,s=r?a:t.commerceQuery?.query,{url:c,accessToken:u,organizationId:l,trackingId:p,language:m,country:d,currency:f,clientId:C,context:g,...y}=Ct(t,n);return{url:c,accessToken:u,organizationId:l,facetId:ic(e),facetQuery:r?"*":i,numberOfValues:o,trackingId:p,language:m,country:d,currency:f,clientId:C,context:g,query:s,...!r&&{...y}}};var JA=e=>async({facetId:t,facetSearchType:r},{getState:n,extra:{validatePayload:a,navigatorContext:o,apiClient:i}})=>{let s=n();a(t,j);let c=MD(s,t)||QD(s,t)?KA(t,s,e,o):YA(t,s,e,o),u=await i.facetSearch(c,r);return{facetId:t,response:u}},An=G("commerce/facetSearch/executeSearch",JA(!1)),Fn=G("commerce/facetSearch/facetFieldSuggest",JA(!0)),MD=(e,t)=>"facetSearchSet"in e&&e.facetSearchSet[t]!==void 0&&e.commerceFacetSet[t]!==void 0,QD=(e,t)=>"fieldSuggestionsOrder"in e?e.fieldSuggestionsOrder.some(r=>r.facetId===t&&r.type==="regular"):!1,md="field_suggestion:";function ic(e){return e.startsWith(md)?e.slice(md.length):e}function Rn(e){return e.startsWith(md)?e:`${md}${e}`}import{RecordValue as BD,StringValue as _D}from"../bueno/v1.1.0/bueno.esm.js";var fd=Y(e=>e.commercePagination?.principal.perPage||0,e=>e),j8=Y((e,t)=>e.commercePagination?.recommendations[t]?.perPage||0,e=>e),gd=Y(e=>e.commercePagination?.principal.totalEntries||0,e=>e),V8=Y((e,t)=>e.commercePagination?.recommendations[t]?.totalEntries||0,e=>e),N8=Y(e=>e.commercePagination?.principal.page||0,e=>e),M8=Y((e,t)=>e.commercePagination?.recommendations[t]?.page||0,e=>e);import{isNullOrUndefined as UD}from"../bueno/v1.1.0/bueno.esm.js";var LD="coveo-headless-internal-state",bn=Symbol.for(LD);var G8=Y(e=>e[bn].productListing.responseId,e=>e),H8=Y(e=>e.productListing.responseId,e=>e),z8=Y(e=>e.productListing.requestId,e=>e),hg=Y(e=>e.productListing?.products.length||0,e=>e),XA=Y(e=>({total:gd(e),current:hg(e)}),({current:e,total:t})=>e<t),W8=Y(e=>e.productListing?.isLoading,e=>UD(e)?!1:e),Y8=Y(e=>e.productListing?.error,e=>e??null);var li=G("commerce/productListing/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let o=t(),i=await n.getProductListing(Ct(o,a));return qt(i)?r(i.error):{response:i.success}}),a5=G("commerce/productListing/fetchMoreProducts",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let o=t();if(!XA(o))return null;let s=fd(o),u=hg(o)/s,l=await n.getProductListing({...Ct(o,a),page:u});return qt(l)?r(l.error):{response:l.success}}),$D={child:new BD({options:{required:!0},values:{permanentid:new _D({required:!0})}})},o5=S("commerce/productListing/promoteChildToParent",e=>F(e,$D));import{NumberValue as GD}from"../bueno/v1.1.0/bueno.esm.js";var ZA=(e,t,r)=>({...ui(t,r),query:t.querySet[e]});var eF=S("commerce/querySuggest/clear",e=>F(e,{id:j})),vn=G("commerce/querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a,navigatorContext:o}})=>{a(e,{id:j});let i=t(),s=ZA(e.id,i,o),c=await n.querySuggest(s);return qt(c)?r(c.error):{id:e.id,query:s.query,...c.success}}),tF=S("commerce/querySuggest/register",e=>F(e,{id:j,count:new GD({min:0})})),rF=S("commerce/querySuggest/selectSuggestion",e=>F(e,{id:j,expression:ce}));import{BooleanValue as XD,RecordValue as ZD,StringValue as fF}from"../bueno/v1.1.0/bueno.esm.js";import{BooleanValue as Sg,NumberValue as HD}from"../bueno/v1.1.0/bueno.esm.js";var S5=S("commerce/facets/core/updateNumberOfValues",e=>F(e,{facetId:j,numberOfValues:new HD({required:!0,min:1})})),C5=S("commerce/facets/core/updateIsFieldExpanded",e=>F(e,{facetId:j,isFieldExpanded:new Sg({required:!0})})),x5=S("commerce/facets/core/clearAll"),nF=S("commerce/facets/core/deleteAll"),A5=S("commerce/facets/core/deselectAllValues",e=>F(e,{facetId:j})),F5=S("commerce/facets/core/updateFreezeCurrentValues",e=>F(e,{facetId:j,freezeCurrentValues:new Sg({required:!0})})),aF=S("commerce/facets/core/updateAutoSelectionForAll",e=>F(e,{allow:new Sg({required:!0})}));import{NumberValue as oF}from"../bueno/v1.1.0/bueno.esm.js";var yd={slotId:Hy},zD={...yd,pageSize:new oF({required:!0,min:0})},P5=S("commerce/pagination/setPageSize",e=>F(e,zD)),WD={...yd,page:new oF({required:!0,min:0})},iF=S("commerce/pagination/selectPage",e=>F(e,WD)),E5=S("commerce/pagination/nextPage",e=>F(e,yd)),I5=S("commerce/pagination/previousPage",e=>F(e,yd)),k5=S("commerce/pagination/registerRecommendationsSlot",e=>F(e,{slotId:j}));import{StringValue as YD}from"../bueno/v1.1.0/bueno.esm.js";var hd=S("commerce/query/update",e=>F(e,{query:new YD}));import{isNullOrUndefined as mF}from"../bueno/v1.1.0/bueno.esm.js";import{RecordValue as KD,StringValue as JD}from"../bueno/v1.1.0/bueno.esm.js";var sF=S("commerce/triggers/query/updateIgnore",e=>F(e,{q:new JD({emptyAllowed:!0,required:!0})})),cF=S("commerce/triggers/query/applyModification",e=>F(e,new KD({values:{originalQuery:me,modification:me}})));import{isNullOrUndefined as lF}from"../bueno/v1.1.0/bueno.esm.js";function Cg(e,t,r){if(e===void 0)return{};let n=t(e);return n!==r?{q:n}:{}}function xg(e,t,r){if(e===void 0)return{};let n=t(e);return n!==r?{sortCriteria:n}:{}}function Ra(e,t,r,n){if(e===void 0)return{};let a=Object.entries(e).filter(([o])=>t(o)).map(([o,{request:i}])=>{let s=r(i);return s.length?{[o]:s}:{}}).reduce((o,i)=>({...o,...i}),{});return Object.keys(a).length?{[n]:a}:{}}function uF(e,t,r){if(e===void 0)return{};let n=t(e);return n!==r?{tab:n}:{}}var s9=Y(e=>e[bn].commerceSearch.responseId,e=>e),c9=Y(e=>e.commerceSearch.responseId,e=>e),u9=Y(e=>e.commerceSearch.requestId,e=>e),Ag=Y(e=>e.commerceSearch?.products.length||0,e=>e),dF=Y(e=>({total:gd(e),current:Ag(e)}),({current:e,total:t})=>e<t),l9=Y(e=>e.commerceSearch?.isLoading,e=>lF(e)?!1:e),d9=Y(e=>e.commerceSearch?.error,e=>e??null),Sd=Y(e=>e.commerceQuery?.query,e=>e??""),p9=Y(e=>e.commerceSearch?.queryExecuted,e=>e),pF=(e,t)=>lF(t.queryCorrection?.correctedQuery)?Sd(e):t.queryCorrection.correctedQuery;var sc=class{constructor(t){this.config=t}async process(t){return this.processQueryErrorOrContinue(t)??await this.processQueryCorrectionsOrContinue(t)??await this.processQueryTriggersOrContinue(t)??this.processSuccessResponse(t)}async fetchFromAPI(t){let r=Date.now(),n=await this.extra.apiClient.search(t),a=Date.now()-r,o=this.getState().commerceQuery.query||"";return{response:n,duration:a,queryExecuted:o,requestExecuted:t}}processSuccessResponse(t){return{...t,response:this.getSuccessResponse(t),originalQuery:this.getCurrentQuery()}}processQueryErrorOrContinue(t){return qt(t.response)?this.rejectWithValue(t.response.error):null}async processQueryCorrectionsOrContinue(t){let r=this.getState(),n=this.getSuccessResponse(t);if(!n||!r.didYouMean)return null;let{queryCorrection:a}=n;if(!(!mF(a)&&!mF(a.correctedQuery)))return null;let{correctedQuery:i,originalQuery:s}=n.queryCorrection;return this.onUpdateQueryForCorrection(i??""),{...t,response:{...n},queryExecuted:pF(r,n),originalQuery:s??""}}async processQueryTriggersOrContinue(t){let r=this.getSuccessResponse(t);if(!r)return null;let n=r.triggers.find(s=>s.type==="query")?.content||"";if(!n)return null;if(this.getState().triggers?.queryModification.queryToIgnore===n)return this.dispatch(sF({q:""})),null;let o=this.getCurrentQuery(),i=await this.automaticallyRetryQueryWithTriggerModification(n);return qt(i.response)?this.rejectWithValue(i.response.error):{...i,response:{...i.response.success},originalQuery:o}}async automaticallyRetryQueryWithTriggerModification(t){return this.dispatch(cF({newQuery:t,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(t),await this.fetchFromAPI({...Ct(this.getState(),this.navigatorContext),query:t})}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getState(){return this.config.getState()}get navigatorContext(){return this.config.extra.navigatorContext}getCurrentQuery(){let t=this.getState();return t.commerceQuery.query!==void 0?t.commerceQuery.query:""}getSuccessResponse(t){return qt(t.response)?null:t.response.success}get extra(){return this.config.extra}onUpdateQueryForCorrection(t){this.dispatch(hd({query:t}))}};var wn=G("commerce/search/executeSearch",async(e,t)=>{let{getState:r}=t,n=r(),{navigatorContext:a}=t.extra,o=Ct(n,a),i=Sd(n),s=new sc(t),c=await s.fetchFromAPI({...o,query:i});return s.process(c)}),q9=G("commerce/search/fetchMoreProducts",async(e,t)=>{let{getState:r}=t,n=r(),{navigatorContext:a}=t.extra;if(!dF(n))return null;let i=fd(n),c=Ag(n)/i,u=Sd(n),l=Ct(n,a),p=new sc(t),m=await p.fetchFromAPI({...l,query:u,page:c});return p.process(m)}),D9=G("commerce/search/prepareForSearchWithQuery",(e,t)=>{let{dispatch:r}=t;F(e,{query:new fF,clearFilters:new XD}),e.clearFilters&&r(nF()),r(aF({allow:!0})),r(hd({query:e.query})),r(iF({page:0}))}),j9=G("commerce/search/fetchInstantProducts",async(e,{getState:t,rejectWithValue:r,extra:n})=>{let a=t(),{apiClient:o,navigatorContext:i}=n,{q:s}=e,c=await o.productSuggestions({...ui(a,i),query:s});return qt(c)?r(c.error):{response:{...c.success,products:c.success.products}}}),ej={child:new ZD({options:{required:!0},values:{permanentid:new fF({required:!0})}})},V9=S("commerce/search/promoteChildToParent",e=>F(e,ej));function cc(e,t,r){let{facetId:n}=t;if(e[n])return;let a=!1,o={...Ze,...t},i=r();e[n]={options:o,isLoading:a,response:i,initialNumberOfValues:o.numberOfValues,requestId:""}}function Cd(e,t){let{facetId:r,...n}=t,a=e[r];a&&(a.options={...a.options,...n})}function Pn(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function En(e,t){let r=e[t];r&&(r.isLoading=!1)}function xd(e,t,r){let{facetId:n,response:a}=t,o=e[n];o&&o.requestId===r&&(o.isLoading=!1,o.response=a)}function Ad(e,t,r){let{facetId:n,response:a}=t,o=e[n];o&&o.requestId===r&&(o.isLoading=!1,"success"in a&&(o.response=a.success))}function Fd(e,t,r,n){let{facetId:a,response:o}=t,i=Rn(a),s=e[i];if(!s)cc(e,{facetId:i},n),s=e[i];else if(s.requestId!==r)return;s.isLoading=!1,"success"in o&&(s.response=o.success)}function gF(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||a.type!=="regular"||(e[a.facetId]={options:{...Ze,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ze.numberOfValues,requestId:r})}function yF(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets){let o=Rn(a.facetId);o in e||a.type!=="hierarchical"||(e[o]={options:{...Ze,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:Ze.numberOfValues,requestId:r})}}function uc(e,t,r){let{facetId:n}=t,a=e[n];a&&(a.requestId="",a.isLoading=!1,a.response=r(),a.options.numberOfValues=a.initialNumberOfValues,a.options.query=Ze.query)}function Qr(e,t){Object.keys(e).forEach(r=>uc(e,{facetId:r},t))}var Ze={captions:{},numberOfValues:10,query:""};var hF=async(e,t,r,n)=>{let a=t.categoryFacetSearchSet[e].options,o=t.categoryFacetSet[e].request,{captions:i,query:s,numberOfValues:c}=a,{field:u,delimitingCharacter:l,basePath:p,filterFacetCount:m}=o,d=tj(o),f=d.length?[d]:[],C=`*${s}*`;return{url:t.configuration.search.apiBaseUrl??Pe(t.configuration.organizationId,t.configuration.environment),accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:p,captions:i,numberOfValues:c,query:C,field:u,delimitingCharacter:l,ignorePaths:f,filterFacetCount:m,type:"hierarchical",...n?{}:{searchContext:(await yt(t,r)).request}}},tj=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t};var SF=async(e,t,r,n)=>{let{captions:a,query:o,numberOfValues:i}=t.facetSearchSet[e].options,{field:s,currentValues:c,filterFacetCount:u}=t.facetSet[e].request,l=c.filter(m=>m.state!=="idle").map(m=>m.value),p=`*${o}*`;return{url:t.configuration.search.apiBaseUrl??Pe(t.configuration.organizationId,t.configuration.environment),accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:a,numberOfValues:i,query:p,field:s,ignoreValues:l,filterFacetCount:u,type:"specific",...n?{}:{searchContext:(await yt(t,r)).request}}};var CF=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a,navigatorContext:o}})=>{let i=r(),s;a(t,j),rj(i,t)?s=await SF(t,i,o,e):s=await hF(t,i,o,e);let c=await n.facetSearch(s);return{facetId:t,response:c}},Te=G("facetSearch/executeSearch",CF(!1)),mr=G("facetSearch/executeSearch",CF(!0)),di=S("facetSearch/clearResults",e=>F(e,{facetId:K})),rj=(e,t)=>e.facetSearchSet!==void 0&&e.facetSet!==void 0&&e.facetSet[t]!==void 0;function xF(){return{}}var pi=$(xF(),e=>{e.addCase(Yo,(t,r)=>{let n=r.payload;cc(t,n,ba)}).addCase(Sn,(t,r)=>{Cd(t,r.payload)}).addCase(An.pending,(t,r)=>{let{facetId:n}=r.meta.arg;Pn(t,n,r.meta.requestId)}).addCase(Fn.pending,(t,r)=>{let{facetId:n}=r.meta.arg;Pn(t,n,r.meta.requestId)}).addCase(Te.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId)}).addCase(An.rejected,(t,r)=>{let{facetId:n}=r.meta.arg;En(t,n)}).addCase(Fn.rejected,(t,r)=>{let{facetId:n}=r.meta.arg;En(t,Rn(n))}).addCase(Te.rejected,(t,r)=>{let n=r.meta.arg;En(t,n)}).addCase(An.fulfilled,(t,r)=>{Ad(t,r.payload,r.meta.requestId)}).addCase(Fn.fulfilled,(t,r)=>{Fd(t,r.payload,r.meta.requestId,ba)}).addCase(vn.fulfilled,(t,r)=>{yF(t,r.payload,r.meta.requestId,ba)}).addCase(Te.fulfilled,(t,r)=>{xd(t,r.payload,r.meta.requestId)}).addCase(di,(t,{payload:{facetId:r}})=>{uc(t,{facetId:r},ba)}).addCase(li.fulfilled,t=>Qr(t,ba)).addCase(wn.fulfilled,t=>Qr(t,ba)).addCase(V.fulfilled,t=>{Qr(t,ba)})});function ba(){return{moreValuesAvailable:!1,values:[]}}var fr=(e,t)=>e.facetOptions.facets[t]?.enabled??!0;function AF(e,t){let{field:r,state:n}=e;if(!nj(e))return r;let a=`${r}_`,o=aj(a,n);return ij(r,t),`${a}${o}`}function nj(e){let{field:t,state:r}=e;return FF(r).some(a=>a&&t in a)}function aj(e,t){let n=FF(t).map(a=>Object.keys(a||{})).reduce((a,o)=>a.concat(o),[]);return oj(n,e)+1}function FF(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:a}=e;return[t,r,n,a]}function oj(e,t){return e.map(o=>{let i=o.split(t)[1],s=parseInt(i,10);return Number.isNaN(s)?0:s}).sort().pop()??0}function ij(e,t){let r=`A facet with field "${e}" already exists.
  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}function Be(e,t){let{state:r,logger:n}=e,{field:a,facetId:o}=t;return o||AF({field:a,state:r},n)}import{ArrayValue as bF,RecordValue as sj,Schema as cj,StringValue as Fg}from"../bueno/v1.1.0/bueno.esm.js";var RF=["alphanumeric","occurrences"];var vF=new cj({field:Zt,tabs:new sj({options:{required:!1},values:{included:new bF({each:new Fg}),excluded:new bF({each:new Fg})}}),basePath:nA,delimitingCharacter:aA,facetId:Xt,facetSearch:Jo,filterByBasePath:oA,filterFacetCount:er,injectionDepth:tr,numberOfValues:Tt,sortCriteria:new Fg({constrainTo:RF})});function wF(e,t){if(!uj(e))throw N;let r=_(e),{dispatch:n}=e,a=Be(e,t.options),o=t.options.tabs??{},i=He(e.state.tabSet),s={...Zs,...Pc("facetSearch",t.options),field:t.options.field,facetId:a,tabs:o,activeTab:i},c={facetSearch:{...Ze,...t.options.facetSearch},...s};ue(e,vF,c,"buildCategoryFacet");let u=()=>Qm(e.state,a),l=()=>Mm(e.state,a),p=()=>Lt(e.state),m=()=>fr(e.state,a);return n(Yt(s)),{...r,toggleSelect(d){let f=c.numberOfValues;n(yn({facetId:a,selection:d,retrieveCount:f})),n(Z())},deselectAll(){n(Kt(a)),n(Z())},sortBy(d){n(zo({facetId:a,criterion:d})),n(Z())},isSortedBy(d){return u().sortCriteria===d},showMoreValues(){let{numberOfValues:d}=c,{activeValue:f,valuesAsTrees:C}=this.state,g=(f?.children.length??C.length)+d;n(la({facetId:a,numberOfValues:g})),n(Z())},showLessValues(){let{numberOfValues:d}=c;n(la({facetId:a,numberOfValues:d})),n(Z())},enable(){n(Le(a))},disable(){n(fe(a))},get state(){let d=u(),f=l(),C=p(),g=m(),y=f?.values??[],x=y.some(k=>k.children.length>0)??!1,{parents:h,values:A}=pS(f?.values),E=Ke(y),v=E.length?E[E.length-1]:void 0,R=!!v,b=v?.moreValuesAvailable??f?.moreValuesAvailable??!1,w=v?v.children.length>c.numberOfValues:y.length>c.numberOfValues;return{facetId:a,parents:h,selectedValueAncestry:E,values:A,isHierarchical:x,valuesAsTrees:y,activeValue:v,isLoading:C,hasActiveValues:R,canShowMoreValues:b,canShowLessValues:w,sortCriteria:d.sortCriteria,enabled:g}}}}function uj(e){return e.addReducers({categoryFacetSet:Jt,categoryFacetSearchSet:pi,facetOptions:ke,configuration:H,search:W}),!0}function mi(e,t){let r=e.dispatch,{options:n,getFacetSearch:a,executeFacetSearchActionCreator:o,executeFieldSuggestActionCreator:i}=t,{facetId:s}=n;return{updateText(c){r(Sn({facetId:s,query:c,numberOfValues:a().initialNumberOfValues}))},showMoreResults(){let{initialNumberOfValues:c,options:u}=a();r(Sn({facetId:s,numberOfValues:u.numberOfValues+c})),r(t.isForFieldSuggestions?i(s):o(s))},search(){r(t.isForFieldSuggestions?i(s):o(s))},clear(){r(di({facetId:s}))},updateCaptions(c){r(Sn({facetId:s,captions:c}))},get state(){let{response:c,isLoading:u,options:l}=a(),{query:p}=l,m=c.values;return{...c,values:m,isLoading:u,query:p}}}}function PF(e,t){let{dispatch:r}=e,n={...Ze,...t.options},{facetId:a}=n,o=()=>"state"in e?e.state.categoryFacetSearchSet[a]:e[bn].categoryFacetSearchSet[a];r(Yo(n));let i=mi(e,{options:n,getFacetSearch:o,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return{...i,select(s){r(Wo({facetId:a,value:s})),t.select(s)},get state(){return i.state}}}function Rd(e,t){let{executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:o}=t,{dispatch:i}=e,s={...Ze,...t.options},{facetId:c}=s,u=()=>e.state.categoryFacetSearchSet[c],l=PF(e,{options:{...s},executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:o});i(Yo(s));let p=mi(e,{options:s,getFacetSearch:u,isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:Te,executeFieldSuggestActionCreator:mr});return{...p,...l,get state(){return{...p.state,...l.state}}}}function lj(e,t){if(!dj(e))throw N;let r=wF(e,t),{dispatch:n}=e,a=()=>r.state.facetId,o=Rd(e,{options:{facetId:a(),...t.options.facetSearch},executeFacetSearchActionCreator:Te,executeFieldSuggestActionCreator:mr,select:c=>{n(Z()),n(V({legacy:Se({facetId:a(),facetValue:c.rawValue}),next:we()}))},isForFieldSuggestions:!1}),{state:i,...s}=o;return{...r,facetSearch:s,toggleSelect(c){r.toggleSelect(c),n(V({legacy:pj(a(),c),next:mj(c)}))},deselectAll(){r.deselectAll(),n(V({legacy:Ie(a()),next:Ue()}))},sortBy(c){r.sortBy(c),n(V({legacy:or({facetId:a(),criterion:c})}))},showMoreValues(){r.showMoreValues(),n(zt({legacy:Zo(a())}))},showLessValues(){r.showLessValues(),n(zt({legacy:ei(a())}))},get state(){return{...r.state,facetSearch:o.state}}}}function dj(e){return e.addReducers({categoryFacetSet:Jt,categoryFacetSearchSet:pi,configuration:H,search:W}),!0}function pj(e,t){let r={facetId:e,facetValue:t.value};return t.state==="selected"?Ot(r):Se(r)}function mj(e){return e.state==="selected"?Dr():we()}import{NumberValue as EF,RecordValue as IF,Schema as fj,StringValue as gj}from"../bueno/v1.1.0/bueno.esm.js";var yj=Intl.supportedValuesOf("currency"),hj=new gj({required:!0,emptyAllowed:!1,constrainTo:yj}),Rg={url:j},bg={latitude:new EF({min:-90,max:90,required:!0}),longitude:new EF({min:-180,max:180,required:!0})},vg={language:j,country:j,currency:hj,view:new IF({options:{required:!0},values:Rg}),location:new IF({options:{required:!1},values:bg})},f7=new fj(vg);var kF=S("commerce/context/set",e=>F(e,vg)),bd=S("commerce/context/setView",e=>F(e,Rg)),C7=S("commerce/context/setLocation",e=>F(e,bg));function TF(){return{}}var fi=$(TF(),e=>{e.addCase(Pl,(t,r)=>{let n=r.payload;cc(t,n,In)}).addCase(Sn,(t,r)=>{Cd(t,r.payload)}).addCase(An.pending,(t,r)=>{let{facetId:n}=r.meta.arg;Pn(t,n,r.meta.requestId)}).addCase(Fn.pending,(t,r)=>{let{facetId:n}=r.meta.arg;Pn(t,Rn(n),r.meta.requestId)}).addCase(Te.pending,(t,r)=>{let n=r.meta.arg;Pn(t,n,r.meta.requestId)}).addCase(An.rejected,(t,r)=>{let{facetId:n}=r.meta.arg;En(t,n)}).addCase(Fn.rejected,(t,r)=>{let{facetId:n}=r.meta.arg;En(t,Rn(n))}).addCase(Te.rejected,(t,r)=>{let n=r.meta.arg;En(t,n)}).addCase(An.fulfilled,(t,r)=>{Ad(t,r.payload,r.meta.requestId)}).addCase(Fn.fulfilled,(t,r)=>{Fd(t,r.payload,r.meta.requestId,In)}).addCase(vn.fulfilled,(t,r)=>{gF(t,r.payload,r.meta.requestId,In)}).addCase(Te.fulfilled,(t,r)=>{xd(t,r.payload,r.meta.requestId)}).addCase(di,(t,{payload:r})=>{uc(t,r,In)}).addCase(V.fulfilled,t=>{Qr(t,In)}).addCase(li.fulfilled,t=>Qr(t,In)).addCase(wn.fulfilled,t=>Qr(t,In)).addCase(bd,t=>Qr(t,In))});function In(){return{moreValuesAvailable:!1,values:[]}}import{RecordValue as Sj}from"../bueno/v1.1.0/bueno.esm.js";var OF={facetId:K,selection:new Sj({values:ua})},qF=G("facet/executeToggleSelect",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},OF),n(nr({facetId:e,selection:t})),n(Z())}),DF=G("facet/executeToggleExclude",({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},OF),n(ar({facetId:e,selection:t})),n(Z())});import{ArrayValue as jF,RecordValue as Cj,Schema as xj,StringValue as wd}from"../bueno/v1.1.0/bueno.esm.js";var gi=["allValues","atLeastOneValue"];var vd=["score","alphanumeric","alphanumericDescending","occurrences","automatic","alphanumericNatural","alphanumericNaturalDescending"];var VF=new xj({facetId:Xt,tabs:new Cj({options:{required:!1},values:{included:new jF({each:new wd}),excluded:new jF({each:new wd})}}),field:Zt,filterFacetCount:er,injectionDepth:tr,numberOfValues:Tt,sortCriteria:new wd({constrainTo:vd}),resultsMustMatch:new wd({constrainTo:gi}),facetSearch:Jo});function NF(e,t,r=VF){if(!Aj(e))throw N;let{dispatch:n}=e,a=_(e),o=Be(e,t.options),i=t.options.tabs??{},s=He(e.state.tabSet),c={...ec,...Pc("facetSearch",t.options),field:t.options.field,facetId:o,tabs:i,activeTab:s},u={facetSearch:{...Ze,...t.options.facetSearch},...c};ue(e,r,u,"buildFacet");let l=()=>Nm(e.state,o),p=()=>bs(e.state,o),m=()=>Lt(e.state),d=()=>fr(e.state,o),f=()=>{let{currentValues:g}=l();return g.filter(y=>y.state!=="idle").length},C=()=>{let{currentValues:g}=l(),y=u.numberOfValues,x=!!g.find(h=>h.state==="idle");return y<g.length&&x};return n(rr(c)),{...a,toggleSelect:g=>n(qF({facetId:u.facetId,selection:g})),toggleExclude:g=>n(DF({facetId:u.facetId,selection:g})),toggleSingleSelect:function(g){g.state==="idle"&&n(ge(o)),this.toggleSelect(g)},toggleSingleExclude:function(g){g.state==="idle"&&n(ge(o)),this.toggleExclude(g)},isValueSelected:cd,isValueExcluded:ud,deselectAll(){n(ge(o)),n(Z())},sortBy(g){n(Xo({facetId:o,criterion:g})),n(Z())},isSortedBy(g){return this.state.sortCriterion===g},showMoreValues(){let g=l().numberOfValues,y=u.numberOfValues,x=y-g%y,h=g+x;n(da({facetId:o,numberOfValues:h})),n(pa({facetId:o,isFieldExpanded:!0})),n(Z())},showLessValues(){let g=u.numberOfValues,y=Math.max(g,f());n(da({facetId:o,numberOfValues:y})),n(pa({facetId:o,isFieldExpanded:!1})),n(Z())},enable(){n(Le(o))},disable(){n(fe(o))},get state(){let g=l(),y=p(),x=m(),h=d(),A;typeof g.sortCriteria=="object"?A=g.sortCriteria.order==="descending"?"alphanumericDescending":"alphanumeric":A=g.sortCriteria;let E=y?y.values:[],v=E.some(w=>w.state!=="idle"),R=y?y.moreValuesAvailable:!1,b=g.resultsMustMatch;return{label:y?.label,facetId:o,tabs:i,values:E,sortCriterion:A,resultsMustMatch:b,isLoading:x,hasActiveValues:v,canShowMoreValues:R,canShowLessValues:C(),enabled:h}}}}function Aj(e){return e.addReducers({facetSet:ht,facetOptions:ke,configuration:H,facetSearchSet:fi}),!0}function Pd(e,t){let{dispatch:r}=e,{options:n,select:a,exclude:o,isForFieldSuggestions:i,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c}=t,{facetId:u}=n,l=()=>"state"in e?e.state.facetSearchSet[u]:e[bn].facetSearchSet[u];r(Pl(n));let p=mi(e,{options:n,getFacetSearch:l,isForFieldSuggestions:i,executeFacetSearchActionCreator:s,executeFieldSuggestActionCreator:c});return{...p,select(m){r(ma({facetId:u,value:m})),a(m)},exclude(m){r(fa({facetId:u,value:m})),o(m)},singleSelect(m){r(ge(u)),r(ma({facetId:u,value:m})),a(m)},singleExclude(m){r(ge(u)),r(fa({facetId:u,value:m})),o(m)},get state(){let{values:m}=p.state;return{...p.state,values:m.map(({count:d,displayValue:f,rawValue:C})=>({count:d,displayValue:f,rawValue:C}))}}}}import{ArrayValue as MF,RecordValue as Fj,Schema as Rj,StringValue as Ed}from"../bueno/v1.1.0/bueno.esm.js";var QF=new Rj({facetId:Xt,field:Zt,tabs:new Fj({options:{required:!1},values:{included:new MF({each:new Ed}),excluded:new MF({each:new Ed})}}),filterFacetCount:er,injectionDepth:tr,numberOfValues:Tt,sortCriteria:new Ed({constrainTo:vd}),resultsMustMatch:new Ed({constrainTo:gi}),facetSearch:Jo,allowedValues:Rl,hasBreadcrumbs:iA,customSort:bl});function bj(e,t){if(!vj(e))throw N;let{dispatch:r}=e,n=NF(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},QF),a=()=>n.state.facetId,i=(()=>{let{facetSearch:u}=t.options;return Pd(e,{options:{facetId:a(),...u},select:l=>{r(Z()),r(V({legacy:Se({facetId:a(),facetValue:l.rawValue}),next:we()}))},exclude:l=>{r(Z()),r(V({legacy:ot({facetId:a(),facetValue:l.rawValue}),next:qr()}))},isForFieldSuggestions:!1,executeFacetSearchActionCreator:Te,executeFieldSuggestActionCreator:mr})})(),{state:s,...c}=i;return{...n,facetSearch:c,toggleSelect(u){n.toggleSelect(u),r(V({legacy:ld(a(),u),next:dd(u)}))},toggleExclude(u){n.toggleExclude(u),r(V({legacy:QA(a(),u),next:LA(u)}))},deselectAll(){n.deselectAll(),r(V({legacy:Ie(a()),next:Ue()}))},sortBy(u){n.sortBy(u),r(V({legacy:or({facetId:a(),criterion:u})}))},isSortedBy(u){return this.state.sortCriterion===u},showMoreValues(){n.showMoreValues(),r(zt({legacy:Zo(a())}))},showLessValues(){n.showLessValues(),r(zt({legacy:ei(a())}))},get state(){return{...n.state,facetSearch:i.state}}}}function vj(e){return e.addReducers({facetSet:ht,configuration:H,facetSearchSet:fi,search:W}),!0}var Id=e=>e.state==="selected",wg=e=>e.state==="excluded",kd=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return Id(t)?Ot(n):Se(n)},Td=e=>Id(e)?Dr():we(),LF=(e,t)=>{let r=`${t.start}..${t.end}`,n={facetId:e,facetValue:r};return wg(t)?Or(n):ot(n)};import{RecordValue as wj}from"../bueno/v1.1.0/bueno.esm.js";var Od=S("rangeFacet/executeToggleSelect",e=>F(e,Sa(e.selection))),qd=S("rangeFacet/executeToggleExclude",e=>F(e,Sa(e.selection)));var UF={facetId:K,selection:new wj({values:ha})},BF=G("dateFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,UF),t(sr(e)),t(Od(e)),t(Z())}),_F=G("dateFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,UF),t(cr(e)),t(qd(e)),t(Z())});function Dd(e,t){if(!e.generateAutomaticRanges&&e.currentValues===void 0){let r=`currentValues should be specified for ${t} when generateAutomaticRanges is false.`;throw new Error(r)}}function jd(e,t){let{facetId:r,getRequest:n}=t,a=_(e),o=e.dispatch,i=()=>fr(e.state,r);return{...a,isValueSelected:Id,isValueExcluded:wg,deselectAll(){o(ge(r)),o(Z())},sortBy(s){o(ri({facetId:r,criterion:s})),o(Z())},isSortedBy(s){return this.state.sortCriterion===s},enable(){o(Le(r))},disable(){o(fe(r))},get state(){let s=n(),c=Qt(e.state,r),u=s.sortCriteria,l=s.resultsMustMatch,p=c?c.values:[],m=Lt(e.state),d=i(),f=p.some(g=>g.state!=="idle"),C=c?.domain;return{facetId:r,values:p,sortCriterion:u,resultsMustMatch:l,hasActiveValues:f,isLoading:m,enabled:d,domain:C}}}}import{ArrayValue as Pg,BooleanValue as Pj,RecordValue as $F,Schema as Ej,StringValue as va}from"../bueno/v1.1.0/bueno.esm.js";var Vd=["idle","selected","excluded"];var Nd=["ascending","descending"],Md=["even","equiprobable"];var Ij={start:new va,end:new va,endInclusive:new Pj,state:new va({constrainTo:Vd})},kj=new Ej({facetId:Xt,field:Zt,tabs:new $F({options:{required:!1},values:{included:new Pg({each:new va}),excluded:new Pg({each:new va})}}),generateAutomaticRanges:Fl,filterFacetCount:er,injectionDepth:tr,numberOfValues:Tt,currentValues:new Pg({each:new $F({values:Ij})}),sortCriteria:new va({constrainTo:Nd}),rangeAlgorithm:new va({constrainTo:Md})});function Qd(e,t){ue(e,kj,t,"buildDateFacet"),Ol(t)}function GF(e,t){if(!Tj(e))throw N;Dd(t.options,"buildDateFacet");let r=e.dispatch,n=Be(e,t.options),a=t.options.tabs??{},o=He(e.state.tabSet),i={currentValues:[],...t.options,facetId:n,tabs:a,activeTab:o};Qd(e,i),r(ir(i));let s=jd(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return{...s,toggleSelect:c=>r(BF({facetId:n,selection:c})),toggleSingleSelect:function(c){c.state==="idle"&&r(ge(n)),this.toggleSelect(c)},toggleExclude:c=>r(_F({facetId:n,selection:c})),toggleSingleExclude:function(c){c.state==="idle"&&r(ge(n)),this.toggleExclude(c)},get state(){return s.state}}}function Tj(e){return e.addReducers({configuration:H,search:W,dateFacetSet:ur,facetOptions:ke}),!0}function Oj(e,t){let r=GF(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(V({legacy:Ie(a()),next:Ue()}))},sortBy(o){r.sortBy(o),n(V({legacy:or({facetId:a(),criterion:o})}))},toggleSelect:o=>{r.toggleSelect(o),n(V({legacy:kd(a(),o),next:Td(o)}))},toggleExclude:o=>{r.toggleExclude(o),n(V({legacy:LF(a(),o)}))},get state(){return r.state}}}function HF(e,t){if(!qj(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o=Be(e,t.options),i=t.options.tabs??{},s=He(e.state.tabSet),c={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o,tabs:i,activeTab:s};Qd(e,c),n(ir(c));let u=()=>fr(e.state,o);return{...r,clear:()=>{n(jr({facetId:o,values:[]})),n(Z())},setRange:l=>{let p={...l,state:"selected",numberOfResults:0,endInclusive:!0},m=jr({facetId:o,values:[p]});return m.error?!1:(n(m),n(Z()),!0)},enable(){n(Le(o))},disable(){n(fe(o))},get state(){let l=Lt(a()),p=u(),m=xA(a(),o),d=m.length?m[0]:void 0;return{facetId:o,isLoading:l,range:d,enabled:p}}}}function qj(e){return e.addReducers({dateFacetSet:ur,facetOptions:ke,configuration:H,search:W}),!0}function Dj(e,t){if(!jj(e))throw N;let r=HF(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(V({legacy:Ie(a()),next:Ue()}))},setRange:o=>{let i=r.setRange(o);return i&&n(V({legacy:Se({facetId:a(),facetValue:`${o.start}..${o.end}`}),next:we()})),i},get state(){return{...r.state}}}}function jj(e){return e.addReducers({dateFacetSet:ur,configuration:H,search:W}),!0}import{RecordValue as Vj}from"../bueno/v1.1.0/bueno.esm.js";var zF={facetId:K,selection:new Vj({values:ya})},WF=G("numericFacet/executeToggleSelect",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,zF),t(dr(e)),t(Od(e)),t(Z())}),dte=G("numericFacet/executeToggleExclude",(e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,zF),t(pr(e)),t(qd(e)),t(Z())});import{ArrayValue as Eg,BooleanValue as Nj,NumberValue as YF,RecordValue as KF,Schema as Mj,StringValue as yi}from"../bueno/v1.1.0/bueno.esm.js";var Qj={start:new YF,end:new YF,endInclusive:new Nj,state:new yi({constrainTo:Vd})},Lj=new Mj({facetId:Xt,tabs:new KF({options:{required:!1},values:{included:new Eg({each:new yi}),excluded:new Eg({each:new yi})}}),field:Zt,generateAutomaticRanges:Fl,filterFacetCount:er,injectionDepth:tr,numberOfValues:Tt,currentValues:new Eg({each:new KF({values:Qj})}),sortCriteria:new yi({constrainTo:Nd}),resultsMustMatch:new yi({constrainTo:gi}),rangeAlgorithm:new yi({constrainTo:Md})});function Ld(e,t){ue(e,Lj,t,"buildNumericFacet"),zl(t)}function lc(e){return{endInclusive:!1,state:"idle",...e}}function JF(e,t){if(!Uj(e))throw N;Dd(t.options,"buildNumericFacet");let r=e.dispatch,n=Be(e,t.options),a=t.options.tabs??{},o=He(e.state.tabSet),i={currentValues:[],...t.options,facetId:n,tabs:a,activeTab:o};Ld(e,i),r(lr(i));let s=jd(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return{...s,toggleSelect:c=>r(WF({facetId:n,selection:c})),toggleSingleSelect(c){c.state==="idle"&&r(ge(n)),this.toggleSelect(c)},get state(){return s.state}}}function Uj(e){return e.addReducers({numericFacetSet:St,facetOptions:ke,configuration:H,search:W}),!0}function Bj(e,t){if(!_j(e))throw N;let r=JF(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(V({legacy:Ie(a()),next:Ue()}))},sortBy(o){r.sortBy(o),n(V({legacy:or({facetId:a(),criterion:o})}))},toggleSelect:o=>{r.toggleSelect(o),n(V({legacy:kd(a(),o),next:Td(o)}))},get state(){return{...r.state}}}}function _j(e){return e.addReducers({numericFacetSet:St,configuration:H,search:W}),!0}function XF(e,t){if(!$j(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o=Be(e,t.options),i=t.options.tabs??{},s=He(e.state.tabSet),c={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:o,tabs:i,activeTab:s};Ld(e,c),n(lr(c));let u=()=>fr(e.state,o);return{...r,clear:()=>{n(Vr({facetId:o,values:[]})),n(Z())},setRange:l=>{let p={...l,state:"selected",numberOfResults:0,endInclusive:!0},m=Vr({facetId:o,values:[p]});return m.error?!1:(n(m),n(Z()),!0)},enable(){n(Le(o))},disable(){n(fe(o))},get state(){let l=Lt(a()),p=u(),m=wA(a(),o),d=m.length?m[0]:void 0;return{facetId:o,isLoading:l,range:d,enabled:p}}}}function $j(e){return e.addReducers({numericFacetSet:St,facetOptions:ke,configuration:H,search:W}),!0}function Gj(e,t){if(!Hj(e))throw N;let r=XF(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(V({legacy:Ie(a()),next:Ue()}))},setRange:o=>{let i=r.setRange(o);return i&&n(V({legacy:Se({facetId:a(),facetValue:`${o.start}..${o.end}`}),next:we()})),i},get state(){return{...r.state}}}}function Hj(e){return e.addReducers({numericFacetSet:St,configuration:H,search:W}),!0}function zj(e,t){if(!Wj(e))throw N;let{facetSearch:r,...n}=t.options.facet,a=Be(e,n);e.dispatch(Yt({...Zs,...n,facetId:a}));let o=Rd(e,{options:{...r,facetId:a},executeFacetSearchActionCreator:Te,executeFieldSuggestActionCreator:mr,select:s=>{e.dispatch(Z()),e.dispatch(V({legacy:Se({facetId:a,facetValue:s.rawValue}),next:we()}))},isForFieldSuggestions:!0});return{..._(e),...o,updateText:s=>{o.updateText(s),o.search()},get state(){return o.state}}}function Wj(e){return e.addReducers({categoryFacetSet:Jt,configuration:H,categoryFacetSearchSet:pi,search:W}),!0}function Yj(e,t){if(!Kj(e))throw N;let{facetSearch:r,allowedValues:n,...a}=t.options.facet,o=Be(e,a);e.dispatch(rr({...ec,...a,facetId:o,...n&&{allowedValues:{type:"simple",values:n}}}));let i=Pd(e,{options:{...r,facetId:o},select:c=>{e.dispatch(Z()),e.dispatch(V({legacy:Se({facetId:o,facetValue:c.rawValue}),next:we()}))},exclude:c=>{e.dispatch(Z()),e.dispatch(V({legacy:ot({facetId:o,facetValue:c.rawValue}),next:qr()}))},isForFieldSuggestions:!0,executeFacetSearchActionCreator:Te,executeFieldSuggestActionCreator:mr});return{..._(e),...i,updateText:c=>{i.updateText(c),i.search()},get state(){return i.state}}}function Kj(e){return e.addReducers({facetSet:ht,configuration:H,facetSearchSet:fi,search:W}),!0}import{NumberValue as Jj,StringValue as Ig}from"../bueno/v1.1.0/bueno.esm.js";var kg={collectionField:new Ig({emptyAllowed:!1,required:!1}),parentField:new Ig({emptyAllowed:!1,required:!1}),childField:new Ig({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new Jj({min:0,required:!1})},kn=S("folding/register",e=>F(e,kg)),Tn=G("folding/loadCollection",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let o=t(),i=o.configuration.analytics.analyticsMode==="legacy"?await rn(o):Ao(o,a),s=await n.search({...i,q:Xj(o),enableQuerySyntax:!0,cq:`@${o.folding.fields.collection}="${e}"`,filterField:o.folding.fields.collection,childField:o.folding.fields.parent,parentField:o.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return Ee(s)?r(s.error):{collectionId:e,results:s.success.results,searchUid:s.success.searchUid,rootResult:o.folding.collections[e].result}});function Xj(e){return e.query.q===""?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Zj=e=>Q("analytics/folding/showMore",(t,r)=>(Je(e),t.makeShowMoreFoldedResults(Re(e,r),pe(e)))),eV=()=>Q("analytics/folding/showLess",e=>e.makeShowLessFoldedResults()),ZF={logShowMoreFoldedResults:Zj,logShowLessFoldedResults:eV};import{Schema as fV}from"../bueno/v1.1.0/bueno.esm.js";var Ud=()=>({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}});function tV(e,t){return e.raw[t.collection]}function Tg(e,t){return e.raw[t.parent]}function dc(e,t){let r=e.raw[t.child];return vc(r)?r[0]:r}function rV(e,t){return(e||t)!==void 0&&e===t}function tR(e,t,r,n=[]){let a=dc(e,r);return a?n.indexOf(a)!==-1?[]:t.filter(o=>{let i=dc(o,r)===dc(e,r);return Tg(o,r)===a&&!i}).map(o=>{let i={...o,searchUid:e.searchUid};return{result:i,children:tR(i,t,r,[...n,a])}}):[]}function nV(e,t){return e.find(r=>{let n=Tg(r,t)===void 0,a=rV(Tg(r,t),dc(r,t));return n||a})}function rR(e){return e.parentResult?rR(e.parentResult):e}function aV(e,t,r,n){let a=pu(e),i={...n??nV(a,t)??rR(e),searchUid:r};return{result:i,children:tR(i,a,t),moreResultsAvailable:e.totalNumberOfChildResults>1,isLoadingMoreResults:!1}}function Bd(e,t,r,n){let a={};return e.forEach(o=>{let i=tV(o,t);i&&(!dc(o,t)&&!o.parentResult||(a[i]=aV(o,t,r,n)))}),a}function eR(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var _d=$(Ud(),e=>e.addCase(V.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?Bd(r.response.results,t.fields,r.response.searchUid):{}}).addCase(Ht.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?Bd(r.response.results,t.fields,r.response.searchUid):{}}).addCase(dn.fulfilled,(t,{payload:r})=>{t.collections=t.enabled?{...t.collections,...Bd(r.response.results,t.fields,r.response.searchUid)}:{}}).addCase(kn,(t,{payload:r})=>t.enabled?t:{enabled:!0,collections:{},fields:{collection:r.collectionField??t.fields.collection,parent:r.parentField??t.fields.parent,child:r.childField??t.fields.child},filterFieldRange:r.numberOfFoldedResults??t.filterFieldRange}).addCase(Tn.pending,(t,{meta:r})=>{let n=r.arg;eR(t,n).isLoadingMoreResults=!0}).addCase(Tn.rejected,(t,{meta:r})=>{let n=r.arg;eR(t,n).isLoadingMoreResults=!1}).addCase(Tn.fulfilled,(t,{payload:{collectionId:r,results:n,rootResult:a,searchUid:o}})=>{let i=Bd(n,t.fields,o,a);if(!i||!i[r])throw new Error(`Unable to create collection ${r} from received results: ${JSON.stringify(n)}. Folding most probably in an invalid state... `);t.collections[r]=i[r],t.collections[r].moreResultsAvailable=!1}));import{NumberValue as oV}from"../bueno/v1.1.0/bueno.esm.js";var pc={id:j},hi=S("querySuggest/register",e=>F(e,{...pc,count:new oV({min:0})})),nR=S("querySuggest/unregister",e=>F(e,pc)),gr=S("querySuggest/selectSuggestion",e=>F(e,{...pc,expression:ce})),On=S("querySuggest/clear",e=>F(e,pc)),qn=G("querySuggest/fetch",async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a,navigatorContext:o}})=>{a(e,pc);let i=e.id,s=await iV(i,t(),o),c=await n.querySuggest(s);return Ee(c)?r(c.error):{id:i,q:s.q,...c.success}}),iV=async(e,t,r)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl??Pe(t.configuration.organizationId,t.configuration.environment),count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?pt.getInstance().getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{...t.configuration.analytics.enabled&&t.configuration.analytics.analyticsMode==="legacy"?await Fo(t.configuration.analytics):tn(t.configuration.analytics,r)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}});var _e=$(Fe(),e=>e.addCase(Xe,(t,r)=>({...t,...r.payload})).addCase(ft,(t,r)=>{t.q=r.payload}).addCase(gr,(t,r)=>{t.q=r.payload.expression}).addCase(oe.fulfilled,(t,r)=>r.payload?.query??t).addCase(ie,(t,r)=>{t.q=r.payload.q??t.q,t.enableQuerySyntax=r.payload.enableQuerySyntax??t.enableQuerySyntax}));import{ArrayValue as uV,Schema as lV,StringValue as dV}from"../bueno/v1.1.0/bueno.esm.js";var Dn=S("fields/registerFieldsToInclude",e=>F(e,Dc)),Si=S("fields/fetchall/enable"),wa=S("fields/fetchall/disable"),Ci=G("fields/fetchDescription",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),{accessToken:o,environment:i,organizationId:s}=a.configuration,{apiBaseUrl:c}=a.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:o,organizationId:s,url:c??Pe(s,i)});return Ee(u)?n(u.error):u.success.fields});var Og=["author","language","urihash","objecttype","collection","source","permanentid"],aR=[...Og,"date","filetype","parents"],sV=[...aR,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],oR=()=>({fieldsToInclude:Og,fetchAllFields:!1,fieldsDescription:[]});var jn=$(oR(),e=>e.addCase(Dn,(t,r)=>{t.fieldsToInclude=[...new Set(t.fieldsToInclude.concat(r.payload))]}).addCase(Si,t=>{t.fetchAllFields=!0}).addCase(wa,t=>{t.fetchAllFields=!1}).addCase(Ci.fulfilled,(t,{payload:r})=>{t.fieldsDescription=r}).addCase(kn,(t,{payload:r})=>{let n=Ud().fields;t.fieldsToInclude.push(r.collectionField??n.collection,r.parentField??n.parent,r.childField??n.child)}));function xi(e){if(!cV(e))throw N;let t=_(e),r=()=>e.state;return{...t,get state(){let n=r();return{hasError:n.search.error!==null,isLoading:n.search.isLoading,hasResults:!!n.search.results.length,firstSearchExecuted:Ns(n)}}}}function cV(e){return e.addReducers({search:W}),!0}var pV=new lV({fieldsToInclude:new uV({required:!1,each:new dV({required:!0,emptyAllowed:!1})})});function $d(e,t){if(!mV(e))throw N;let r=_(e),n=xi(e),{dispatch:a}=e,o=()=>e.state,i=ue(e,pV,t?.options,"buildCoreResultList");i.fieldsToInclude&&a(Dn(i.fieldsToInclude));let s=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,c=0,u=0,l=5,p=200,m=!1;return{...r,get state(){let f=o();return{...n.state,results:f.search.results,moreResultsAvailable:s(),searchResponseId:f.search.searchResponseId}},fetchMoreResults:async()=>{if(e.state.search.isLoading)return;if(!s()){e.logger.info("No more results are available for the result list to fetch.");return}if(Date.now()-c<p){if(u++,u>=l){c=Date.now(),!m&&e.logger.error(`The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively ${l} times, with little delay. Please verify the conditions under which the function is called.`),m=!0;return}}else u=0;m=!1,t?.fetchMoreResultsActionCreator&&(await a(t?.fetchMoreResultsActionCreator()),c=Date.now())}}}function mV(e){return e.addReducers({search:W,configuration:H,fields:jn}),!0}var gV=new fV(kg);function iR(e,t,r){if(!yV(e))throw N;let n=$d(e,t),{dispatch:a}=e,o=()=>e.state,i=t.options?.folding?ue(e,gV,t.options.folding,"buildFoldedResultList"):{};return a(kn({...i})),{...n,loadCollection:s=>{a(t.loadCollectionActionCreator(s.result.raw[e.state.folding.fields.collection])),a(r.logShowMoreFoldedResults(s.result))},logShowMoreFoldedResults:s=>{a(r.logShowMoreFoldedResults(s))},logShowLessFoldedResults:()=>{a(r.logShowLessFoldedResults())},findResultById(s){return qg(this.state.results,c=>c.result.uniqueId===s.result.uniqueId)},findResultByCollection(s){return qg(this.state.results,c=>c.result.raw.foldingcollection===s.result.raw.foldingcollection)},get state(){let s=o();return{...n.state,results:n.state.results.map(c=>{let u=c.raw[s.folding.fields.collection];return!u||!s.folding.collections[u]?{result:c,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}:s.folding.collections[u]})}}}}function yV(e){return e.addReducers({search:W,configuration:dl,folding:_d,query:_e}),!0}function qg(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let a=qg(n.children,t);if(a)return a}}return null}function hV(e,t={}){let r=iR(e,{...t,loadCollectionActionCreator:Tn,fetchMoreResultsActionCreator:dn},ZF);return{...r,get state(){return r.state}}}function Dg(){return{id:"",isVisible:!0,isEnabled:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1,cannotAnswer:!1}}function Gd(e){let t=new Set;return e.filter(r=>{let n=!t.has(r.uri);return n&&t.add(r.uri),n})}var Ai=$(Dg(),e=>e.addCase(No,(t,{payload:r})=>{t.isVisible=r}).addCase(Us,(t,{payload:r})=>{t.isEnabled=r}).addCase(Zu,(t,{payload:r})=>{t.id=r.id}).addCase(Bs,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.answer||(t.answer=""),t.answer+=r.textDelta,delete t.error}).addCase(_s,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!0,t.citations=Gd([...t.citations,...r.citations]),delete t.error}).addCase(Pf,(t,{payload:r})=>{t.isLoading=!1,t.isStreaming=!1,t.error={...r,isRetryable:r.code===Qp},t.citations=[],delete t.answer}).addCase(Yu,t=>{t.liked=!0,t.disliked=!1}).addCase(Ku,t=>{t.liked=!1,t.disliked=!0}).addCase(Ju,t=>{t.feedbackModalOpen=!0}).addCase(el,t=>{t.feedbackModalOpen=!1}).addCase(Mo,t=>{t.feedbackSubmitted=!0}).addCase(It,t=>({...Dg(),...t.answerConfigurationId?{answerConfigurationId:t.answerConfigurationId}:{},responseFormat:t.responseFormat,fieldsToIncludeInCitations:t.fieldsToIncludeInCitations,isVisible:t.isVisible,id:t.id})).addCase(Ls,(t,{payload:r})=>{t.isLoading=r}).addCase(zu,(t,{payload:r})=>{t.isStreaming=r}).addCase(Gs,(t,{payload:r})=>{t.answerContentFormat=r}).addCase(tl,(t,{payload:r})=>{t.responseFormat=r}).addCase(nl,(t,r)=>{t.fieldsToIncludeInCitations=[...new Set(t.fieldsToIncludeInCitations.concat(r.payload))]}).addCase(Ef,(t,{payload:r})=>{t.isAnswerGenerated=r}).addCase($s,t=>{t.expanded=!0}).addCase(Xu,t=>{t.expanded=!1}).addCase(rl,(t,{payload:r})=>{t.answerConfigurationId=r}).addCase(ia,(t,{payload:r})=>{t.cannotAnswer=r}));function Hd(e,t,r={}){if(!SV(e))throw N;let{dispatch:n}=e,a=_(e),o=()=>e.state,i=r.initialState?.isVisible;i!==void 0&&n(No(i));let s=r.initialState?.responseFormat;s&&n(tl(s));let c=r.fieldsToIncludeInCitations;return c&&n(nl(c)),r.initialState?.expanded&&n($s()),{...a,get state(){return o().generatedAnswer},like(){this.state.liked||(n(Yu()),n(t.logLikeGeneratedAnswer()))},dislike(){this.state.disliked||(n(Ku()),n(t.logDislikeGeneratedAnswer()))},openFeedbackModal(){n(Ju())},closeFeedbackModal(){n(el())},sendFeedback(l){n(t.logGeneratedAnswerFeedback(l)),n(Mo())},logCitationClick(l){n(t.logOpenGeneratedAnswerSource(l))},logCitationHover(l,p){n(t.logHoverCitation(l,p))},show(){this.state.isVisible||(n(No(!0)),n(t.logGeneratedAnswerShowAnswers()))},hide(){this.state.isVisible&&(n(No(!1)),n(t.logGeneratedAnswerHideAnswers()))},expand(){this.state.expanded||(n($s()),n(t.logGeneratedAnswerExpand()))},collapse(){this.state.expanded&&(n(Xu()),n(t.logGeneratedAnswerCollapse()))},enable(){this.state.isEnabled||n(Us(!0))},disable(){this.state.isEnabled&&n(Us(!1))},logCopyToClipboard(){n(t.logCopyGeneratedAnswer())},retry(){}}}function SV(e){return e.addReducers({generatedAnswer:Ai}),!0}var $e={engines:{},setAbortControllerRef:(e,t)=>{$e.engines[t].abortController=e},getIsStreamInProgress:e=>!$e.engines[e].abortController||$e.engines[e].abortController?.signal.aborted?($e.engines[e].abortController=void 0,!1):!0,subscribeToSearchRequests:e=>{let t=()=>{let r=e.state,n=r.search.requestId,a=r.search.extendedResults.generativeQuestionAnsweringId,o=r.generatedAnswer.id;if($e.engines[o].lastRequestId!==n){if($e.engines[o].lastRequestId=n,$e.engines[o].abortController?.abort(),r.generatedAnswer.isEnabled===!1)return;e.dispatch(It())}if(!$e.getIsStreamInProgress(o)&&a&&a!==$e.engines[o].lastStreamId){if($e.engines[o].lastStreamId=a,r.generatedAnswer.isEnabled===!1)return;e.dispatch(VC({setAbortControllerRef:s=>$e.setAbortControllerRef(s,o)}))}};return e.subscribe(t)}};function sR(e,t,r={}){if(!CV(e))throw N;let n=Hd(e,t,r),a=()=>e.state;if(e.state.generatedAnswer.id&&!$e.engines[e.state.generatedAnswer.id]&&($e.engines[e.state.generatedAnswer.id]={abortController:void 0,lastRequestId:e.state.search.requestId,lastStreamId:e.state.search.extendedResults.generativeQuestionAnsweringId??""}),!e.state.generatedAnswer.id){let i=Ur("genQA-",12);e.dispatch(Zu({id:i}))}$e.engines[e.state.generatedAnswer.id]||($e.engines[e.state.generatedAnswer.id]={abortController:void 0,lastRequestId:"",lastStreamId:""}),$e.subscribeToSearchRequests(e);let o=i=>"executeFirstSearchAfterStandaloneSearchBoxRedirect"in i;return{...n,get state(){return a().generatedAnswer},retry(){o(e)&&e.dispatch(V({legacy:t.logRetryGeneratedAnswer()}))}}}function CV(e){return e.addReducers({generatedAnswer:Ai}),!0}var cR=sl.injectEndpoints({endpoints:e=>({post:e.query({query:t=>({url:"/evaluations",method:"POST",body:t})})})});var uR=G("streamAnswer/triggerSearchRequest",async({state:e,navigatorContext:t},{dispatch:r})=>{r(It()),await r(ul(e,t)),r(oa(void 0))});var zd=e=>e==="yes"?!0:e==="no"?!1:null,xV=({answerApiState:e,feedback:t,query:r})=>({additionalNotes:t.details??null,answer:{text:e.answer,responseId:e.answerId,format:e.contentFormat??"text/plain"},correctAnswerUrl:t.documentUrl??null,details:{correctTopic:zd(t.correctTopic),documented:zd(t.documented),hallucinationFree:zd(t.hallucinationFree),readable:zd(t.readable)},helpful:t.helpful,question:r}),AV=e=>{let t,r=()=>{let n=e.state,a=cx(n);(!t||a.q.length===0)&&(t=a),a.q.length===0&&a.cannotAnswer&&e.dispatch(ia(!1)),!(a.q.length===0||a.requestId.length===0||a.requestId===t.requestId||a.analyticsMode==="next"&&!a.actionCause)&&(t=a,e.dispatch(uR({state:n,navigatorContext:e.navigatorContext})))};e.subscribe(r)};function lR(e,t,r={}){if(!FV(e))throw N;mn(e.state.configuration.analytics.analyticsMode);let{...n}=Hd(e,t,r),a=()=>e.state;return e.dispatch(rl(r.answerConfigurationId)),AV(e),{...n,get state(){let o=Qf(e.state,e.navigatorContext).data;return{...a().generatedAnswer,answer:o?.answer,citations:Gd(o?.citations??[]),error:{message:o?.error?.message,statusCode:o?.error?.code},isLoading:o?.isLoading??!1,isStreaming:o?.isStreaming??!1,answerContentFormat:o?.contentFormat??"text/plain",isAnswerGenerated:o?.generated??!1}},retry(){e.dispatch(ul(a(),e.navigatorContext))},reset(){e.dispatch(It())},async sendFeedback(o){let i=xV({query:a().query.q,feedback:o,answerApiState:Qf(e.state,e.navigatorContext).data});e.dispatch(cR.endpoints.post.initiate(i)),e.dispatch(Mo())}}}function FV(e){return e.addReducers({[sa.reducerPath]:sa.reducer,query:_e}),!0}function RV(e,t={}){mn(e.state.configuration.analytics.analyticsMode);let r=t.answerConfigurationId?lR(e,Qs,t):sR(e,Qs,t);return{...r,get state(){return r.state}}}function et(e,t,r){if(!bV(e))throw N;let n=1e3,a={selectionDelay:n,debounceWait:n,...t.options},o;return{select:pl(r,a.debounceWait,{isImmediate:!0}),beginDelayedSelect(){o=setTimeout(r,a.selectionDelay)},cancelPendingSelect(){o&&clearTimeout(o)}}}function bV(e){return e.addReducers({configuration:H}),!0}function dR(e,t,r){let n=!1,a=()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)))};return et(e,r,()=>{a()})}function vV(e,t){return dR(e,Qs,t)}import{isNullOrUndefined as PN}from"../bueno/v1.1.0/bueno.esm.js";import{NumberValue as pR,RecordValue as Dt}from"../bueno/v1.1.0/bueno.esm.js";var Wd={f:new Dt,fExcluded:new Dt,lf:new Dt,cf:new Dt,nf:new Dt,nfExcluded:new Dt,mnf:new Dt,mnfExcluded:new Dt,df:new Dt,dfExcluded:new Dt,sortCriteria:new Dt,page:new pR({min:0}),perPage:new pR({min:1})};var mR=S("commerce/productListingParameters/restore",e=>F(e,Wd));import{StringValue as wV}from"../bueno/v1.1.0/bueno.esm.js";var fR={q:new wV,...Wd};var Yd=S("commerce/searchParameters/restore",e=>F(e,fR));var Fi=$(vo(),e=>{e.addCase(V.fulfilled,jg).addCase(li.fulfilled,jg).addCase(wn.fulfilled,jg).addCase(Yd,gR).addCase(mR,gR).addCase(oe.fulfilled,(t,r)=>r.payload?.facetOrder??t).addCase(bd,()=>vo()).addCase(kF,()=>vo())});function jg(e,t){return t.payload.response.facets.map(r=>r.facetId)}function gR(e,t){return[...Object.keys(t.payload.f??{}),...Object.keys(t.payload.lf??{}),...Object.keys(t.payload.nf??{}),...Object.keys(t.payload.df??{}),...Object.keys(t.payload.cf??{}),...Object.keys(t.payload.mnf??{})]}var Kd=()=>Q("history/analytics/forward",e=>e.makeSearchEvent("historyForward")),Jd=()=>Q("history/analytics/backward",e=>e.makeSearchEvent("historyBackward")),Xd=()=>Q("history/analytics/noresultsback",e=>e.makeNoResultsBack());var yR=e=>({past:[],present:e,future:[]}),PV=e=>{let{past:t,present:r,future:n}=e;if(!r||t.length===0)return e;let a=t[t.length-1];return{past:t.slice(0,t.length-1),present:a,future:[r,...n]}},EV=e=>{let{past:t,present:r,future:n}=e;if(!r||n.length===0)return e;let a=n[0],o=n.slice(1);return{past:[...t,r],present:a,future:o}},IV=e=>{let{action:t,state:r,reducer:n}=e,{past:a,present:o}=r,i=n(o,t);return o?o===i?r:{past:[...a,o].slice(-10),present:i,future:[]}:yR(i)},hR=e=>{let{actionTypes:t,reducer:r}=e,n=yR();return(a=n,o)=>{switch(o.type){case t.undo:return PV(a);case t.redo:return EV(a);case t.snapshot:return IV({state:a,reducer:r,action:o});default:return a}}};var kV=Object.getOwnPropertyNames,TV=Object.getOwnPropertySymbols,OV=Object.prototype.hasOwnProperty;function SR(e,t){return function(n,a,o){return e(n,a,o)&&t(n,a,o)}}function Zd(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var o=a.cache,i=o.get(r),s=o.get(n);if(i&&s)return i===n&&s===r;o.set(r,n),o.set(n,r);var c=e(r,n,a);return o.delete(r),o.delete(n),c}}function CR(e){return kV(e).concat(TV(e))}var qV=Object.hasOwn||function(e,t){return OV.call(e,t)};function Pa(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var DV="__v",jV="__o",VV="_owner",xR=Object.getOwnPropertyDescriptor,AR=Object.keys;function NV(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function MV(e,t){return Pa(e.getTime(),t.getTime())}function QV(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function LV(e,t){return e===t}function FR(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),o=e.entries(),i,s,c=0;(i=o.next())&&!i.done;){for(var u=t.entries(),l=!1,p=0;(s=u.next())&&!s.done;){if(a[p]){p++;continue}var m=i.value,d=s.value;if(r.equals(m[0],d[0],c,p,e,t,r)&&r.equals(m[1],d[1],m[0],d[0],e,t,r)){l=a[p]=!0;break}p++}if(!l)return!1;c++}return!0}var UV=Pa;function BV(e,t,r){var n=AR(e),a=n.length;if(AR(t).length!==a)return!1;for(;a-- >0;)if(!wR(e,t,r,n[a]))return!1;return!0}function mc(e,t,r){var n=CR(e),a=n.length;if(CR(t).length!==a)return!1;for(var o,i,s;a-- >0;)if(o=n[a],!wR(e,t,r,o)||(i=xR(e,o),s=xR(t,o),(i||s)&&(!i||!s||i.configurable!==s.configurable||i.enumerable!==s.enumerable||i.writable!==s.writable)))return!1;return!0}function _V(e,t){return Pa(e.valueOf(),t.valueOf())}function $V(e,t){return e.source===t.source&&e.flags===t.flags}function RR(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),o=e.values(),i,s;(i=o.next())&&!i.done;){for(var c=t.values(),u=!1,l=0;(s=c.next())&&!s.done;){if(!a[l]&&r.equals(i.value,s.value,i.value,s.value,e,t,r)){u=a[l]=!0;break}l++}if(!u)return!1}return!0}function GV(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function HV(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function wR(e,t,r,n){return(n===VV||n===jV||n===DV)&&(e.$$typeof||t.$$typeof)?!0:qV(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var zV="[object Arguments]",WV="[object Boolean]",YV="[object Date]",KV="[object Error]",JV="[object Map]",XV="[object Number]",ZV="[object Object]",eN="[object RegExp]",tN="[object Set]",rN="[object String]",nN="[object URL]",aN=Array.isArray,bR=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,vR=Object.assign,oN=Object.prototype.toString.call.bind(Object.prototype.toString);function iN(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,o=e.areMapsEqual,i=e.areNumbersEqual,s=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,l=e.areSetsEqual,p=e.areTypedArraysEqual,m=e.areUrlsEqual;return function(f,C,g){if(f===C)return!0;if(f==null||C==null)return!1;var y=typeof f;if(y!==typeof C)return!1;if(y!=="object")return y==="number"?i(f,C,g):y==="function"?a(f,C,g):!1;var x=f.constructor;if(x!==C.constructor)return!1;if(x===Object)return s(f,C,g);if(aN(f))return t(f,C,g);if(bR!=null&&bR(f))return p(f,C,g);if(x===Date)return r(f,C,g);if(x===RegExp)return u(f,C,g);if(x===Map)return o(f,C,g);if(x===Set)return l(f,C,g);var h=oN(f);return h===YV?r(f,C,g):h===eN?u(f,C,g):h===JV?o(f,C,g):h===tN?l(f,C,g):h===ZV?typeof f.then!="function"&&typeof C.then!="function"&&s(f,C,g):h===nN?m(f,C,g):h===KV?n(f,C,g):h===zV?s(f,C,g):h===WV||h===XV||h===rN?c(f,C,g):!1}}function sN(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?mc:NV,areDatesEqual:MV,areErrorsEqual:QV,areFunctionsEqual:LV,areMapsEqual:n?SR(FR,mc):FR,areNumbersEqual:UV,areObjectsEqual:n?mc:BV,arePrimitiveWrappersEqual:_V,areRegExpsEqual:$V,areSetsEqual:n?SR(RR,mc):RR,areTypedArraysEqual:n?mc:GV,areUrlsEqual:HV};if(r&&(a=vR({},a,r(a))),t){var o=Zd(a.areArraysEqual),i=Zd(a.areMapsEqual),s=Zd(a.areObjectsEqual),c=Zd(a.areSetsEqual);a=vR({},a,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:c})}return a}function cN(e){return function(t,r,n,a,o,i,s){return e(t,r,s)}}function uN(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,o=e.strict;if(n)return function(c,u){var l=n(),p=l.cache,m=p===void 0?t?new WeakMap:void 0:p,d=l.meta;return r(c,u,{cache:m,equals:a,meta:d,strict:o})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:a,meta:void 0,strict:o})};var i={cache:void 0,equals:a,meta:void 0,strict:o};return function(c,u){return r(c,u,i)}}var Doe=yr(),joe=yr({strict:!0}),Voe=yr({circular:!0}),Noe=yr({circular:!0,strict:!0}),Moe=yr({createInternalComparator:function(){return Pa}}),Qoe=yr({strict:!0,createInternalComparator:function(){return Pa}}),Loe=yr({circular:!0,createInternalComparator:function(){return Pa}}),Uoe=yr({circular:!0,createInternalComparator:function(){return Pa},strict:!0});function yr(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,o=e.strict,i=o===void 0?!1:o,s=sN(e),c=iN(s),u=n?n(c):cN(c);return uN({circular:r,comparator:c,createState:a,equals:u,strict:i})}function Ea(e,t,r=(n,a)=>n===a){return e.length===t.length&&e.findIndex((n,a)=>!r(t[a],n))===-1}function lN(e,t){return e.length!==t.length?!1:e.every(r=>t.findIndex(n=>fc(r,n))!==-1)}var fc=yr({createCustomConfig:e=>({...e,areArraysEqual:lN})});var dN=$(fC(),e=>{e.addCase(at,(t,r)=>pN(t,r.payload)?void 0:r.payload)}),pN=(e,t)=>mN(e.context,t.context)&&fN(e.dictionaryFieldContext,t.dictionaryFieldContext)&&AN(e.advancedSearchQueries,t.advancedSearchQueries)&&gN(e.tabSet,t.tabSet)&&yN(e.staticFilterSet,t.staticFilterSet)&&Vg(e.facetSet,t.facetSet)&&Vg(e.dateFacetSet,t.dateFacetSet)&&Vg(e.numericFacetSet,t.numericFacetSet)&&SN(e.automaticFacetSet,t.automaticFacetSet)&&hN(e.categoryFacetSet,t.categoryFacetSet)&&CN(e.pagination,t.pagination)&&xN(e.query,t.query)&&FN(e,t)&&RN(e.pipeline,t.pipeline)&&bN(e.searchHub,t.searchHub)&&vN(e.facetOrder,t.facetOrder)&&wN(e.debug,t.debug),mN=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),fN=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),gN=(e,t)=>{let r=PR(e),n=PR(t);return r?.id===n?.id},PR=e=>Object.values(e).find(t=>t.isActive),yN=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let a=ER(e[r]),o=ER(n);if(JSON.stringify(a)!==JSON.stringify(o))return!1}return!0},ER=e=>e.values.filter(t=>t.state!=="idle"),Vg=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let a=e[r].request.currentValues.filter(i=>i.state!=="idle"),o=n.request.currentValues.filter(i=>i.state!=="idle");if(JSON.stringify(a)!==JSON.stringify(o))return!1}return!0},hN=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let a=Ke(e[r]?.request.currentValues).map(({value:i})=>i),o=Ke(n?.request.currentValues).map(({value:i})=>i);if(JSON.stringify(a)!==JSON.stringify(o))return!1}return!0},SN=(e,t)=>{for(let[r,n]of Object.entries(t.set)){if(!e.set[r])return!1;let a=e.set[r].response.values.filter(i=>i.state!=="idle"),o=n.response.values.filter(i=>i.state!=="idle");if(JSON.stringify(a)!==JSON.stringify(o))return!1}return!0},CN=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,xN=(e,t)=>JSON.stringify(e)===JSON.stringify(t),AN=(e,t)=>JSON.stringify(e)===JSON.stringify(t),FN=(e,t)=>e.sortCriteria===t.sortCriteria,RN=(e,t)=>e===t,bN=(e,t)=>e===t,vN=(e,t)=>Ea(e,t),wN=(e,t)=>e===t,ep=hR({actionTypes:{redo:rf.type,undo:tf.type,snapshot:at.type},reducer:dN});function EN(e){if(!IN(e))throw N;let t=_(e),{dispatch:r}=e,n=()=>e.state,a=o=>o.past.length>0&&!PN(o.present);return{...t,subscribe(o){o();let i=JSON.stringify(n().history.present),s=()=>{let c=JSON.stringify(n().history.present);i!==c&&(i=c,o())};return e.subscribe(()=>s())},get state(){return n().history},async back(){a(this.state)&&(await r(ks()),r(V({legacy:Jd()})))},async forward(){!this.state.future.length||!this.state.present||(await r(Au()),r(V({legacy:Kd()})))},async backOnNoResults(){a(this.state)&&(await r(ks()),r(V({legacy:Xd()})))}}}function IN(e){return e.addReducers({history:ep,configuration:H,facetOrder:Fi}),!0}import{ArrayValue as kN,NumberValue as TN,RecordValue as ON}from"../bueno/v1.1.0/bueno.esm.js";var qN={results:new kN({required:!0,each:new ON({values:fu})}),maxLength:new TN({required:!0,min:1,default:10})},Ri=S("recentResults/registerRecentResults",e=>F(e,qN)),xt=S("recentResults/pushRecentResult",e=>(Je(e),{payload:e})),bi=S("recentResults/clearRecentResults");function DN(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(WS(t.options.result)))};return et(e,t,()=>{n(),e.dispatch(xt(t.options.result))})}function tp(e){return e?e.expiresAt&&Date.now()>=e.expiresAt:!1}var IR=(e,t)=>{let{id:r}=e;if(!t[r])return t[r]={q:"",cache:{}},t},kR=(e,t)=>{let{q:r,id:n}=e;r&&(t[n].q=r)},TR=(e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach(([n,a])=>{tp(a)&&delete t[r].cache[n]})},OR=(e,t,r)=>{for(let a in t)for(let o in t[a].cache)t[a].cache[o].isActive=!1;if(!Ng(e,t)){jN(e,t,r);return}let n=Ng(e,t);n.isLoading=!0,n.isActive=!0,n.error=null},qR=(e,t,r)=>{let{id:n,q:a,searchUid:o,cacheTimeout:i,totalCountFiltered:s,duration:c}=e;t[n].cache[a]={...Ng(e,t),...r,isActive:!0,searchUid:o,isLoading:!1,error:null,expiresAt:i?i+Date.now():0,totalCountFiltered:s,duration:c}},DR=(e,t)=>{let{id:r,q:n,error:a}=e;t[r].cache[n].error=a||null,t[r].cache[n].isLoading=!1,t[r].cache[n].isActive=!1},Ng=(e,t)=>{let{q:r,id:n}=e;return t[n].cache[r]||null},jN=(e,t,r)=>{let{q:n,id:a}=e;t[a].cache[n]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r}};function jR(){return{}}var rp=$(jR(),e=>{e.addCase(fo,(t,r)=>{IR(r.payload,t)}),e.addCase(Bt,(t,r)=>{kR(r.payload,t)}),e.addCase(go,(t,r)=>{TR(r.payload,t)}),e.addCase(To.pending,(t,r)=>{OR(r.meta.arg,t,{results:[]})}),e.addCase(To.fulfilled,(t,r)=>{let n=r.payload.results.map(a=>({...a,searchUid:r.payload.searchUid}));qR({...r.payload,...r.meta.arg},t,{results:n})}),e.addCase(To.rejected,(t,r)=>{DR(r.meta.arg,t)})});import{NumberValue as VR,Schema as VN}from"../bueno/v1.1.0/bueno.esm.js";var NN={searchBoxId:me,maxResultsPerQuery:new VR({required:!0,min:1}),cacheTimeout:new VR},NR=new VN(NN);function MN(e,t){if(!QN(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o={searchBoxId:t.options.searchBoxId||Ur("instant-results-"),cacheTimeout:t.options.cacheTimeout||6e4,maxResultsPerQuery:t.options.maxResultsPerQuery};ue(e,NR,o,"buildInstantResults");let i=o.searchBoxId;n(fo({id:i}));let s=()=>a().instantResults[i],c=p=>s().cache[p],u=()=>s().q,l=()=>{let p=c(u());return p?p.isLoading?[]:p.results:[]};return{...r,updateQuery(p){if(!p)return;let m=c(p);(!m||!m.isLoading&&(m.error||tp(m)))&&n(To({id:i,q:p,maxResultsPerQuery:o.maxResultsPerQuery,cacheTimeout:o.cacheTimeout})),n(Bt({id:i,q:p}))},clearExpired(){n(go({id:i}))},get state(){let p=u(),m=c(p);return{q:p,isLoading:m?.isLoading||!1,error:m?.error||null,results:l()}}}}function QN(e){return e.addReducers({instantResults:rp}),!0}var At=$(gt(),e=>{e.addCase(yo,(t,r)=>{let n=Mg(t),a=r.payload;t.defaultNumberOfResults=t.numberOfResults=a,t.firstResult=gc(n,a)}).addCase(ho,(t,r)=>{t.numberOfResults=r.payload,t.firstResult=0}).addCase(kt,t=>{t.firstResult=0}).addCase(So,(t,r)=>{let n=r.payload;t.firstResult=gc(n,t.numberOfResults)}).addCase(_t,(t,r)=>{let n=r.payload;t.firstResult=gc(n,t.numberOfResults)}).addCase(xo,t=>{let r=Mg(t),n=Math.max(r-1,1);t.firstResult=gc(n,t.numberOfResults)}).addCase(Co,t=>{let r=Mg(t),n=LN(t),a=Math.min(r+1,n);t.firstResult=gc(a,t.numberOfResults)}).addCase(oe.fulfilled,(t,r)=>{r.payload&&(t.numberOfResults=r.payload.pagination.numberOfResults,t.firstResult=r.payload.pagination.firstResult)}).addCase(ie,(t,r)=>{t.firstResult=r.payload.firstResult??t.firstResult,t.numberOfResults=r.payload.numberOfResults??t.defaultNumberOfResults}).addCase(V.fulfilled,(t,r)=>{let{response:n}=r.payload;t.totalCountFiltered=n.totalCountFiltered}).addCase(ge,t=>{Ge(t)}).addCase(cr,t=>{Ge(t)}).addCase(ar,t=>{Ge(t)}).addCase(pr,t=>{Ge(t)}).addCase(fa,t=>{Ge(t)}).addCase(nr,t=>{Ge(t)}).addCase(Kt,t=>{Ge(t)}).addCase(yn,t=>{Ge(t)}).addCase(Wo,t=>{Ge(t)}).addCase(sr,t=>{Ge(t)}).addCase(dr,t=>{Ge(t)}).addCase(be,t=>{Ge(t)}).addCase(jr,t=>{Ge(t)}).addCase(Vr,t=>{Ge(t)}).addCase(ma,t=>{Ge(t)}).addCase(Wt,t=>{Ge(t)})});function Ge(e){e.firstResult=gt().firstResult}function Mg(e){let{firstResult:t,numberOfResults:r}=e;return Qg(t,r)}function LN(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Lg(t,r)}function gc(e,t){return(e-1)*t}function Qg(e,t){return Math.round(e/t)+1}function Lg(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function UN(e){return e.pagination.firstResult}function MR(e){return e.pagination.numberOfResults}function BN(e){return e.pagination.totalCountFiltered}var Vn=e=>{let t=UN(e),r=MR(e);return Qg(t,r)},np=e=>{let t=BN(e),r=MR(e);return Lg(t,r)},Ug=(e,t)=>{let r=Vn(e),n=np(e),a=_N(r,t);return a=$N(a),a=GN(a,n),HN(a)};function _N(e,t){let r=t%2===0,n=Math.floor(t/2),a=r?n-1:n,o=e-n,i=e+a;return{start:o,end:i}}function $N(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}function GN(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),a=e.end-r;return{start:n,end:a}}function HN(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}var wi=()=>Q("analytics/pager/resize",(e,t)=>e.makePagerResize({currentResultsPerPage:t.pagination?.numberOfResults||gt().numberOfResults})),Pi=()=>Q("analytics/pager/number",(e,t)=>e.makePagerNumber({pagerNumber:Vn(t)})),ap=()=>Q("analytics/pager/next",(e,t)=>e.makePagerNext({pagerNumber:Vn(t)})),op=()=>Q("analytics/pager/previous",(e,t)=>e.makePagerPrevious({pagerNumber:Vn(t)})),Ei=()=>({actionCause:"browseResults"});import{NumberValue as QR,Schema as LR}from"../bueno/v1.1.0/bueno.esm.js";var zN=new LR({numberOfPages:new QR({default:5,min:0})}),WN=new LR({page:new QR({min:1})});function UR(e,t={}){if(!YN(e))throw N;let r=_(e),{dispatch:n}=e,a=ue(e,zN,t.options,"buildPager"),i=Ae(e,WN,t.initialState,"buildPager").page;i&&n(So(i));let s=()=>Vn(e.state),c=()=>{let{numberOfPages:l}=a;return Ug(e.state,l)},u=()=>np(e.state);return{...r,get state(){let l=s(),p=u(),m=l>1&&p>0,d=l<p;return{currentPage:l,currentPages:c(),maxPage:p,hasPreviousPage:m,hasNextPage:d}},selectPage(l){n(_t(l))},nextPage(){n(Co())},previousPage(){n(xo())},isCurrentPage(l){return l===this.state.currentPage}}}function YN(e){return e.addReducers({configuration:H,pagination:At}),!0}function KN(e,t={}){let{dispatch:r}=e,n=UR(e,t);return{...n,get state(){return n.state},selectPage(a){n.selectPage(a),r(Ht({legacy:Pi(),next:Ei()}))},nextPage(){n.nextPage(),r(Ht({legacy:ap(),next:Ei()}))},previousPage(){n.previousPage(),r(Ht({legacy:op(),next:Ei()}))}}}function BR(e){if(!JN(e))throw N;let t=_(e),r=()=>e.state;return{...t,get state(){return{hasError:r().search.error!==null,error:r().search.error}}}}function JN(e){return e.addReducers({search:W}),!0}function XN(e){return BR(e)}function _R(e){if(!ZN(e))throw N;let t=_(e),r=xi(e),n=()=>e.state,a=()=>{let o=n().search.duration/1e3;return Math.round((o+Number.EPSILON)*100)/100};return{...t,get state(){return{...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:a(),firstResult:n().pagination.firstResult+1,hasDuration:n().search.duration!==0,hasQuery:n().search.queryExecuted!=="",lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function ZN(e){return e.addReducers({search:W,pagination:At}),!0}function eM(e){return _R(e)}import{ArrayValue as tM}from"../bueno/v1.1.0/bueno.esm.js";async function ip(e,t){let{search:r,accessToken:n,organizationId:a}=e.configuration,o=e.query?.q||"";return{url:r.apiBaseUrl??Pe(e.configuration.organizationId,e.configuration.environment),accessToken:n,organizationId:a,enableNavigation:!1,q:o,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var Ia=G("resultPreview/fetchResultContent",async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),o=await ip(a,e),i=await t.apiClient.html(o);return Ee(i)?n(i.error):{content:i.success,uniqueId:e.uniqueId}}),Ii=S("resultPreview/next"),ki=S("resultPreview/previous"),Ti=S("resultPreview/prepare",e=>F(e,{results:new tM({required:!0})})),$R=2048,Oi=G("resultPreview/updateContentURL",async(e,{getState:t,extra:r})=>{let n=t(),a=Qy(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return a?.length>$R&&r.logger.error(`The content URL was truncated as it exceeds the maximum allowed length of ${$R} characters.`),{contentURL:a}});var GR=e=>Q({prefix:"analytics/resultPreview/open",__legacy__getBuilder:(t,r)=>{Je(e);let n=Re(e,r),a=pe(e);return t.makeDocumentQuickview(n,a)},analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=Re(e,t),n=pe(e);return{responseId:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function Bg(){return{uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]}}var _g=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:a}=Bg();e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=a},$g=e=>e.filter(t=>t.hasHtmlVersion).map(t=>t.uniqueId),sp=$(Bg(),e=>{e.addCase(Ia.pending,t=>{t.isLoading=!0}).addCase(Ia.fulfilled,(t,r)=>{let{content:n,uniqueId:a}=r.payload;t.position=t.resultsWithPreview.indexOf(a),t.content=n,t.uniqueId=a,t.isLoading=!1}).addCase(V.fulfilled,(t,r)=>{_g(t),t.resultsWithPreview=$g(r.payload.response.results)}).addCase(dn.fulfilled,(t,r)=>{_g(t),t.resultsWithPreview=t.resultsWithPreview.concat($g(r.payload.response.results))}).addCase(Ht.fulfilled,_g).addCase(Ti,(t,r)=>{t.resultsWithPreview=$g(r.payload.results)}).addCase(Ii,t=>{if(t.isLoading)return;let r=t.position+1;r>t.resultsWithPreview.length-1&&(r=0),t.position=r}).addCase(ki,t=>{if(t.isLoading)return;let r=t.position-1;r<0&&(r=t.resultsWithPreview.length-1),t.position=r}).addCase(Oi.fulfilled,(t,r)=>{t.contentURL=r.payload.contentURL})});function HR(e,t,r,n,a){if(!rM(e))throw N;let{dispatch:o}=e,i=()=>e.state,s=_(e),{result:c,maximumPreviewSize:u}=t.options,l=()=>{let{resultsWithPreview:m,position:d}=i().resultPreview;return m[d]},p=m=>{o(Oi({uniqueId:m,requestedOutputSize:u,buildResultPreviewRequest:r,path:n})),t.options.onlyContentURL||o(Ia({uniqueId:m,requestedOutputSize:u})),a&&a()};return{...s,fetchResultContent(){p(c.uniqueId)},next(){o(Ii()),p(l())},previous(){o(ki()),p(l())},get state(){let m=i(),d=c.hasHtmlVersion,f=m.resultPreview,C=c.uniqueId===f.uniqueId?f.content:"",g=f.isLoading,y=f.contentURL,x=l();return{content:C,resultHasPreview:d,isLoading:g,contentURL:y,currentResultUniqueId:x}}}}function rM(e){return e.addReducers({configuration:H,resultPreview:sp}),!0}function nM(e,t){if(!aM(e))throw N;let{dispatch:r}=e,n=()=>e.state,a=()=>n().search.results,s=HR(e,t,ip,"/html",()=>{e.dispatch(GR(t.options.result))});return r(Ti({results:a()})),{...s,get state(){return{...s.state,currentResult:a().findIndex(c=>c.uniqueId===s.state.currentResultUniqueId)+1,totalResults:a().length}}}}function aM(e){return e.addReducers({search:W}),!0}import{ArrayValue as KR,BooleanValue as pM,isBoolean as mM,NumberValue as JR,Schema as XR,StringValue as fM}from"../bueno/v1.1.0/bueno.esm.js";import{ArrayValue as oM,NumberValue as iM,StringValue as sM}from"../bueno/v1.1.0/bueno.esm.js";var cM={queries:new oM({required:!0,each:new sM({emptyAllowed:!1})}),maxLength:new iM({required:!0,min:1,default:10})},ka=S("recentQueries/registerRecentQueries",e=>F(e,cM)),qi=S("recentQueries/clearRecentQueries");var zR=()=>Q("analytics/recentQueries/clear",e=>e.makeClearRecentQueries()),WR=()=>Q("analytics/recentQueries/click",e=>e.makeRecentQueryClick());function YR(){return{queries:[],maxLength:10}}var cp=$(YR(),e=>{e.addCase(ka,uM).addCase(qi,lM).addCase(V.fulfilled,(t,r)=>{let n=r.payload.queryExecuted,a=r.payload.response.results;!n.length||!a.length||dM(n,t)})});function uM(e,t){e.queries=Array.from(new Set(t.payload.queries.map(r=>r.trim().toLowerCase()))).slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength}function lM(e){e.queries=[]}function dM(e,t){let r=e.trim().toLowerCase();if(r==="")return;let n=Array.from(new Set(t.queries.filter(a=>a.trim().toLowerCase()!==r))).slice(0,t.maxLength-1);t.queries=[r,...n]}var gM={queries:[]},yM={maxLength:10,clearFilters:!0},hM=new XR({queries:new KR({required:!0})}),SM=new XR({maxLength:new JR({required:!0,min:1}),clearFilters:new pM});function CM(e,t){ue(e,SM,t?.options,"buildRecentQueriesList"),Ae(e,hM,t?.initialState,"buildRecentQueriesList")}function xM(e,t){if(!AM(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o={...yM,...t?.options},i={...gM,...t?.initialState};CM(e,{options:o,initialState:i});let s={queries:i.queries,maxLength:o.maxLength};return n(ka(s)),{...r,get state(){let c=a();return{...c.recentQueries,analyticsEnabled:c.configuration.analytics.enabled}},clear(){n(zR()),n(qi())},updateRecentQueries(c){let u=new KR({required:!0,each:new fM({required:!0}),min:1}).validate(c);if(u)throw new Error(u);n(ka({queries:c,maxLength:o.maxLength}))},executeRecentQuery(c){let u=new JR({required:!0,min:0,max:this.state.queries.length}).validate(c);if(u)throw new Error(u);let l={q:this.state.queries[c],clearFilters:o.clearFilters};mM(e.state.query?.enableQuerySyntax)&&(l.enableQuerySyntax=e.state.query.enableQuerySyntax),n(ko(l)),n(V({legacy:WR()}))}}}function AM(e){return e.addReducers({search:W,recentQueries:cp}),!0}var ZR=e=>Q("analytics/recentResults/click",(t,r)=>(Je(e),t.makeRecentResultClick(Re(e,r),pe(e)))),eb=()=>Q("analytics/recentResults/clear",e=>e.makeClearRecentResults());function FM(e,t){return et(e,t,()=>e.dispatch(ZR(t.options.result)))}import{ArrayValue as RM,NumberValue as bM,Schema as rb}from"../bueno/v1.1.0/bueno.esm.js";function tb(){return{results:[],maxLength:10}}var up=$(tb(),e=>{e.addCase(Ri,(t,r)=>{t.results=r.payload.results.slice(0,r.payload.maxLength),t.maxLength=r.payload.maxLength}).addCase(bi,t=>{t.results=[]}).addCase(xt,(t,r)=>{let n=r.payload;t.results=t.results.filter(o=>o.uniqueId!==n.uniqueId);let a=t.results.slice(0,t.maxLength-1);t.results=[n,...a]})});var vM={initialState:{results:[]},options:{maxLength:10}},wM=new rb({results:new RM({required:!0})}),PM=new rb({maxLength:new bM({required:!0,min:1})});function EM(e,t){ue(e,PM,t?.options,"buildRecentResultsList"),Ae(e,wM,t?.initialState,"buildRecentResultsList")}function IM(e,t){if(!kM(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o={...vM,...t};EM(e,o);let i={results:o.initialState.results,maxLength:o.options.maxLength};return n(Ri(i)),{...r,get state(){return a().recentResults},clear(){n(eb()),n(bi())}}}function kM(e){return e.addReducers({recentResults:up}),!0}import{BooleanValue as qM,Schema as DM}from"../bueno/v1.1.0/bueno.esm.js";var ab=e=>{let t=/Document weights:\n((?:.)*?)\n+/g,r=/Terms weights:\n((?:.|\n)*)\n+/g,n=/Total weight: ([0-9]+)/g;if(!e)return null;let a=t.exec(e),o=r.exec(e),i=n.exec(e),s=OM(e),c=ob(a?a[1]:null),u=TM(o),l=i?Number(i[1]):null;return{documentWeights:c,termsWeight:u,totalWeight:l,qreWeights:s}},ob=e=>{let t=/(\w+(?:\s\w+)*): ([-0-9]+)/g,r=/^(\w+(?:\s\w+)*): ([-0-9]+)$/;if(!e)return null;let n=e.match(t);if(!n)return null;let a={};for(let o of n){let i=o.match(r);if(i){let s=i[1],c=i[2];a[s]=Number(c)}}return a},nb=(e,t)=>{let r=[],n;for(;n=t.exec(e),n!==null;)r.push(n);return r},TM=e=>{let t=/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g,r=/([^:]+): ([0-9]+), ([0-9]+); /g;if(!e||!e[1])return null;let n=nb(e[1],t);if(!n)return null;let a={};for(let o of n){let i=nb(o[1],r),s={};for(let u of i)s[u[1]]={Correlation:Number(u[2]),"TF-IDF":Number(u[3])};let c=ob(o[2]);a[Object.keys(s).join(", ")]={terms:s,Weights:c}}return a},OM=e=>{let t=/(Expression:\s".*")\sScore:\s(?!0)([-0-9]+)\n+/g,r=t.exec(e),n=[];for(;r;)n.push({expression:r[1],score:parseInt(r[2],10)}),r=t.exec(e);return n};function ib(e){return e.search.response.results.map(r=>{let n=ab(r.rankingInfo);return{result:r,ranking:n}})}var jM=new DM({enabled:new qM({default:!1})});function VM(e,t={}){if(!NM(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state;Ae(e,jM,t.initialState,"buildRelevanceInspector").enabled&&n(Zr());let i=s=>{e.logger.warn(`Flag [ ${s} ] is now activated. This should *not* be used in any production environment as it negatively impact performance.`)};return{...r,get state(){let s=a(),c=s.debug;if(!s.debug)return{isEnabled:c};let{executionReport:u,basicExpression:l,advancedExpression:p,constantExpression:m,userIdentities:d,rankingExpressions:f}=s.search.response,{fieldsDescription:C,fetchAllFields:g}=s.fields;return{isEnabled:c,rankingInformation:ib(s),executionReport:u,expressions:{basicExpression:l,advancedExpression:p,constantExpression:m},userIdentities:d,rankingExpressions:f,fieldsDescription:C,fetchAllFields:g}},enable(){n(Zr()),i("debug")},disable(){n(co()),n(wa())},enableFetchAllFields(){n(Si()),i("fetchAllFields")},disableFetchAllFields(){n(wa())},fetchFieldsDescription(){!this.state.isEnabled&&n(Zr()),n(Ci()),i("fieldsDescription"),e.logger.warn(`For production environment, please specify the necessary fields either when instantiating a ResultList controller, or by dispatching a registerFieldsToInclude action.
        
        hhttps://docs.coveo.com/en/headless/latest/reference/interfaces/Search.ResultListOptions.html
        https://docs.coveo.com/en/headless/latest/reference/interfaces/Search.FieldActionCreators.html#registerfieldstoinclude`)}}}function NM(e){return e.addReducers({debug:uo,search:W,configuration:H,fields:jn}),!0}var lp=e=>Q({prefix:"analytics/result/open",__legacy__getBuilder:(t,r)=>(Je(e),t.makeDocumentOpen(Re(e,r),pe(e))),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=Re(e,t),n=pe(e);return{responseId:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function MM(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch(lp(t.options.result)))};return et(e,t,()=>{n(),e.dispatch(xt(t.options.result))})}function QM(e,t){return $d(e,{...t,fetchMoreResultsActionCreator:dn})}import{NumberValue as LM,Schema as UM}from"../bueno/v1.1.0/bueno.esm.js";var BM=new UM({numberOfResults:new LM({min:0})});function sb(e,t={}){if(!_M(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,i=Ae(e,BM,t.initialState,"buildResultsPerPage").numberOfResults;return i!==void 0&&n(yo(i)),{...r,get state(){return{numberOfResults:a().pagination.numberOfResults}},set(s){n(ho(s))},isSetTo(s){return s===this.state.numberOfResults}}}function _M(e){return e.addReducers({pagination:At,configuration:H}),!0}function $M(e,t={}){if(!GM(e))throw N;let r=sb(e,t),{dispatch:n}=e;return{...r,get state(){return{...r.state}},set(a){r.set(a),n(Ht({legacy:wi(),next:Ei()}))}}}function GM(e){return e.addReducers({pagination:At,configuration:H}),!0}var Nn=()=>Q("analytics/searchbox/submit",e=>e.makeSearchboxSubmit()),dp=()=>({actionCause:"searchboxSubmit"});var yc={id:j,query:ce},Di=S("querySet/register",e=>F(e,yc)),Ta=S("querySet/update",e=>F(e,yc));import{isNullOrUndefined as HM}from"../bueno/v1.1.0/bueno.esm.js";var cb=S("commerce/querySet/register",e=>F(e,yc)),ub=S("commerce/querySet/update",e=>F(e,yc));var Mn=$(qu(),e=>{e.addCase(Di,(t,r)=>db(t,r.payload)).addCase(cb,(t,r)=>db(t,r.payload)).addCase(Ta,(t,r)=>{let{id:n,query:a}=r.payload;hc(t,n,a)}).addCase(ub,(t,r)=>{let{id:n,query:a}=r.payload;hc(t,n,a)}).addCase(gr,(t,r)=>{let{id:n,expression:a}=r.payload;hc(t,n,a)}).addCase(rF,(t,r)=>{let{id:n,expression:a}=r.payload;hc(t,n,a)}).addCase(wn.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;Gg(t,n)}).addCase(V.fulfilled,(t,r)=>{let{queryExecuted:n}=r.payload;Gg(t,n)}).addCase(ie,lb).addCase(Yd,lb).addCase(oe.fulfilled,(t,r)=>{if(r.payload)for(let[n,a]of Object.entries(r.payload.querySet))hc(t,n,a)})});function lb(e,t){HM(t.payload.q)||Gg(e,t.payload.q)}function Gg(e,t){Object.keys(e).forEach(r=>{e[r]=t})}var hc=(e,t,r)=>{t in e&&(e[t]=r)},db=(e,t)=>{let{id:r,query:n}=t;r in e||(e[r]=n)};var pp=e=>Q("analytics/querySuggest",(t,r)=>{let n=Hg(r,e);return t.makeOmniboxAnalytics(n)}),pb=()=>({actionCause:"omniboxAnalytics"});function Hg(e,t){let{id:r,suggestion:n}=t,a=e.querySuggest?.[r];if(!a)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let o=a.completions.map(u=>u.expression),i=a.partialQueries.length-1,s=a.partialQueries[i]||"",c=a.responseId;return{suggestionRanking:o.indexOf(n),partialQuery:s,partialQueries:a.partialQueries,suggestions:o,querySuggestResponseId:c}}var mb=()=>({});var ji=$(mb(),e=>e.addCase(hi,(t,r)=>{fb(t,r.payload)}).addCase(tF,(t,r)=>{fb(t,r.payload)}).addCase(nR,(t,r)=>{delete t[r.payload.id]}).addCase(qn.pending,gb).addCase(qn.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{q:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions,n.isLoading=!1,n.error=null}).addCase(qn.rejected,yb).addCase(vn.pending,gb).addCase(vn.fulfilled,(t,r)=>{let n=t[r.meta.arg.id];if(!n||r.meta.requestId!==n.currentRequestId)return;let{query:a}=r.payload;a&&n.partialQueries.push(a.replace(/;/,encodeURIComponent(";"))),n.responseId=r.payload.responseId,n.completions=r.payload.completions.map(o=>({expression:o.expression,highlighted:o.highlighted,score:0,executableConfidence:0})),n.isLoading=!1,n.error=null}).addCase(vn.rejected,yb).addCase(On,(t,r)=>{hb(t,r.payload)}).addCase(eF,(t,r)=>{hb(t,r.payload)}).addCase(Oo,(t,r)=>{Object.keys(t).forEach(n=>{let a=t[n];a&&(a.error=r.payload,a.isLoading=!1)})}));function fb(e,t){let r=t.id;r in e||(e[r]=zM(t))}function zM(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}function gb(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function yb(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}function hb(e,t){let r=e[t.id];r&&(r.responseId="",r.completions=[],r.partialQueries=[])}import{BooleanValue as Sb,NumberValue as WM,RecordValue as mp,Schema as YM,StringValue as Cb}from"../bueno/v1.1.0/bueno.esm.js";var fp={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},zg={open:new Cb,close:new Cb},Wg={id:j,numberOfSuggestions:new WM({min:0}),enableQuerySyntax:new Sb,highlightOptions:new mp({values:{notMatchDelimiters:new mp({values:zg}),exactMatchDelimiters:new mp({values:zg}),correctionDelimiters:new mp({values:zg})}}),clearFilters:new Sb},xb=new YM(Wg);function Ab(e,t){if(!JM(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state,o=t.options?.id||Ur("search_box"),i={id:o,highlightOptions:{...t.options?.highlightOptions},...fp,...t.options};ue(e,xb,i,"buildSearchBox"),n(Di({id:o,query:e.state.query.q})),i.numberOfSuggestions&&n(hi({id:o,count:i.numberOfSuggestions}));let s=()=>e.state.querySet[i.id],c=async u=>{let{enableQuerySyntax:l,clearFilters:p}=i;n(ko({q:s(),enableQuerySyntax:l,clearFilters:p})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(u)):n(t.executeSearchActionCreator(u.legacy))};return{...r,updateText(u){n(Ta({id:o,query:u})),this.showSuggestions()},clear(){n(Ta({id:o,query:""})),n(On({id:o}))},showSuggestions(){i.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:o}))},selectSuggestion(u){n(gr({id:o,expression:u})),c({legacy:pp({id:o,suggestion:u}),next:pb()}).then(()=>{n(On({id:o}))})},submit(u=Nn(),l){c({legacy:u,next:l}),n(On({id:o}))},get state(){let u=a(),l=u.querySuggest[i.id],p=KM(l,i.highlightOptions),m=l?l.isLoading:!1;return{searchBoxId:o,value:s(),suggestions:p,isLoading:u.search.isLoading,isLoadingSuggestions:m}}}}function KM(e,t){return e?e.completions.map(r=>({highlightedValue:jp(r.highlighted,t),rawValue:r.expression})):[]}function JM(e){return e.addReducers({query:_e,querySuggest:ji,configuration:H,querySet:Mn,search:W}),!0}function Yg(e,t={}){let r=Ab(e,{...t,executeSearchActionCreator:V,fetchQuerySuggestionsActionCreator:qn,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(Nn(),dp())},get state(){return r.state}}}var Vi=()=>Q("analytics/sort/results",(e,t)=>e.makeResultsSort({resultsSortBy:t.sortCriteria||dt()})),gp=()=>({actionCause:"resultsSort"});function Rb(e,t){return e.q!==t.q?Nn():e.sortCriteria!==t.sortCriteria?Vi():e.firstResult!==t.firstResult?Pi():e.numberOfResults!==t.numberOfResults?wi():Ft(e.f,t.f)?Sc(e.f,t.f):Ft(e.fExcluded,t.fExcluded)?Sc(e.fExcluded,t.fExcluded,!0):Ft(e.cf,t.cf)?Sc(e.cf,t.cf):Ft(e.af,t.af)?Sc(e.af,t.af):Ft(e.nf,t.nf)?Fb(e.nf,t.nf):Ft(e.df,t.df)?Fb(e.df,t.df):Kr()}function Sc(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),o=n.filter(m=>!a.includes(m));if(o.length){let m=o[0];switch(!0){case e[m].length>1:return Ie(m);case r:return Or({facetId:m,facetValue:e[m][0]});default:return Ot({facetId:m,facetValue:e[m][0]})}}let i=a.filter(m=>!n.includes(m));if(i.length){let m=i[0];return r?ot({facetId:m,facetValue:t[m][0]}):Se({facetId:m,facetValue:t[m][0]})}let s=a.find(m=>t[m].filter(d=>e[m].includes(d)));if(!s)return Kr();let c=e[s],u=t[s],l=u.filter(m=>!c.includes(m));if(l.length)return r?ot({facetId:s,facetValue:l[0]}):Se({facetId:s,facetValue:l[0]});let p=c.filter(m=>!u.includes(m));return p.length?r?Or({facetId:s,facetValue:p[0]}):Ot({facetId:s,facetValue:p[0]}):Kr()}function Fb(e={},t={}){return Sc(Mi(e),Mi(t))}function bb(e,t){return e.q!==t.q?dp():e.sortCriteria!==t.sortCriteria?gp():Ft(e.f,t.f)?Ni(e.f,t.f):Ft(e.fExcluded,t.fExcluded)?Ni(e.fExcluded,t.fExcluded,!0):Ft(e.cf,t.cf)?Ni(e.cf,t.cf):Ft(e.af,t.af)?Ni(e.af,t.af):Ft(e.nf,t.nf)?Ni(Mi(e.nf),Mi(t.nf)):Ft(e.df,t.df)?Ni(Mi(e.df),Mi(t.df)):ao()}function Ft(e={},t={}){return JSON.stringify(e)!==JSON.stringify(t)}function Ni(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),o=n.filter(m=>!a.includes(m));if(o.length){let m=o[0];return e[m].length>1?Ue():Dr()}if(a.filter(m=>!n.includes(m)).length)return r?qr():we();let s=a.find(m=>t[m].filter(d=>e[m].includes(d)));if(!s)return ao();let c=e[s],u=t[s];return u.filter(m=>!c.includes(m)).length?r?qr():we():c.filter(m=>!u.includes(m)).length?Dr():ao()}function Mi(e={}){let t={};return Object.keys(e).forEach(r=>{t[r]=e[r].map(n=>`${n.start}..${n.end}`)}),t}import{RecordValue as XM,Schema as ZM}from"../bueno/v1.1.0/bueno.esm.js";function vb(e){return{q:Fe().q,enableQuerySyntax:Fe().enableQuerySyntax,aq:e.advancedSearchQueries?.defaultFilters.aq??Pt().defaultFilters.aq,cq:e.advancedSearchQueries?.defaultFilters.cq??Pt().defaultFilters.cq,firstResult:gt().firstResult,numberOfResults:e.pagination?.defaultNumberOfResults??gt().defaultNumberOfResults,sortCriteria:dt(),f:{},fExcluded:{},cf:{},nf:{},df:{},debug:en(),sf:{},tab:"",af:{},mnf:{}}}var eQ=new ZM({parameters:new XM({options:{required:!0},values:xu})});function Pb(e,t){let{dispatch:r}=e,n=_(e);Ae(e,eQ,t.initialState,"buildSearchParameterManager");let a=wb(e.state.tabSet,t.initialState.parameters);return r(ie(a)),{...n,synchronize(o){let i=wb(e.state.tabSet,yp(e,o));r(ie(i))},get state(){return{parameters:Kg(e)}}}}function yp(e,t){return{...vb(e.state),...t}}function wb(e,t){if(t.tab&&e){let r=Object.values(e).some(a=>a.id===t.tab),n=Object.values(e).find(a=>a.isActive);if(!r&&n)return{...t,tab:n.id};if(!r)return{...t,tab:""}}return t}function Kg(e){let t=e.state;return{...Cg(t.query,r=>r.q,Fe().q),...uF(t.tabSet,r=>{let n=Object.values(r??{}).find(a=>a.isActive);return n?n.id:Object.keys(r??{})[0]},t.tabSet?Object.keys(t.tabSet)[0]:""),...xg(t.sortCriteria,r=>r,dt()),...Ra(t.facetSet,Cc(t),tQ,"f"),...Ra(t.facetSet,Cc(t),rQ,"fExcluded"),...nQ(t),...aQ(t),...oQ(t),...iQ(t)}}function Cc(e){return t=>e.facetOptions?.facets[t]?.enabled??!0}function tQ(e){return e.currentValues.filter(t=>t.state==="selected").map(t=>t.value)}function Eb(e){return e.currentValues.filter(t=>t.state==="selected")}function rQ(e){return e.currentValues.filter(t=>t.state==="excluded").map(t=>t.value)}function nQ(e){return Ra(e.categoryFacetSet,Cc(e),t=>Ke(t.currentValues).map(r=>r.value),"cf")}function aQ(e){return Ra(e.numericFacetSet,Cc(e),Eb,"nf")}function oQ(e){return Ra(e.dateFacetSet,Cc(e),Eb,"df")}function iQ(e){let t=e.automaticFacetSet?.set;if(t===void 0)return{};let r=Object.entries(t).map(([n,{response:a}])=>{let o=sQ(a);return o.length?{[n]:o}:{}}).reduce((n,a)=>({...n,...a}),{});return Object.keys(r).length?{af:r}:{}}function sQ(e){return e.values.filter(t=>t.state==="selected").map(t=>t.value)}function Jg(e,t){let{dispatch:r}=e,n=Pb(e,t);return{...n,synchronize(a){let o=Ib(e),i=yp(e,o),s=yp(e,a);fc(i,s)||(n.synchronize(a),r(V({legacy:Rb(i,s),next:bb(i,s)})))},get state(){return{parameters:Ib(e)}}}}function Ib(e){let t=e.state;return{...Kg(e),...cQ(t),...uQ(t),...lQ(t),...dQ(t),...pQ(t),...gQ(t),...mQ(t)}}function cQ(e){if(e.query===void 0)return{};let t=e.query.enableQuerySyntax;return t!==void 0&&t!==Fe().enableQuerySyntax?{enableQuerySyntax:t}:{}}function uQ(e){if(e.advancedSearchQueries===void 0)return{};let{aq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.aq?{aq:t}:{}}function lQ(e){if(e.advancedSearchQueries===void 0)return{};let{cq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.cq?{cq:t}:{}}function dQ(e){if(e.pagination===void 0)return{};let t=e.pagination.firstResult;return t!==gt().firstResult?{firstResult:t}:{}}function pQ(e){if(e.pagination===void 0)return{};let{numberOfResults:t,defaultNumberOfResults:r}=e.pagination;return t!==r?{numberOfResults:t}:{}}function mQ(e){if(e.staticFilterSet===void 0)return{};let t=Object.entries(e.staticFilterSet).map(([r,n])=>{let a=fQ(n.values);return a.length?{[r]:a}:{}}).reduce((r,n)=>({...r,...n}),{});return Object.keys(t).length?{sf:t}:{}}function fQ(e){return e.filter(t=>t.state==="selected").map(t=>t.caption)}function gQ(e){if(e.debug===void 0)return{};let t=e.debug;return t!==en()?{debug:t}:{}}function yQ(e){return xi(e)}import{RecordValue as kb}from"../bueno/v1.1.0/bueno.esm.js";var hp=()=>new kb({values:{questionAnswerId:j},options:{required:!0}}),Xg=()=>new kb({values:{linkText:ce,linkURL:ce},options:{required:!0}});function Qi(e){return F(e,hp())}function xe(e,t){let r=t??e.search?.questionAnswer?.documentId;return r&&e.search&&PC(e,r.contentIdKey,r.contentIdValue)}function jt(e,t){let r=e.questionAnswering?.relatedQuestions.findIndex(a=>a.questionAnswerId===t)??-1;return r===-1?null:e.search?.questionAnswer?.relatedQuestions?.[r]??null}var Zg=()=>Q({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:e=>e.makeExpandSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=xe(e),r=pe(t),n=e.search?.response.searchUid;if(n)return{action:"expand",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),ey=()=>Q({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:e=>e.makeCollapseSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=xe(e),r=pe(t),n=e.search?.response.searchUid;if(n)return{action:"collapse",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),ty=()=>Q({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:e=>e.makeLikeSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=xe(e),r=pe(t),n=e.search?.response.searchUid;if(n)return{action:"like",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),ry=()=>Q({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:e=>e.makeDislikeSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=xe(e),r=pe(t),n=e.search?.response.searchUid;if(n)return{action:"dislike",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),ny=()=>Q({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=xe(t);return e.makeOpenSmartSnippetSource(Re(r,t),pe(r))},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:e=>{let t=xe(e),r=pe(t),n=e.search?.response.searchUid;if(n)return{snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),xc=e=>Q({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{F(e,Xg());let n=xe(r);return n?t.makeOpenSmartSnippetInlineLink(Re(n,r),{...pe(n),...e}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:t=>{let r=xe(t),n=pe(r),a=t.search?.response.searchUid;if(a)return{snippetType:"SmartSnippet",responseId:a,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.title,url:r.clickUri}}}}),ay=()=>Q("analytics/smartSnippet/feedbackModal/open",e=>e.makeOpenSmartSnippetFeedbackModal()),oy=()=>Q("analytics/smartSnippet/feedbackModal/close",e=>e.makeCloseSmartSnippetFeedbackModal()),hQ={does_not_answer:"doesNotAnswer",partially_answers:"partiallyAnswers",was_not_a_question:"wasNotAQuestion"},iy=e=>Q({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason(e),analyticsType:"SmartSnippets.SubmitFeedback",analyticsPayloadBuilder:t=>{let r=xe(t),n=pe(r),a=t.search?.response.searchUid;if(a)return{responseId:a,snippetType:"SmartSnippet",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.title,url:r.clickUri},reason:hQ[e]}}}),sy=e=>Q({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason("other",e),analyticsType:"SmartSnippets.SubmitFeedback",analyticsPayloadBuilder:t=>{let r=xe(t),n=pe(r),a=t.search?.response.searchUid;if(a)return{responseId:a,snippetType:"SmartSnippet",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.title,url:r.clickUri},reason:"other",additionalNotes:e}}}),cy=e=>Q({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{Qi(e);let n=jt(r,e.questionAnswerId);return n?t.makeExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:t=>{let r=jt(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let a=xe(t,r.documentId);return{action:"expand",responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:a?.title,url:a?.clickUri}}}}}),uy=e=>Q({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{Qi(e);let n=jt(r,e.questionAnswerId);return n?t.makeCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:t=>{let r=jt(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let a=xe(t,r.documentId);return{action:"collapse",responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:a?.title,url:a?.clickUri}}}}}),Ac=e=>Q({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{F(e,hp());let n=jt(r,e.questionAnswerId);if(!n)return null;let a=xe(r,n.documentId);return a?t.makeOpenSmartSnippetSuggestionSource(Re(a,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:t=>{let r=jt(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let a=xe(t,r.documentId);return{responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:a?.title,url:a?.clickUri}}}}}),Sp=(e,t)=>Q({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{F(e,hp()),F(t,Xg());let a=jt(n,e.questionAnswerId);if(!a)return null;let o=xe(n,a.documentId);return o?r.makeOpenSmartSnippetSuggestionInlineLink(Re(o,n),{question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId,linkText:t.linkText,linkURL:t.linkURL}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:r=>{let n=jt(r,e.questionAnswerId),a=r.search?.response.searchUid;if(a&&n){let o=xe(r,n.documentId);return{responseId:a,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:n.documentId.contentIdKey,uniqueFieldValue:n.documentId.contentIdValue,title:o?.title,url:o?.clickUri}}}}}),Cp={logExpandSmartSnippet:Zg,logCollapseSmartSnippet:ey,logLikeSmartSnippet:ty,logDislikeSmartSnippet:ry,logOpenSmartSnippetSource:ny,logOpenSmartSnippetInlineLink:xc,logOpenSmartSnippetFeedbackModal:ay,logCloseSmartSnippetFeedbackModal:oy,logSmartSnippetFeedback:iy,logSmartSnippetDetailedFeedback:sy,logExpandSmartSnippetSuggestion:cy,logCollapseSmartSnippetSuggestion:uy,logOpenSmartSnippetSuggestionSource:Ac};var Li=S("smartSnippet/expand"),Ui=S("smartSnippet/collapse"),Bi=S("smartSnippet/like"),_i=S("smartSnippet/dislike"),$i=S("smartSnippet/feedbackModal/open"),Qn=S("smartSnippet/feedbackModal/close"),Gi=S("smartSnippet/related/expand",e=>Qi(e)),Hi=S("smartSnippet/related/collapse",e=>Qi(e));var ly=()=>({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]});var Tb=(e,t)=>e.findIndex(r=>r.questionAnswerId===t.questionAnswerId);function Ob({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return Da({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}function SQ(e,t){let r=Ob(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}var hr=$(ly(),e=>e.addCase(Li,t=>{t.expanded=!0}).addCase(Ui,t=>{t.expanded=!1}).addCase(Bi,t=>{t.liked=!0,t.disliked=!1,t.feedbackModalOpen=!1}).addCase(_i,t=>{t.liked=!1,t.disliked=!0}).addCase($i,t=>{t.feedbackModalOpen=!0}).addCase(Qn,t=>{t.feedbackModalOpen=!1}).addCase(V.fulfilled,(t,r)=>{let n=r.payload.response.questionAnswer.relatedQuestions.map((o,i)=>SQ(o,t.relatedQuestions[i])),a=Ob(r.payload.response.questionAnswer);return t.questionAnswerId===a?{...t,relatedQuestions:n}:{...ly(),relatedQuestions:n,questionAnswerId:a}}).addCase(Gi,(t,r)=>{let n=Tb(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!0)}).addCase(Hi,(t,r)=>{let n=Tb(t.relatedQuestions,r.payload);n!==-1&&(t.relatedQuestions[n].expanded=!1)}));function qb(e,t,r){if(!CQ(e))throw N;let n=_(e),a=()=>e.state,o=()=>xe(a()),i=null,s=et(e,{options:{selectionDelay:r?.options?.selectionDelay}},()=>{let c=o();if(!c){i=null;return}let{searchResponseId:u}=a().search;i!==u&&(i=u,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch(xt(c)))});return{...n,get state(){let c=a();return{question:c.search.questionAnswer.question,answer:c.search.questionAnswer.answerSnippet,documentId:c.search.questionAnswer.documentId,expanded:c.questionAnswering.expanded,answerFound:c.search.questionAnswer.answerSnippet!=="",liked:c.questionAnswering.liked,disliked:c.questionAnswering.disliked,feedbackModalOpen:c.questionAnswering.feedbackModalOpen,source:o()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(Li())},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(Ui())},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch(Bi())},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(_i())},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch($i())},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(Qn())},sendFeedback(c){e.dispatch(t.logSmartSnippetFeedback(c)),e.dispatch(Qn())},sendDetailedFeedback(c){e.dispatch(t.logSmartSnippetDetailedFeedback(c)),e.dispatch(Qn())},selectSource(){s.select()},beginDelayedSelectSource(){s.beginDelayedSelect()},cancelPendingSelectSource(){s.cancelPendingSelect()}}}function CQ(e){return e.addReducers({search:W,questionAnswering:hr}),!0}function xp(e,t){if(!xQ(e))throw N;let r=()=>e.state,n=new Set,a=l=>n.has(l)?!0:(n.add(l),!1),o=null,i=l=>{o!==l&&(o=l,c={},n.clear())},s=(l,p,m)=>et(e,{options:{selectionDelay:t?.options?.selectionDelay}},()=>{a(p)||e.dispatch(m?Sp({questionAnswerId:m},l):xc(l))}),c={},u=(l,p)=>{let{searchResponseId:m}=r().search;i(m);let d=Da({...l,questionAnswerId:p});return d in c||(c[d]=s(l,d,p)),c[d]};return{selectInlineLink(l,p){u(l,p)?.select()},beginDelayedSelectInlineLink(l,p){u(l,p)?.beginDelayedSelect()},cancelPendingSelectInlineLink(l,p){u(l,p)?.cancelPendingSelect()}}}function xQ(e){return e.addReducers({search:W,questionAnswering:hr}),!0}function AQ(e,t){mn(e.state.configuration.analytics.analyticsMode);let r=qb(e,Cp,t),n=xp(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(a){n.selectInlineLink(a)},beginDelayedSelectInlineLink(a){n.beginDelayedSelectInlineLink(a)},cancelPendingSelectInlineLink(a){n.cancelPendingSelectInlineLink(a)}}}function Db(e,t){if(!FQ(e))throw N;let r=_(e),n=()=>e.state,a=o=>{let{contentIdKey:i,contentIdValue:s}=o;return e.state.search.results.find(c=>pn(c,i)===s)};return{...r,get state(){let o=n();return{questions:o.search.questionAnswer.relatedQuestions.map((i,s)=>({question:i.question,answer:i.answerSnippet,documentId:i.documentId,questionAnswerId:o.questionAnswering.relatedQuestions[s].questionAnswerId,expanded:o.questionAnswering.relatedQuestions[s].expanded,source:a(i.documentId)}))}},expand(o){let i={questionAnswerId:o};e.dispatch(t.logExpandSmartSnippetSuggestion(i)),e.dispatch(Gi(i))},collapse(o){let i={questionAnswerId:o};e.dispatch(t.logCollapseSmartSnippetSuggestion(i)),e.dispatch(Hi(i))}}}function FQ(e){return e.addReducers({search:W,questionAnswering:hr}),!0}function jb(e,t){if(!RQ(e))throw N;let r=()=>e.state,n=p=>{let m=r(),d=jt(m,p);return d?xe(m,d.documentId):null},a=new Set,o=p=>a.has(p)?!0:(a.add(p),!1),i=null,s=p=>{i!==p&&(i=p,u={},a.clear())},c=(p,m)=>et(e,{options:{selectionDelay:t?.options?.selectionDelay}},()=>{o(m)||(e.dispatch(Ac({questionAnswerId:m})),e.dispatch(xt(p)))}),u={},l=p=>{let{searchResponseId:m}=r().search;s(m);let d=n(p);return d?(p in u||(u[p]=c(d,p)),u[p]):null};return{selectSource(p){l(p)?.select()},beginDelayedSelectSource(p){l(p)?.beginDelayedSelect()},cancelPendingSelectSource(p){l(p)?.cancelPendingSelect()}}}function RQ(e){return e.addReducers({search:W,questionAnswering:hr}),!0}function bQ(e,t){mn(e.state.configuration.analytics.analyticsMode);let r=Db(e,Cp),n=xp(e,{options:{selectionDelay:t?.options?.selectionDelay}}),a=jb(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectSource(o){a.selectSource(o)},beginDelayedSelectSource(o){a.beginDelayedSelectSource(o)},cancelPendingSelectSource(o){a.cancelPendingSelectSource(o)},selectInlineLink(o,i){n.selectInlineLink(i,o)},beginDelayedSelectInlineLink(o,i){n.beginDelayedSelectInlineLink(i,o)},cancelPendingSelectInlineLink(o,i){n.cancelPendingSelectInlineLink(i,o)}}}import{ArrayValue as PQ,isArray as EQ,Schema as IQ}from"../bueno/v1.1.0/bueno.esm.js";import{EnumValue as vQ,isArray as wQ}from"../bueno/v1.1.0/bueno.esm.js";var Vb={by:new vQ({enum:to,required:!0})},zi=S("sortCriteria/register",e=>Nb(e)),Wi=S("sortCriteria/update",e=>Nb(e)),Nb=e=>wQ(e)?(e.forEach(t=>F(t,Vb)),{payload:e}):F(e,Vb);var Ap=$(dt(),e=>{e.addCase(zi,(t,r)=>Pr(r.payload)).addCase(Wi,(t,r)=>Pr(r.payload)).addCase(oe.fulfilled,(t,r)=>r.payload?.sortCriteria??t).addCase(ie,(t,r)=>r.payload.sortCriteria??t)});function kQ(e,t){if(!t)return;let r=new IQ({criterion:new PQ({each:bS})}),n=TQ(t),a={...t,criterion:n};Ae(e,r,a,"buildSort")}function TQ(e){return e.criterion?EQ(e.criterion)?e.criterion:[e.criterion]:[]}function Mb(e,t){if(!OQ(e))throw N;let r=_(e),{dispatch:n}=e,a=()=>e.state;kQ(e,t.initialState);let o=t.initialState?.criterion;return o&&n(zi(o)),{...r,sortBy(i){n(Wi(i)),n(_t(1))},isSortedBy(i){return this.state.sortCriteria===Pr(i)},get state(){return{sortCriteria:a().sortCriteria}}}}function OQ(e){return e.addReducers({configuration:H,sortCriteria:Ap}),!0}function qQ(e,t={}){let{dispatch:r}=e,n=Mb(e,t),a=()=>r(V({legacy:Vi(),next:gp()}));return{...n,get state(){return n.state},sortBy(o){n.sortBy(o),a()}}}import{BooleanValue as DQ,StringValue as jQ}from"../bueno/v1.1.0/bueno.esm.js";function Qb(e){return e.type==="redirect"}var Fp=class{constructor(t){this.response=t}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let t=this.response.preprocessingOutput.triggers.filter(Qb);return t.length?t[0].content:null}};var Yi=S("standaloneSearchBox/register",e=>F(e,{id:j,redirectionUrl:j,overwrite:new DQ({required:!1})})),Ki=S("standaloneSearchBox/updateRedirectionUrl",e=>F(e,{id:j,redirectionUrl:j})),Ji=S("standaloneSearchBox/reset",e=>F(e,{id:j})),Xi=S("standaloneSearchBox/updateAnalyticsToSearchFromLink",e=>F(e,{id:j})),Zi=S("standaloneSearchBox/updateAnalyticsToOmniboxFromLink"),Ln=G("standaloneSearchBox/fetchRedirect",async(e,{dispatch:t,getState:r,rejectWithValue:n,extra:{apiClient:a,validatePayload:o,navigatorContext:i}})=>{o(e,{id:new jQ({emptyAllowed:!1})});let s=await NQ(r(),i),c=await a.plan(s);if(Ee(c))return n(c.error);let{redirectionUrl:u}=new Fp(c.success);return u&&t(VQ(u)),u||""}),VQ=e=>Q("analytics/standaloneSearchBox/redirect",t=>t.makeTriggerRedirect({redirectedTo:e})),NQ=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??Pe(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&e.configuration.analytics.analyticsMode==="legacy"?await Fo(e.configuration.analytics):tn(e.configuration.analytics,t),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});function Lb(){return{}}var Rp=$(Lb(),e=>e.addCase(Yi,(t,r)=>{let{id:n,redirectionUrl:a,overwrite:o}=r.payload;!o&&n in t||(t[n]=dy(a))}).addCase(Ji,(t,r)=>{let{id:n}=r.payload,a=t[n];if(a){t[n]=dy(a.defaultRedirectionUrl);return}}).addCase(Ki,(t,r)=>{let{id:n,redirectionUrl:a}=r.payload;n in t&&(t[n]=dy(a))}).addCase(Ln.pending,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!0)}).addCase(Ln.fulfilled,(t,r)=>{let n=r.payload,a=t[r.meta.arg.id];a&&(a.redirectTo=n||a.defaultRedirectionUrl,a.isLoading=!1)}).addCase(Ln.rejected,(t,r)=>{let n=t[r.meta.arg.id];n&&(n.isLoading=!1)}).addCase(Xi,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="searchFromLink")}).addCase(Zi,(t,r)=>{let n=t[r.payload.id];n&&(n.analytics.cause="omniboxFromLink",n.analytics.metadata=r.payload.metadata)}));function dy(e){return{defaultRedirectionUrl:e,redirectTo:"",isLoading:!1,analytics:{cause:"",metadata:null}}}import{BooleanValue as MQ,Schema as QQ,StringValue as LQ}from"../bueno/v1.1.0/bueno.esm.js";var Ub=new QQ({...Wg,redirectionUrl:new LQ({required:!0,emptyAllowed:!1}),overwrite:new MQ({required:!1})});function UQ(e,t){if(!BQ(e))throw N;let{dispatch:r}=e,n=()=>e.state,a=t.options.id||Ur("standalone_search_box"),o={id:a,highlightOptions:{...t.options.highlightOptions},...fp,overwrite:!1,...t.options};ue(e,Ub,o,"buildStandaloneSearchBox");let i=Yg(e,{options:o});return r(Yi({id:a,redirectionUrl:o.redirectionUrl,overwrite:o.overwrite})),{...i,updateText(s){i.updateText(s),r(Xi({id:a}))},selectSuggestion(s){let c=Hg(n(),{id:a,suggestion:s});r(gr({id:a,expression:s})),r(Zi({id:a,metadata:c})),this.submit()},afterRedirection(){r(Ji({id:a}))},updateRedirectUrl(s){r(Ki({id:a,redirectionUrl:s}))},submit(){r(Xe({q:this.state.value,enableQuerySyntax:o.enableQuerySyntax})),r(Ln({id:a}))},get state(){let c=n().standaloneSearchBoxSet[a];return{...i.state,isLoading:c.isLoading,redirectTo:c.redirectTo,analytics:c.analytics}}}}function BQ(e){return e.addReducers({standaloneSearchBoxSet:Rp,configuration:H,query:_e,querySuggest:ji}),!0}import{Schema as _Q}from"../bueno/v1.1.0/bueno.esm.js";var bp=$(Du(),e=>e.addCase(ni,(t,r)=>{let n=r.payload,{id:a}=n;a in t||(t[a]=n)}).addCase(Nr,(t,r)=>{let{id:n,value:a}=r.payload,o=t[n];if(!o)return;let i=o.values.find(c=>c.caption===a.caption);if(!i)return;let s=i.state==="selected";i.state=s?"idle":"selected"}).addCase(Mr,(t,r)=>{let{id:n,value:a}=r.payload,o=t[n];if(!o)return;let i=o.values.find(c=>c.caption===a.caption);if(!i)return;let s=i.state==="excluded";i.state=s?"idle":"excluded"}).addCase(xn,(t,r)=>{let n=r.payload,a=t[n];a&&a.values.forEach(o=>{o.state="idle"})}).addCase(be,t=>{Object.values(t).forEach(r=>{r.values.forEach(n=>{n.state="idle"})})}).addCase(ie,(t,r)=>{let n=r.payload.sf||{};Object.entries(t).forEach(([a,o])=>{let i=n[a]||[];o.values.forEach(s=>{s.state=i.includes(s.caption)?"selected":"idle"})})}));function Bb(e){return{state:"idle",...e}}var $Q=new _Q({id:Ca,values:Jl});function GQ(e,t){if(!HQ(e))throw N;ue(e,$Q,t.options,"buildStaticFilter");let r=_(e),{dispatch:n}=e,a=()=>e.state,{id:o}=t.options;return n(ni(t.options)),{...r,toggleSelect(i){n(Nr({id:o,value:i})),n(V({legacy:vp(o,i)}))},toggleSingleSelect(i){i.state==="idle"&&n(xn(o)),n(Nr({id:o,value:i})),n(V({legacy:vp(o,i)}))},toggleExclude(i){n(Mr({id:o,value:i})),n(V({legacy:vp(o,i)}))},toggleSingleExclude(i){i.state==="idle"&&n(xn(o)),n(Mr({id:o,value:i})),n(V({legacy:vp(o,i)}))},deselectAll(){n(xn(o)),n(V({legacy:Zl({staticFilterId:o})}))},isValueSelected(i){return i.state==="selected"},isValueExcluded(i){return i.state==="excluded"},get state(){let i=a().staticFilterSet[o]?.values||[],s=i.some(c=>c.state!=="idle");return{id:o,values:i,hasActiveValues:s}}}}function HQ(e){return e.addReducers({staticFilterSet:bp}),!0}function vp(e,t){let{caption:r,expression:n,state:a}=t;return(a==="idle"?Xl:ai)({staticFilterId:e,staticFilterValue:{caption:r,expression:n}})}import{BooleanValue as _b,Schema as $b}from"../bueno/v1.1.0/bueno.esm.js";var zQ=new $b({expression:ce,id:j,clearFiltersOnTabChange:new _b}),WQ=new $b({isActive:new _b});function Gb(e,t){if(KQ(t.options.id),!YQ(e))throw N;let r=_(e),{dispatch:n}=e;ue(e,zQ,t.options,"buildTab");let a=Ae(e,WQ,t.initialState,"buildTab"),{id:o,expression:i}=t.options;return n(Uo({id:o,expression:i})),Object.keys(e.state.tabSet).length===1&&(a.isActive=!0),a.isActive&&n(kt(o)),{...r,select(){t.options.clearFiltersOnTabChange&&n(ko({q:"",clearFilters:!0})),n(kt(o))},get state(){return{isActive:e.state.tabSet[o]?.isActive}}}}function YQ(e){return e.addReducers({configuration:H,tabSet:oi}),!0}function KQ(e){let t=Bo().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)}function JQ(e,t){let{dispatch:r}=e,n=Gb(e,t),a=()=>r(V({legacy:Kr(),next:ao()}));return{...n,get state(){return n.state},select(){n.select(),a()}}}function XQ(e){let t=nd(e);return{...t,get state(){return t.state}}}function Hb(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}function zb(e,t){let r=[],n=[],a=[],o=[];return t.forEach(i=>{switch(i.type){case"redirect":r.push(i.content);break;case"query":n.push(i.content);break;case"execute":a.push({functionName:i.content.name,params:i.content.params});break;case"notify":o.push(i.content);break}}),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=a,e.notifications=o,e}function Wb(e,t){return e.queryModification={...t,queryToIgnore:""},e}function Yb(e,t){return e.queryModification.queryToIgnore=t,e}var Kb=()=>({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}});var Un=$(Kb(),e=>e.addCase(V.pending,Hb).addCase(V.fulfilled,(t,r)=>zb(t,r.payload.response.triggers)).addCase(wo,(t,r)=>Wb(t,r.payload)).addCase(on,(t,r)=>Yb(t,r.payload)));function ZQ(e){if(!eL(e))throw N;let t=_(e),{dispatch:r}=e,n=()=>e.state,a=n().triggers.executions;return{...t,subscribe(o){let i=()=>{let s=!Ea(this.state.executions,a,(c,u)=>c.functionName===u.functionName&&Ea(c.params,u.params));a=this.state.executions,s&&this.state.executions.length&&(o(),r(Lu()))};return i(),e.subscribe(i)},get state(){return{executions:n().triggers.executions}}}}function eL(e){return e.addReducers({triggers:Un}),!0}function Jb(e,t){let r=t.options.logNotifyTriggerActionCreator;if(!tL(e))throw N;let n=_(e),{dispatch:a}=e,o=()=>e.state,i=o().triggers.notifications;return{...n,subscribe(s){let c=()=>{let u=!Ea(i,this.state.notifications);i=this.state.notifications,u&&(s(),a(r()))};return c(),e.subscribe(c)},get state(){return{notifications:o().triggers.notifications}}}}function tL(e){return e.addReducers({triggers:Un}),!0}function rL(e){return Jb(e,{options:{logNotifyTriggerActionCreator:Mu}})}function nL(e){if(!aL(e))throw N;let t=_(e),{dispatch:r}=e,n=()=>e.state,a=()=>n().triggers.queryModification.newQuery,o=()=>n().triggers.queryModification.originalQuery;return{...t,get state(){return{newQuery:a(),originalQuery:o(),wasQueryModified:a()!==""}},undo(){r(on(a())),r(Xe({q:o()})),r(V({legacy:Nu({undoneQuery:a()})}))}}}function aL(e){return e.addReducers({triggers:Un,query:_e}),!0}function oL(e){if(!iL(e))throw N;let t=_(e),{dispatch:r}=e,n=()=>e.state,a=n().triggers.redirectTo;return{...t,subscribe(o){let i=()=>{let s=a!==this.state.redirectTo;a=this.state.redirectTo,s&&this.state.redirectTo&&(o(),r(Qu()))};return i(),e.subscribe(i)},get state(){return{redirectTo:n().triggers.redirectTo}}}}function iL(e){return e.addReducers({triggers:Un}),!0}import{Schema as EL,StringValue as IL}from"../bueno/v1.1.0/bueno.esm.js";import{isString as sL}from"../bueno/v1.1.0/bueno.esm.js";var Zb="..",py="...",cL=/^(f|fExcluded|cf|nf|df|sf|af|mnf)-(.+)$/,uL={f:!0,fExcluded:!0,cf:!0,sf:!0,af:!0,nf:!0,df:!0,mnf:!0},wp="&",Fc="=";function Pp(){return{serialize:pL(mL),deserialize:CL}}function Rc(e){return e in uL}function lL(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,debug:!0,tab:!0}}function dL(e){let r=e in{nf:!0,df:!0,mnf:!0};return Rc(e)&&r}function ev(e){return lL(e)||Rc(e)}var pL=e=>t=>Object.entries(t).map(e).filter(r=>r).join(wp);function mL(e){let[t,r]=e;return ev(t)?Rc(t)&&!dL(t)?gL(r)?hL(t,r):"":t==="nf"||t==="df"?yL(r)?SL(t,r):"":fL(t,r):""}function fL(e,t){return`${e}${Fc}${encodeURIComponent(t)}`}function gL(e){return my(e)?tv(e,r=>typeof r=="string"):!1}function yL(e){return my(e)?tv(e,r=>my(r)&&"start"in r&&"end"in r):!1}function my(e){return!!(e&&typeof e=="object")}function tv(e,t){return Object.entries(e).filter(n=>{let a=n[1];return!Array.isArray(a)||!a.every(t)}).length===0}function hL(e,t){return Object.entries(t).map(([r,n])=>`${e}-${r}${Fc}${n.map(a=>encodeURIComponent(a)).join(",")}`).join(wp)}function SL(e,t){return Object.entries(t).map(([r,n])=>{let a=n.map(({start:o,end:i,endInclusive:s})=>`${o}${s?py:Zb}${i}`).join(",");return`${e}-${r}${Fc}${a}`}).join(wp)}function CL(e){return e.split(wp).map(n=>xL(n)).map(n=>AL(n)).filter(vL).map(n=>wL(n)).reduce((n,a)=>{let[o,i]=a;if(Rc(o)){let s={...n[o],...i};return{...n,[o]:s}}return{...n,[o]:i}},{})}function xL(e){let[t,...r]=e.split(Fc),n=r.join(Fc);return[t,n]}function AL(e,t=cL){let[r,n]=e,a=t.exec(r);if(!a)return e;let o=a[1],i=a[2],s=n.split(","),c=FL(o,s),u={[i]:c};return[o,JSON.stringify(u)]}function FL(e,t){return e==="nf"||e==="mnf"?RL(t,"selected"):e==="df"?bL(t,"selected"):t}function RL(e,t){let r=[];for(let n of e){let{startAsString:a,endAsString:o,isEndInclusive:i}=rv(n),s=parseFloat(a),c=parseFloat(o);!Number.isFinite(s)||!Number.isFinite(c)||r.push(lc({start:s,end:c,state:t,endInclusive:i}))}return r}function Xb(e){try{return eC(e)?(vu(e,Os),!0):$t(e)?(na(e),!0):!1}catch{return!1}}function bL(e,t){let r=[];for(let n of e){let{isEndInclusive:a,startAsString:o,endAsString:i}=rv(n);!Xb(o)||!Xb(i)||r.push(ga({start:o,end:i,state:t,endInclusive:a}))}return r}function vL(e){let t=ev(e[0]),r=e.length===2;return t&&r}function wL(e,t=!0){let[r,n]=e;return r==="enableQuerySyntax"?[r,n==="true"]:r==="debug"?[r,n==="true"]:r==="firstResult"?[r,parseInt(n)]:r==="numberOfResults"?[r,parseInt(n)]:Rc(r)?[r,PL(n)]:[r,t?decodeURIComponent(n):n]}function PL(e){let t=JSON.parse(e),r={};return Object.entries(t).forEach(n=>{let[a,o]=n;r[a]=o.map(i=>sL(i)?decodeURIComponent(i):i)}),r}function rv(e){let t=e.indexOf(py)!==-1,[r,n]=e.split(t?py:Zb);return{isEndInclusive:t,startAsString:r,endAsString:n}}var kL=new EL({fragment:new IL});function TL(e,t){let r;function n(){r=e.state.search.requestId}function a(){return r!==e.state.search.requestId}if(!qL(e))throw N;Ae(e,kL,t.initialState,"buildUrlManager");let o=_(e),i=t.initialState.fragment;n();let s=Jg(e,{initialState:{parameters:Ep(i)}});return{...o,subscribe(c){let u=()=>{let l=this.state.fragment;!OL(i,l)&&a()&&(i=l,c()),n()};return u(),e.subscribe(u)},get state(){return{fragment:Pp().serialize(s.state.parameters)}},synchronize(c){i=c;let u=Ep(c);s.synchronize(u)}}}function OL(e,t){if(e===t)return!0;let r=Ep(e),n=Ep(t);return fc(r,n)}function Ep(e){return Pp().deserialize(e)}function qL(e){return e.addReducers({configuration:H}),!0}var nv=G("analytics/addPageViewEntry",async(e,{getState:t})=>{t().configuration.analytics.enabled&&pt.getInstance().addElement({name:"PageView",value:e,time:JSON.stringify(new Date)})});function Rge(e){return e.addReducers({}),{addPageViewEntryInActionsHistory:nv}}import{isUndefined as Sr}from"../bueno/v1.1.0/bueno.esm.js";import{StringValue as DL}from"../bueno/v1.1.0/bueno.esm.js";var Bn=()=>new DL({required:!1,emptyAllowed:!0}),Ip=S("advancedSearchQueries/update",e=>F(e,{aq:Bn(),cq:Bn(),lq:Bn(),dq:Bn()})),kp=S("advancedSearchQueries/register",e=>F(e,{aq:Bn(),cq:Bn(),lq:Bn(),dq:Bn()}));var av=$(Pt(),e=>{e.addCase(Ip,(t,r)=>{let{aq:n,cq:a,lq:o,dq:i}=r.payload;Sr(n)||(t.aq=n,t.aqWasSet=!0),Sr(a)||(t.cq=a,t.cqWasSet=!0),Sr(o)||(t.lq=o,t.lqWasSet=!0),Sr(i)||(t.dq=i,t.dqWasSet=!0)}).addCase(kp,(t,r)=>{let{aq:n,cq:a,lq:o,dq:i}=r.payload;Sr(n)||(t.defaultFilters.aq=n,t.aqWasSet||(t.aq=n)),Sr(a)||(t.defaultFilters.cq=a,t.cqWasSet||(t.cq=a)),Sr(o)||(t.defaultFilters.lq=o,t.lqWasSet||(t.lq=o)),Sr(i)||(t.defaultFilters.dq=i,t.dqWasSet||(t.dq=i))}).addCase(oe.fulfilled,(t,r)=>r.payload?.advancedSearchQueries??t).addCase(ie,(t,r)=>{let{aq:n,cq:a}=r.payload;Sr(n)||(t.aq=n,t.aqWasSet=!0),Sr(a)||(t.cq=a,t.cqWasSet=!0)})});function Mge(e){return e.addReducers({advancedSearchQueries:av}),{updateAdvancedSearchQueries:Ip,registerAdvancedSearchQueries:kp}}function Bge(e){return e.addReducers({}),{logDocumentOpen:lp,logOpenSmartSnippetSource:ny,logOpenSmartSnippetSuggestionSource:Ac,logOpenSmartSnippetInlineLink:xc,logOpenSmartSnippetSuggestionInlineLink:Sp}}function Gge(e){return e.addReducers({}),{logSearchEvent:MS,logClickEvent:QS,logCustomEvent:LS}}function cye(e){return e.addReducers({}),{logClearBreadcrumbs:Il,logInterfaceLoad:gu,logSearchFromLink:yu,logOmniboxFromLink:hu,logInterfaceChange:Kr,logDidYouMeanClick:Iu,logCategoryFacetBreadcrumb:Sl,logFacetBreadcrumb:ti,logFacetClearAll:Ie,logFacetUnexclude:Or,logFacetExclude:ot,logFacetDeselect:Ot,logFacetSelect:Se,logFacetShowLess:ei,logFacetShowMore:Zo,logFacetUpdateSort:or,logDateFacetBreadcrumb:rc,logNumericFacetBreadcrumb:ac,logNavigateBackward:Jd,logNavigateForward:Kd,logPageNext:ap,logPageNumber:Pi,logPagePrevious:op,logPagerResize:wi,logSearchboxSubmit:Nn,logQuerySuggestionClick:pp,logResultsSort:Vi,logDislikeSmartSnippet:ry,logLikeSmartSnippet:ty,logOpenSmartSnippetFeedbackModal:ay,logCloseSmartSnippetFeedbackModal:oy,logSmartSnippetFeedback:iy,logSmartSnippetDetailedFeedback:sy,logExpandSmartSnippet:Zg,logCollapseSmartSnippet:ey,logExpandSmartSnippetSuggestion:cy,logCollapseSmartSnippetSuggestion:uy,logNoResultsBack:Xd,logStaticFilterSelect:Xl,logStaticFilterDeselect:ai,logStaticFilterClearAll:Zl,logTriggerQuery:Vu,logUndoTriggerQuery:Nu,logNotifyTrigger:Mu,logTriggerRedirect:Qu,logTriggerExecute:Lu}}function dye(e){return e.addReducers({}),{deselectAllBreadcrumbs:be,deselectAllNonBreadcrumbs:mo}}function gye(e){return e.addReducers({configuration:H}),{disableAnalytics:oo,enableAnalytics:io,setOriginLevel2:Su,setOriginLevel3:Cu,updateAnalyticsConfiguration:Jr,updateBasicConfiguration:wt}}function Aye(e){return e.addReducers({configuration:H,pipeline:po,searchHub:Do}),{updateSearchConfiguration:mt}}function vye(e){return e.addReducers({context:td}),{addContext:Aa,removeContext:Fa,setContext:xa}}function Iye(e){return e.addReducers({debug:uo}),{disableDebug:co,enableDebug:Zr}}function qye(e){return e.addReducers({dictionaryFieldContext:ad}),{addContext:si,removeContext:ci,setContext:ii}}function Mye(e){return e.addReducers({didYouMean:id,query:_e}),{applyDidYouMeanCorrection:ft,disableDidYouMean:Pu,enableDidYouMean:Ro,enableAutomaticQueryCorrection:Eu,disableAutomaticQueryCorrection:bo,setCorrectionMode:aa}}import{NumberValue as jL}from"../bueno/v1.1.0/bueno.esm.js";var Tp=S("excerptLength/set",e=>F(e,new jL({min:0,required:!0})));function ov(){return{length:void 0}}var iv=$(ov(),e=>{e.addCase(Tp,(t,r)=>{t.length=r.payload})});function Jye(e){return e.addReducers({excerptLength:iv}),{setExcerptLength:Tp}}function the(e){return e.addReducers({facetOptions:ke}),{updateFacetOptions:Z,enableFacet:Le,disableFacet:fe}}function ohe(e){return e.addReducers({automaticFacetSet:sd}),{setOptions:$o,deselectAllAutomaticFacetValues:Go,toggleSelectAutomaticFacetValue:Wt}}function lhe(e){return e.addReducers({categoryFacetSet:Jt}),{deselectAllCategoryFacetValues:Kt,registerCategoryFacet:Yt,toggleSelectCategoryFacetValue:yn,updateCategoryFacetNumberOfValues:la,updateCategoryFacetSortCriterion:zo,updateFacetAutoSelection:Ut,updateCategoryFacetBasePath:hl}}function ghe(e){return e.addReducers({facetSet:ht}),{deselectAllFacetValues:ge,registerFacet:rr,toggleSelectFacetValue:nr,toggleExcludeFacetValue:ar,updateFacetIsFieldExpanded:pa,updateFacetNumberOfValues:da,updateFacetSortCriterion:Xo,updateFreezeCurrentValues:Tr,updateFacetAutoSelection:Ut}}function Che(e){return e.addReducers({dateFacetSet:ur}),{deselectAllDateFacetValues:Dl,registerDateFacet:ir,toggleSelectDateFacetValue:sr,toggleExcludeDateFacetValue:cr,updateDateFacetSortCriterion:ql,updateDateFacetValues:jr}}function Rhe(e){return e.addReducers({numericFacetSet:St}),{deselectAllNumericFacetValues:Yl,registerNumericFacet:lr,toggleSelectNumericFacetValue:dr,toggleExcludeNumericFacetValue:pr,updateNumericFacetSortCriterion:Wl,updateNumericFacetValues:Vr}}function Phe(e){return e.addReducers({fields:jn}),{registerFieldsToInclude:Dn,enableFetchAllFields:Si,disableFetchAllFields:wa,fetchFieldsDescription:Ci}}function The(e){return e.addReducers({folding:_d}),{registerFolding:kn,loadCollection:Tn}}function jhe(e){return e.addReducers({generatedAnswer:Ai}),{resetAnswer:It}}function Lhe(e){return e.addReducers({history:ep,facetOrder:Fi}),{back:ks,forward:Au}}function $he(e){return e.addReducers({instantResults:rp}),{registerInstantResults:fo,updateInstantResultsQuery:Bt,clearExpiredResults:go}}function Whe(e){return e.addReducers({pagination:At}),{nextPage:Co,previousPage:xo,registerNumberOfResults:yo,registerPage:So,updateNumberOfResults:ho,updatePage:_t}}function Xhe(e){return e.addReducers({pipeline:po}),{setPipeline:lo}}function rSe(e){return e.addReducers({query:_e}),{updateQuery:Xe}}function iSe(e){return e.addReducers({querySet:Mn}),{registerQuerySetQuery:Di,updateQuerySetQuery:Ta}}function dSe(e){return e.addReducers({querySuggest:ji,querySet:Mn}),{clearQuerySuggest:On,fetchQuerySuggestions:qn,registerQuerySuggest:hi,selectQuerySuggestion:gr}}function gSe(e){return e.addReducers({questionAnswering:hr}),{collapseSmartSnippet:Ui,expandSmartSnippet:Li,dislikeSmartSnippet:_i,likeSmartSnippet:Bi,openFeedbackModal:$i,closeFeedbackModal:Qn,expandSmartSnippetRelatedQuestion:Gi,collapseSmartSnippetRelatedQuestion:Hi}}function CSe(e){return e.addReducers({recentQueries:cp}),{registerRecentQueries:ka,clearRecentQueries:qi}}function RSe(e){return e.addReducers({recentResults:up}),{registerRecentResults:Ri,clearRecentResults:bi,pushRecentResult:xt}}function PSe(e){return e.addReducers({resultPreview:sp}),{fetchResultContent:Ia,updateContentURL:Oi,nextPreview:Ii,previousPreview:ki,preparePreviewPagination:Ti}}import{ArrayValue as VL,NumberValue as NL,Schema as ML,SchemaValidationError as QL,Value as sv}from"../bueno/v1.1.0/bueno.esm.js";var LL=new ML({content:new sv({required:!0}),conditions:new sv({required:!0}),priority:new NL({required:!1,default:0,min:0}),fields:new VL({required:!1,each:j})});function cv(){let e=[],t=r=>{let n=LL.validate(r);if(!r.conditions.every(o=>o instanceof Function))throw new QL("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return n};return{registerTemplates(...r){r.forEach(n=>{let a={...t(n),fields:n.fields||[]};e.push(a)}),e.sort((n,a)=>a.priority-n.priority)},selectTemplate(r){let n=e.find(a=>a.conditions.every(o=>o(r)));return n?n.content:null},selectLinkTemplate(r){let n=e.find(a=>a.conditions.every(o=>o(r)));return n?n.linkContent:null}}}function UL(e){if(!BL(e))throw N;let{registerTemplates:t,selectTemplate:r,selectLinkTemplate:n}=cv();return{registerTemplates:(...a)=>{t(...a);let o=[];a.forEach(i=>{i.fields&&o.push(...i.fields)}),e.dispatch(Dn(o))},selectTemplate:r,selectLinkTemplate:n}}function BL(e){return e.addReducers({fields:jn}),!0}function QSe(e){return e.addReducers({search:W}),{executeSearch:Po,fetchMoreResults:Io,fetchFacetValues:Bu,fetchPage:Eo,fetchInstantResults:SC}}function _Se(e){return e.addReducers({searchHub:Do}),{setSearchHub:qo}}function JSe(e){return e.addReducers({facetOrder:Fi,facetSet:ht,pagination:At,query:_e,querySet:Mn}),{restoreSearchParameters:ie,restoreTab:so}}function tCe(e){return e.addReducers({sortCriteria:Ap}),{registerSortCriterion:zi,updateSortCriterion:Wi}}function oCe(e){return e.addReducers({standaloneSearchBoxSet:Rp}),{registerStandaloneSearchBox:Yi,fetchRedirectUrl:Ln,updateStandaloneSearchBoxRedirectionUrl:Ki,updateAnalyticsToSearchFromLink:Xi,updateAnalyticsToOmniboxFromLink:Zi,resetStandaloneSearchBox:Ji}}function uCe(e){return e.addReducers({staticFilterSet:bp}),{registerStaticFilter:ni,toggleSelectStaticFilterValue:Nr,toggleExcludeStaticFilterValue:Mr,deselectAllStaticFilterValues:xn}}function mCe(e){return e.addReducers({tabSet:oi}),{registerTab:Uo,updateActiveTab:kt}}function _L(e){let{by:t,order:r}=e;switch(t){case"relevancy":return ws();case"qre":return Gm();case"nosort":return Hm();case"date":if(!r)throw new Error('An order (i.e., ascending or descending) should be specified for a sort criterion sorted by "date"');return _m(r);default:if(!r)throw new Error(`An order (i.e., ascending or descending) should be specified for a sort criterion sorted by a field, such as "${t}"`);return $m(t,r)}}function $L(e){return e===void 0||e==="ascending"||e==="descending"}function GL(e){let t=e.split(","),r=new Error(`Wrong criterion expression format for "${e}"`);if(!t.length)throw r;return t.map(n=>{let a=n.trim().split(" "),o=a[0].toLowerCase(),i=a[1]?.toLowerCase();if(a.length>2||o==="")throw r;if(!$L(i))throw new Error(`Wrong criterion sort order "${i}" in expression "${e}". Order should either be "ascending" or "descending"`);return _L({by:o,order:i})})}function Oe(e){return e.negate?"NOT ":""}function Rt(e){return{contains:"=",differentThan:"<>",fuzzyMatch:"~=",greaterThan:">",greaterThanOrEqual:">=",isExactly:"==",lowerThan:"<",lowerThanOrEqual:"<=",phoneticMatch:"%=",regexMatch:"/=",wildcardMatch:"*="}[e]}function uv(e){return{toQuerySyntax(){let{field:t,value:r}=e,n=Rt(e.operator);return`${Oe(e)}@${t}${n}${r}`}}}function lv(e){return{toQuerySyntax(){let t=Oe(e),{field:r,from:n,to:a}=e,o=Rt("isExactly");return`${t}@${r}${o}${n}..${a}`}}}function dv(e){return{toQuerySyntax(){let t=Oe(e),{expression:r}=e;return`${t}"${r}"`}}}function pv(e){return{toQuerySyntax(){let t=Oe(e),{field:r}=e;return`${t}@${r}`}}}function mv(e){return{toQuerySyntax(){let{expression:t,negate:r}=e;return r?`NOT (${t})`:t}}}function fv(e){return{toQuerySyntax(){let t=Oe(e),{startTerm:r,otherTerms:n}=e,a=HL(n),o=`${r} ${a}`;return e.negate?`${t}(${o})`:o}}}function HL(e){return e.map(t=>{let{endTerm:r,maxKeywordsBetween:n}=t;return`near:${n} ${r}`}).join(" ")}function gv(e){return{toQuerySyntax(){let{field:t,value:r}=e,n=Oe(e),a=Rt(e.operator);return`${n}@${t}${a}${r}`}}}function yv(e){return{toQuerySyntax(){let t=Oe(e),{field:r,from:n,to:a}=e,o=Rt("isExactly");return`${t}@${r}${o}${n}..${a}`}}}function hv(e){return{toQuerySyntax(){let{name:t,parameters:r}=e,n=zL(r);return`$${t}(${n})`}}}function zL(e){return Object.entries(e).map(t=>{let[r,n]=t,a=typeof n=="string"?n:n.toQuerySyntax();return`${r}: ${a}`}).join(", ")}function Sv(e){return{toQuerySyntax(){let t=Oe(e),{field:r,operator:n,value:a}=e,o=Rt(n),i=n==="fuzzyMatch"?` $quoteVar(value: ${a})`:`("${a}")`;return`${t}@${r}${o}${i}`}}}function Cv(e){return{toQuerySyntax(){let{field:t}=e,r=Oe(e),n=Rt(e.operator),a=e.values.map(i=>`"${i}"`),o=a.length===1?a[0]:`(${a.join(",")})`;return`${r}@${t}${n}${o}`}}}function rxe(){let e=[],t="and";return{addExpression(r){return e.push(r),this},addKeyword(r){return e.push(mv(r)),this},addNear(r){return e.push(fv(r)),this},addExactMatch(r){return e.push(dv(r)),this},addFieldExists(r){return e.push(pv(r)),this},addStringField(r){return e.push(Cv(r)),this},addStringFacetField(r){return e.push(Sv(r)),this},addNumericField(r){return e.push(gv(r)),this},addNumericRangeField(r){return e.push(yv(r)),this},addDateField(r){return e.push(uv(r)),this},addDateRangeField(r){return e.push(lv(r)),this},addQueryExtension(r){return e.push(hv(r)),this},joinUsing(r){return t=r,this},toQuerySyntax(){let r=WL(t),n=e.map(a=>a.toQuerySyntax()).join(`) ${r} (`);return e.length<=1?n:`(${n})`}}}function WL(e){return e==="and"?"AND":"OR"}export{Os as API_DATE_FORMAT,aR as DefaultFieldsToInclude,sV as EcommerceDefaultFieldsToInclude,Sy as HighlightUtils,Og as MinimumFieldsToInclude,Kk as ResultTemplatesHelpers,to as SortBy,lu as SortOrder,Xn as VERSION,Qt as baseFacetResponseSelector,PD as buildAutomaticFacetGenerator,tD as buildBreadcrumbManager,lj as buildCategoryFacet,zj as buildCategoryFieldSuggestions,fD as buildContext,_ as buildController,Pr as buildCriterionExpression,Oj as buildDateFacet,Dj as buildDateFilter,ga as buildDateRange,_m as buildDateSortCriterion,xD as buildDictionaryFieldContext,RD as buildDidYouMean,ZQ as buildExecuteTrigger,bj as buildFacet,hD as buildFacetConditionsManager,vD as buildFacetManager,$m as buildFieldSortCriterion,Yj as buildFieldSuggestions,hV as buildFoldedResultList,RV as buildGeneratedAnswer,EN as buildHistoryManager,MN as buildInstantResults,vV as buildInteractiveCitation,DN as buildInteractiveInstantResult,FM as buildInteractiveRecentResult,MM as buildInteractiveResult,Hm as buildNoSortCriterion,rL as buildNotifyTrigger,Bj as buildNumericFacet,Gj as buildNumericFilter,lc as buildNumericRange,KN as buildPager,XN as buildQueryError,rxe as buildQueryExpression,Gm as buildQueryRankingExpressionSortCriterion,eM as buildQuerySummary,nL as buildQueryTrigger,nM as buildQuickview,xM as buildRecentQueriesList,IM as buildRecentResultsList,oL as buildRedirectionTrigger,VM as buildRelevanceInspector,ws as buildRelevanceSortCriterion,QM as buildResultList,UL as buildResultTemplatesManager,$M as buildResultsPerPage,Yg as buildSearchBox,WO as buildSearchEngine,Jg as buildSearchParameterManager,Pp as buildSearchParameterSerializer,yQ as buildSearchStatus,AQ as buildSmartSnippet,bQ as buildSmartSnippetQuestionsList,qQ as buildSort,UQ as buildStandaloneSearchBox,GQ as buildStaticFilter,Bb as buildStaticFilterValue,JQ as buildTab,XQ as buildTabManager,TL as buildUrlManager,Vn as currentPageSelector,Ug as currentPagesSelector,fk as deserializeRelativeDate,Nm as facetRequestSelector,mI as facetResponseSelectedValuesSelector,bs as facetResponseSelector,Wp as getAnalyticsNextApiBaseUrl,Me as getOrganizationEndpoint,zx as getSampleSearchEngineConfiguration,Pe as getSearchApiBaseUrl,Mge as loadAdvancedSearchQueryActions,ohe as loadAutomaticFacetSetActions,dye as loadBreadcrumbActions,lhe as loadCategoryFacetSetActions,Bge as loadClickAnalyticsActions,gye as loadConfigurationActions,vye as loadContextActions,Che as loadDateFacetSetActions,Iye as loadDebugActions,qye as loadDictionaryFieldContextActions,Mye as loadDidYouMeanActions,Jye as loadExcerptLengthActions,the as loadFacetOptionsActions,ghe as loadFacetSetActions,Phe as loadFieldActions,The as loadFoldingActions,jhe as loadGeneratedAnswerActions,Gge as loadGenericAnalyticsActions,Lhe as loadHistoryActions,Rge as loadIPXActionsHistoryActions,$he as loadInstantResultsActions,Rhe as loadNumericFacetSetActions,Whe as loadPaginationActions,Xhe as loadPipelineActions,rSe as loadQueryActions,iSe as loadQuerySetActions,dSe as loadQuerySuggestActions,gSe as loadQuestionAnsweringActions,CSe as loadRecentQueriesActions,RSe as loadRecentResultsActions,PSe as loadResultPreviewActions,QSe as loadSearchActions,cye as loadSearchAnalyticsActions,Aye as loadSearchConfigurationActions,_Se as loadSearchHubActions,JSe as loadSearchParameterActions,tCe as loadSortCriteriaActions,oCe as loadStandaloneSearchBoxSetActions,uCe as loadStaticFilterSetActions,mCe as loadTabSetActions,np as maxPageSelector,GL as parseCriterionExpression,na as validateRelativeDate};
//# sourceMappingURL=headless.esm.js.map
